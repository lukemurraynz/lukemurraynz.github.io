<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">156 posts tagged with &quot;Azure&quot; | luke.geek.nz</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://luke.geek.nz/img/social-card.png"><meta data-rh="true" name="twitter:image" content="https://luke.geek.nz/img/social-card.png"><meta data-rh="true" property="og:url" content="https://luke.geek.nz/tags/azure/page/12/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="156 posts tagged with &quot;Azure&quot; | luke.geek.nz"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://luke.geek.nz/tags/azure/page/12/"><link data-rh="true" rel="alternate" href="https://luke.geek.nz/tags/azure/page/12/" hreflang="en"><link data-rh="true" rel="alternate" href="https://luke.geek.nz/tags/azure/page/12/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://ZBH2T1WJQD-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="luke.geek.nz RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="luke.geek.nz Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="luke.geek.nz JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0QDLBY7NNN"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0QDLBY7NNN",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.dcdba76e.css">
<script src="/assets/js/runtime~main.aab1915f.js" defer="defer"></script>
<script src="/assets/js/main.d1fc2f5a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#D3D3D3" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">If you haven't already make sure you sign up for my Weekly Azure Newsletter, straight to your inbox! <a target="_blank" rel="noopener noreferrer" href="https://newsletter.azurefeeds.com/join">Subscribe now!</a></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="luke.geek.nz" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="luke.geek.nz" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">luke.geek.nz</b></a><a class="navbar__item navbar__link" href="/Tags/">Tags</a><a class="navbar__item navbar__link" href="/Archive/">Blog</a><a class="navbar__item navbar__link" href="/about/">About</a></div><div class="navbar__items navbar__items--right"><a href="https://www.youtube.com/channel/UCUG3TKDTAZz4UXshGrjBBoQ" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="YouTube">
              <svg width="24" height="24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M23.498,6.186c-0.273-1.186-1.143-2.144-2.332-2.417C18.389,3.153,12,3.153,12,3.153s-6.389,0-9.166,0.616
                  c-1.19,0.273-2.06,1.23-2.332,2.417C0,8.07,0,12,0,12s0,3.93,0.502,5.814c0.272,1.187,1.142,2.062,2.332,2.335
                  C5.611,20.847,12,20.847,12,20.847s6.389,0,9.166-0.698c1.189-0.273,2.059-1.148,2.332-2.335C24,15.93,24,12,24,12
                  S24,8.07,23.498,6.186z M9.545,15.568V8.432l6.545,3.568L9.545,15.568z"/>
              </svg>
            </a><a href="https://aus.social/@lukemurray" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="Mastodon">
              <svg height="20" width="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" xml:space="preserve">
                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                <g id="SVGRepo_iconCarrier">
                  <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.510 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"></path>
                </g>
              </svg>
            </a><a href="https://bsky.app/profile/lukemurraynz.bsky.social" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="Bluesky">
              <svg class="octicon" xmlns="http://www.w3.org/2000/svg" role="img" viewBox="0 0 16 16" height="20" width="20" fill="currentColor">
                <title>Bluesky</title>
                <path d="M8 7.2c-.72-1.4-2.7-4.04-4.53-5.33C1.7.63 1.04.84.6 1.04.1 1.27 0 2.05 0 2.51c0 .46.25 3.77.42 4.32.54 1.82 2.47 2.45 4.25 2.25-2.6.38-4.92 1.33-1.88 4.71 3.33 3.46 4.57-.74 5.21-2.87.64 2.13 1.37 6.18 5.16 2.87 2.84-2.87.78-4.33-1.83-4.71 1.78.2 3.71-.43 4.25-2.25.17-.55.42-3.86.42-4.32 0-.46-.09-1.24-.6-1.47-.44-.2-1.11-.42-2.87.83A17.87 17.87 0 0 0 8 7.2Z"></path>
              </svg>
            </a><a href="https://twitter.com/lukemurraynz" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="X"><svg height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 8.586l4.293-4.293a1 1 0 011.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 011.414-1.414L10 8.586z" clip-rule="evenodd"/>
          </svg></a><a href="https://www.linkedin.com/in/ljmurray/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="LinkedIn"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"></path></svg></a><a href="https://luke.geek.nz/rss" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-rss-link" aria-label="RSS"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/enhancing-github-copilot-with-custom-instructions/">Enhancing GitHub Copilot with Custom Instructions</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/change-analysis/">Azure Resource - Change Analysis</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/misc/kubernetes-enterprise-guide-book-review/">Book Review - Kubernetes – An Enterprise Guide</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/openai-adoption-challenges-solutions/">Common Challenges and Solutions for Azure OpenAI Adoption</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/policy-deny-creation-azure-openai-studio/">Azure Policy - Deny the creation of Azure OpenAI Studio</a></li></ul></div></nav></aside><main class="col col--7"><header class="margin-bottom--xl"><h1>156 posts tagged with &quot;Azure&quot;</h1><a href="/tags/">View All Tags</a></header><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/azure/AADDS-Referenced-account-locked-out/">Entra ID Domain Services - Referenced account locked out</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-07-31T00:00:00.000Z">July 31, 2023</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Luke Murray</span></a></div><small class="authorTitle_nd0D" title="Author">Author</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>So you have just stood up <a href="https://learn.microsoft.com/azure/active-directory-domain-services/?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Entra ID Domain Services</a> <em>(formally - or still known as of July 2023 as: Active Directory Domain Services (AAD DS)</em>) and trying to login and join a computer to the AAD DS domain and you get the following error:</p>
<blockquote>
<p>The referenced account is currently locked out and may not be logged on to.</p>
</blockquote>
<p><img decoding="async" loading="lazy" alt="The referenced account is currently locked out and may not be logged on to." src="data:image/png;base64,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" width="400" height="180" class="img_ev3q"></p>
<p>This is commonly due to the following:</p>
<blockquote>
<p>Entra ID doesn&#x27;t generate or store password hashes in the format that&#x27;s required for NTLM or Kerberos authentication until you enable Azure AD DS for your tenant. For security reasons, Entra ID also doesn&#x27;t store any password credentials in clear-text form. Therefore, Azure AD can&#x27;t automatically generate these NTLM or Kerberos password hashes based on users&#x27; existing credentials.</p>
</blockquote>
<p>Essentially this means, that the password hashes are not comaptible with Entra ID Domain Services, and the fix is to <strong>reset the password of an Entra ID account</strong> used to access Entra ID services, to allow Entra ID Domain Services, to hash and validate the Entra ID credentials. The reset only needs to happen, if the password for the accounts haven&#x27;t been reset since Entra ID Domain Services has been deployed.</p>
<p>After resetting the password to my Entra ID account, and waiting an hour for replication I was successfully able to login and join a Windows Server to Entra ID Domain Services.</p>
<p><img decoding="async" loading="lazy" alt="Entra ID Domain Services - Join account" src="/assets/images/AADDS_JoinAccount-7115b6ef7a68ce94b8de457c9c0871fb.png" width="548" height="458" class="img_ev3q"></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/azure/Entra-ID-login-to-a-CIS-Hardened-Linux-Azure-Virtual-Machine/">Entra ID login to a CIS Hardened Linux Azure Virtual Machine</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-07-28T00:00:00.000Z">July 28, 2023</time> · <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Luke Murray</span></a></div><small class="authorTitle_nd0D" title="Author">Author</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>Currently, <a href="https://www.cisecurity.org/" target="_blank" rel="noopener noreferrer">CIS</a> (Center for Internet Security) <a href="https://azuremarketplace.microsoft.com/en-us/marketplace/apps?search=CIS&amp;page=1?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Azure Marketplace images</a>, do not support being Entra ID (Azure Active Directory) Joined.</p>
<p>Although this article is about allowing Entra ID login to a Ubuntu machine, its worth noting the current decisions around Windows as well currently:</p>
<blockquote>
<p>&#x27;The Windows CIS Benchmarks are written for Active Directory domain-joined systems using Group Policy, not standalone/workgroup systems. Adjustments/tailoring to some recommendations will be needed to maintain functionality if attempting to implement CIS hardening on standalone systems or a system running in the cloud.
&#x27;Currently, we do not support Azure Active Directory and it is not compatible with our EXISTING Hardened Images.</p>
</blockquote>
<p>In fact when you, attempt to create a CIS Level 1 Ubuntu image in the Azure Portal, you get:</p>
<p>&quot;This image does not support Login with Azure AD.&quot;</p>
<p><img decoding="async" loading="lazy" alt="CIS Image does not support Login with Azure AD" src="data:image/png;base64,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" width="685" height="141" class="img_ev3q"></p>
<p>However, as I go into below, we can indeed login to the CIS hardened image, using the <a href="https://learn.microsoft.com/en-us/azure/active-directory/devices/howto-vm-sign-in-azure-ad-linux?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Microsoft Azure AD based SSH Login</a> extension.</p>
<blockquote>
<p>Be wary, that although this works, you may run into issues with operational support of this from CIS, due to the hardening. This is also Entra ID LOGIN (not JOINED!). You won&#x27;t see the device under Entra ID Devices.</p>
</blockquote>
<p><img decoding="async" loading="lazy" alt="Entra ID login to a CIS Hardened Linux Azure Virtual Machine" src="/assets/images/Blog_Headler-EntraID_login_CIS_Linux_Azure_Virtual_Machine-509aed112ffc335de9109abb2c734e43.gif" width="1200" height="628" class="img_ev3q"></p>
<p>There are many security benefits of using Azure AD with SSH log in to Linux VMs in Azure, including:</p>
<ol>
<li>Use of your Entra ID (Azure AD) credentials to log in to Azure Linux VMs.</li>
<li>Get SSH certificate-based authentication without needing to distribute SSH keys to users or provision SSH public keys on any Azure Linux VMs you deploy.</li>
<li>Reduce reliance on local administrator accounts, credential theft, and weak credentials.</li>
<li>Password complexity and password lifetime policies configured for Azure AD help secure Linux VMs as well.</li>
<li>With Azure role-based access control, specify who can login to a VM as a regular user or with administrator privileges. When users join or leave your team, you can update the Azure RBAC policy for the VM to grant access as appropriate. When employees leave your organization and their user account is disabled or removed from Azure AD, they no longer have access to your resources.</li>
<li>With Conditional Access, configure policies to require multi-factor authentication and/or require client device you are using to SSH be a managed device (for example: compliant device or hybrid Azure AD joined) before you can SSH to Linux VMs.</li>
<li>Use Azure deploy and audit policies to require Azure AD login for Linux VMs and to flag use of non-approved local accounts on the VMs.</li>
</ol>
<p>So after your CIS Hardened Image, in my case I am using Ubuntu 20.04 has been deployed in Azure. Lets set this up.</p>
<p>You will need to make sure you have a few prerequsites.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="network">Network<a href="#network" class="hash-link" aria-label="Direct link to Network" title="Direct link to Network">​</a></h4>
<p>VM network configuration must permit outbound access to the following endpoints over TCP port 443.</p>
<p><a href="https://packages.microsoft.com" target="_blank" rel="noopener noreferrer">https://packages.microsoft.com</a>: For package installation and upgrades.
<a href="http://169.254.169.254" target="_blank" rel="noopener noreferrer">http://169.254.169.254</a>: Azure Instance Metadata Service endpoint.
<a href="https://login.microsoftonline.com" target="_blank" rel="noopener noreferrer">https://login.microsoftonline.com</a>: For PAM-based (pluggable authentication modules) authentication flows.
<a href="https://pas.windows.net" target="_blank" rel="noopener noreferrer">https://pas.windows.net</a>: For Azure RBAC (Role Based Access Control) flows.</p>
<p>Also make sure you have enabled TCP Port 80 for: ubuntu.com, specifically <a href="http://archive.ubuntu.com" target="_blank" rel="noopener noreferrer">http://archive.ubuntu.com</a> as the Microsoft Azure AD based SSH Login, will need to download and install the following packages: aadsshlogin and aadsshlogin-selinux as needed.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="virtual-machine">Virtual Machine<a href="#virtual-machine" class="hash-link" aria-label="Direct link to Virtual Machine" title="Direct link to Virtual Machine">​</a></h4>
<p>The CIS hardened image, will need to have a <a href="https://learn.microsoft.com/azure/active-directory/managed-identities-azure-resources/overview?WT.mc_id=AZ-MVP-5004796#managed-identity-types" target="_blank" rel="noopener noreferrer">System Managed Identity</a> setup. This can be easily enabled in the Identity blade of the Virtual Machine.</p>
<p>The Entra ID (Azure Active Directory) users that need to login with to the Linux Virtual Machine are a member of one of the following Azure RBAC (Role Based Access Control) groups, as per their requirements:</p>

















<table><thead><tr><th>RBAC Role</th><th>Notes</th></tr></thead><tbody><tr><td>Virtual Machine Administrator Login</td><td>View Virtual Machines in the portal and login as administrator</td></tr><tr><td>Virtual Machine User Login</td><td>View Virtual Machines in the portal and login as a regular user.</td></tr></tbody></table>
<p>Only one role is required. These roles are supported for both Windows and Linux.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="client">Client<a href="#client" class="hash-link" aria-label="Direct link to Client" title="Direct link to Client">​</a></h4>
<p>On the jumphost, client PC you will be connecting to the Linux virtual machine from, you need the latest <a href="https://learn.microsoft.com/cli/azure/install-azure-cli?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Azure CLI</a> with the Azure CLI extension &#x27;ssh&#x27; installed.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">az extension add --name ssh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The minimum version required for the extension is 0.1.4.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">az extension show --name ssh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-extension">Install Extension<a href="#install-extension" class="hash-link" aria-label="Direct link to Install Extension" title="Direct link to Install Extension">​</a></h3>
<p>Make sure the Virtual Machine is on, for the extension to install.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="install-using-the-azure-portal">Install using the Azure Portal<a href="#install-using-the-azure-portal" class="hash-link" aria-label="Direct link to Install using the Azure Portal" title="Direct link to Install using the Azure Portal">​</a></h5>
<p>Once the pre-requsites have been met, it is time to install the extension.</p>
<ol>
<li>Login to the <a href="https://portal.azure.com/" target="_blank" rel="noopener noreferrer">Azure Portal</a></li>
<li>Navigate to your CIS Hardened Virtual Machine</li>
<li>Click on Extensions + Applications</li>
<li>Click + Add</li>
<li><img decoding="async" loading="lazy" alt="Azure Portal - Extensions" src="/assets/images/AzurePortal_CISHardenedVM_Extensions-7d80816f877407cbfbe4483d8369a2ca.png" width="859" height="706" class="img_ev3q"></li>
<li>Search for: Azure AD based SSH Login</li>
<li><img decoding="async" loading="lazy" alt="Azure Portal - SSH Extension" src="/assets/images/AzurePortal_CISHardenedVM_SSH_Extension-7d33b8acf511a51b6a05e24ccffa30d9.png" width="1887" height="897" class="img_ev3q"></li>
<li>Select the Azure AD base SSH Login extension</li>
<li>Click Next</li>
<li>Click Review and Create</li>
<li>Click Create</li>
</ol>
<p>After a few moments, the extension and supporting components, will be installed. You can check the status under the Extensions + Application blade make sure that Provisioning has been succeded, before provisioning to the next step to login.</p>
<p><img decoding="async" loading="lazy" alt="Azure Virtual Machine Extension" src="/assets/images/AzurePortal_CIS_Level1_Ubuntu_ADSSHExtensionStatus-89350aa724ec1ef5de7c256dd04422fe.png" width="1879" height="703" class="img_ev3q"></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="install-using-terraform">Install using Terraform<a href="#install-using-terraform" class="hash-link" aria-label="Direct link to Install using Terraform" title="Direct link to Install using Terraform">​</a></h5>
<p>You can use the following Terraform code snippet, to install the extension to a Linux Virtual Machine:</p>
<p>Make sure you assign the extension, to the virtual machine, using the ID.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">resource &quot;azurerm_virtual_machine_extension&quot; &quot;aad_login&quot; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">name                 = &quot;AADLogin&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">virtual_machine_id   = </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">publisher            = &quot;Microsoft.Azure.ActiveDirectory&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">type                 = &quot;AADSSHLoginForLinux&quot; # For Windows VMs: AADLoginForWindows</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">type_handler_version = &quot;1.0&quot;                 # There may be a more recent version</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="install-using-powershell">Install using PowerShell<a href="#install-using-powershell" class="hash-link" aria-label="Direct link to Install using PowerShell" title="Direct link to Install using PowerShell">​</a></h5>
<p>To install the AADLogin extension to a Linux Virtual Machine in Microsoft Azure using PowerShell, you can follow these steps:</p>
<ol>
<li>
<p>Open PowerShell on your local machine, or <a href="https://learn.microsoft.com/azure/cloud-shell/overview?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Azure Cloud Shell</a>.</p>
<p>Connect-AzAccount
Select-AzSubscription -SubscriptionName &quot;Your Subscription Name&quot;
$vm = Get-AzVM -ResourceGroupName &quot;Your Resource Group Name&quot; -Name &quot;Your VM Name&quot;
Set-AzVMExtension -ResourceGroupName $vm.ResourceGroupName -VMName $vm.Name -Name &quot;AADLoginForLinux&quot; -Publisher &quot;Microsoft.Azure.ActiveDirectory.LinuxSSH&quot; -Type &quot;AADLoginForLinux&quot; -TypeHandlerVersion &quot;1.0&quot;</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="login-to-virtual-machine">Login to Virtual Machine<a href="#login-to-virtual-machine" class="hash-link" aria-label="Direct link to Login to Virtual Machine" title="Direct link to Login to Virtual Machine">​</a></h3>
<p>Now that the extension is stood, up its time to connect.</p>
<p>REMEMBER to make sure that the Entra ID (AAD) accounts you want to login to the Linux image is a member of either of the following roles, directly assigned to the Virtual Machine/Resource Group, or in an Entra ID (AAD) group that has been delegated the permissions.</p>

















<table><thead><tr><th>RBAC Role</th><th>Notes</th></tr></thead><tbody><tr><td>Virtual Machine Administrator Login</td><td>View Virtual Machines in the portal and login as administrator</td></tr><tr><td>Virtual Machine User Login</td><td>View Virtual Machines in the portal and login as a regular user.</td></tr></tbody></table>
<ol>
<li>Open a Command Prompt</li>
<li>Log in to the Azure using:
az login</li>
<li>A web browser will prompt and ask you to authenticate, where you will go through the MFA (Multifactor Authentication) and complete login to your Entra ID account.</li>
<li>Once authenicated you can run:
az ssh vm -n cistest -g cistest
Note: -n is the VM name and -g is the Resource Group, that the VM is located inside.</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Entra ID Login - Linux VM" src="/assets/images/CISHardenedImageEntraIDLogin-57ade4e971d8a17ca09fccf77b983a04.gif" width="1632" height="688" class="img_ev3q"></p>
<p>You should now have successfully authenticated to your Linux virtual machine using Entra ID credendials.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h3>
<p>If you are unable to connect, it may be due to an issue with the AADSSHLogin extension. You can troubleshoot by reviewing the extension log.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cat /var/log/azure/Microsoft.Azure.ActiveDirectory.AADSSHLoginForLinux/CommandExecution.log</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The Azure directory is protected, so you will need Administrator rights to delve into the logs.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/azure/Changing-default-management-group-for-azure/">Changing the default Management Group in Azure</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-07-17T00:00:00.000Z">July 17, 2023</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Luke Murray</span></a></div><small class="authorTitle_nd0D" title="Author">Author</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>By default, when a <a href="https://learn.microsoft.com/azure/governance/management-groups/overview?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Management Group</a> gets created, it goes under the Root Management Group, the same is true for <a href="https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/organize-subscriptions?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Subscriptions</a>.</p>
<p>This works fine, when you have a simple Microsoft Azure environment, but as soon as you start expanding into areas such as <a href="https://learn.microsoft.com/azure/architecture/landing-zones/subscription-vending?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Subscription vending</a> or limited access to who can see the Root Management Group and start to look into Visual Studio Enterprise subscriptions, you may want to consider moving new subscriptions, under its own Management Group, away from any policies or RBAC controls, essentially into a Management Group that acts as a shopping cart, to then be picked up and moved later.</p>
<p>If we refer to a <a href="https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups?WT.mc_id=AZ-MVP-5004796#management-group-recommendations" target="_blank" rel="noopener noreferrer">recommendation</a> on the Microsoft Cloud Adoption Framework:</p>
<blockquote>
<p>Configure a default, dedicated management group for new subscriptions. This group ensures that no subscriptions are placed under the root management group. This group is especially important if there are users eligible for Microsoft Developer Network (MSDN) or Visual Studio benefits and subscriptions. A good candidate for this type of management group is a <a href="https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/sandbox-environments?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">sandbox</a> management group.</p>
</blockquote>
<p>So, how can we change the default Management Group, that new Subscriptions go into?</p>
<p>Lets take a look at the different ways we could use to update the default management group, that new subscriptions go into.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-using-azure-portal">Configure using Azure Portal<a href="#configure-using-azure-portal" class="hash-link" aria-label="Direct link to Configure using Azure Portal" title="Direct link to Configure using Azure Portal">​</a></h3>
<ol>
<li>Use the search bar to search for and select &#x27;Management groups&#x27;.</li>
<li>On the root management group, select details next to the name of the management group.</li>
<li>Under Settings, select Hierarchy settings.</li>
<li>Select the Change default management group button.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-using-bicep">Configuring using Bicep<a href="#configuring-using-bicep" class="hash-link" aria-label="Direct link to Configuring using Bicep" title="Direct link to Configuring using Bicep">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">resource symbolicname &#x27;Microsoft.Management/managementGroups/settings@2021-04-01&#x27; = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">name: &#x27;default&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">parent: resourceSymbolicName</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">properties: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">defaultManagementGroup: &#x27;string&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">requireAuthorizationForGroupCreation: bool</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Reference: <a href="https://learn.microsoft.com/en-us/azure/templates/microsoft.management/managementgroups/settings?pivots=deployment-language-bicep&amp;WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Microsoft.Management managementGroups/settings</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-using-rest-api-using-powershell">Configure using REST API using PowerShell<a href="#configure-using-rest-api-using-powershell" class="hash-link" aria-label="Direct link to Configure using REST API using PowerShell" title="Direct link to Configure using REST API using PowerShell">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$root_management_group_id = &quot;Enter the ID of root management group&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$default_management_group_id = &quot;Enter the ID of default management group (or use the same ID of the root management group)&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$body = &#x27;{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> &quot;properties&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;defaultManagementGroup&quot;: &quot;/providers/Microsoft.Management/managementGroups/&#x27; + $default_management_group_id + &#x27;&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &quot;requireAuthorizationForGroupCreation&quot;: true</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$token = (Get-AzAccessToken).Token</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$headers = @{&quot;Authorization&quot;= &quot;Bearer $token&quot;; &quot;Content-Type&quot;= &quot;application/json&quot;}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$uri = &quot;https://management.azure.com/providers/Microsoft.Management/managementGroups/$root_management_group_id/settings/default?api-version=2021-04-01&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Invoke-RestMethod -Method PUT -Uri $uri -Headers $headers -Body $body</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-using-terraform">Configure using Terraform<a href="#configure-using-terraform" class="hash-link" aria-label="Direct link to Configure using Terraform" title="Direct link to Configure using Terraform">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">resource &quot;azurerm_management_group_subscription_association&quot; &quot;example&quot; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">management_group_id = data.azurerm_management_group.example.id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">subscription_id     = data.azurerm_subscription.example.id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note: Not quite the same, as configuring the default setting as above - but you can specify the Managament Group association for subscriptions using Terraform.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/azure/Access-denied-aztfexport/">Access denied on Azure VM when using aztfexport</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-07-10T00:00:00.000Z">July 10, 2023</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Luke Murray</span></a></div><small class="authorTitle_nd0D" title="Author">Author</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>When attempting to use <a href="https://github.com/Azure/aztfexport" target="_blank" rel="noopener noreferrer">aztfexport</a>, a tool designed to export currently deployed Azure resources into HashiCorp Configuration Language (HCL) for use with Terraform, you may get: Access denied.</p>
<p>When using aztfexport, the first thing you need to do is make sure you have the <a href="https://learn.microsoft.com/cli/azure/install-azure-cli?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Azure CLI</a> installed, and run an:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">az login</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After logging in, you need to verify you are on the right subscription, by running:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">az account show</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you are on the right subscription, you don&#x27;t need to do anything. If you are in the wrong subscription then run:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">az account list</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Find the susbcription ID then use:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">az account set --subscription &lt;name or id&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>You only need Reader rights to be able to export the Terraform configuration.</strong></p>
<p>If you find you are still running into access denied issues, such as below:</p>
<p><img decoding="async" loading="lazy" alt="aztfexport - Access denied" src="/assets/images/aztfexport_access_denied-8ef0fba28e1aa69827b029bd565978e3.png" title="aztfexport - Access denied" width="1172" height="458" class="img_ev3q"></p>
<p>And you are running the aztfexport program on an Azure Virtual Machine, such as Azure Virtual Desktop or Devbox, what is happening is the <a href="https://learn.microsoft.com/azure/active-directory/managed-identities-azure-resources/overview?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Managed Identity</a> permissions of your Azure Virtual Machine is overriding your own permissions you used to login to Azure using the CLI.</p>
<p>To get around this, you either have to run aztfexport locally, on a device thats not an Azure Virtual Machine, or supply the Managed Identity of the Virtual Machine, Reader rights to the subscription you wish to do the export from.</p>
<p>You can do this, by navigating to your Azure Virtual Machine, in the Azure Portal, click on the Virtual Machine, select Identity, select Azure role assignments and grant it Reader rights to the Resource Group or Subscription you are targeting.</p>
<p>You could try Disabling the System Assigned Managed Identity as well, which appeared to work for me.</p>
<p>For more information about this error, please refer to the following Github issue: <a href="https://github.com/Azure/aztfexport/issues/380" target="_blank" rel="noopener noreferrer">Access Denied during xport on Azure Virtual Desktop</a>.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/azure/Azure-OpenAI-error-log-summarization/">Azure OpenAI error log summarization with completion</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-07-10T00:00:00.000Z">July 10, 2023</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Luke Murray</span></a></div><small class="authorTitle_nd0D" title="Author">Author</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>I was assisting a user on <a href="https://learn.microsoft.com/en-us/answers/questions/?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Microsoft Q&amp;A</a> with an issue, that involved looking over some event logs.</p>
<p>The issue itself was related to the Nested Virtualization, with the user unable to install Hyper-V or WSL (Windows Subsystem for Linux), it turned out to be <a href="https://learn.microsoft.com/azure/virtual-machines/trusted-launch?WT.c_id=AZ-MVP-5004796#unsupported-features" target="_blank" rel="noopener noreferrer">incompatilibies with the SKU size and Secure boot</a>.</p>
<p>But as part of troubleshooting this issue, I recreated the Azure compute environment, this user had and started to delve into the Windows logs.</p>
<p>However, in this case I did something a bit different, I exported the logs as text file and opened up <a href="https://learn.microsoft.com/azure/cognitive-services/openai/overview?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Azure OpenAI</a>, then navigated to Azure OpenAI Studio, clicked on Completion and used the summarization powers of the GPT 3.5 Large language model, to delve into the logs for me:</p>
<p><img decoding="async" loading="lazy" alt="Azure OpenAI - Summarize Error Log" src="/assets/images/AzureOpenAI_Completion_ErrorLog-7fdb686bacc40f441b9f02ee88ee4925.png" title="Azure OpenAI - Summarize Error Log" width="1541" height="922" class="img_ev3q"></p>
<p>Copying, the Log into the Completion pane of Azure OpenAI</p>
<p>And using  the Prompt of:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">----</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Summarize all the errors and warnings from above and sort by potential cause of the issues, with the most likely cause first. Format as a table.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Azure OpenAI was able to use the reasoning ability of the GPT 3.5 LLM (Large language Model) to sort through 115 lines of Logs, and work out the probability of what could be causing the root cause of the issue.</p>
<p>As you can see, Azure OpenAI and the LLMs can not just be used as an assistant in writing, studying it can be learned to assist in Incident and root-cause resolution.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/tags/azure/page/11/"><div class="pagination-nav__label">Newer entries</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/tags/azure/page/13/"><div class="pagination-nav__label">Older entries</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 luke.geek.nz. Powered by coffee, clouds and hamsters on wheels!</div></div></div></footer></div>
</body>
</html>