<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">121 posts tagged with &quot;Azure&quot; | luke.geek.nz</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://luke.geek.nz/img/social-card.png"><meta data-rh="true" name="twitter:image" content="https://luke.geek.nz/img/social-card.png"><meta data-rh="true" property="og:url" content="https://luke.geek.nz/tags/azure/page/4/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="121 posts tagged with &quot;Azure&quot; | luke.geek.nz"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://luke.geek.nz/tags/azure/page/4/"><link data-rh="true" rel="alternate" href="https://luke.geek.nz/tags/azure/page/4/" hreflang="en"><link data-rh="true" rel="alternate" href="https://luke.geek.nz/tags/azure/page/4/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://ZBH2T1WJQD-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="luke.geek.nz RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="luke.geek.nz Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="luke.geek.nz JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0QDLBY7NNN"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0QDLBY7NNN",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.59c32649.css">
<script src="/assets/js/runtime~main.0d755d84.js" defer="defer"></script>
<script src="/assets/js/main.9ef27f34.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#D3D3D3" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">Happy New Year! This is a redesign of my website, hopefully you like it!</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="luke.geek.nz" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="luke.geek.nz" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">luke.geek.nz</b></a><a class="navbar__item navbar__link" href="/Tags/">Tags</a><a class="navbar__item navbar__link" href="/Archive/">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://www.youtube.com/channel/UCUG3TKDTAZz4UXshGrjBBoQ" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="YouTube">
              <svg width="24" height="24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M23.498,6.186c-0.273-1.186-1.143-2.144-2.332-2.417C18.389,3.153,12,3.153,12,3.153s-6.389,0-9.166,0.616
                  c-1.19,0.273-2.06,1.23-2.332,2.417C0,8.07,0,12,0,12s0,3.93,0.502,5.814c0.272,1.187,1.142,2.062,2.332,2.335
                  C5.611,20.847,12,20.847,12,20.847s6.389,0,9.166-0.698c1.189-0.273,2.059-1.148,2.332-2.335C24,15.93,24,12,24,12
                  S24,8.07,23.498,6.186z M9.545,15.568V8.432l6.545,3.568L9.545,15.568z"/>
              </svg>
            </a><a href="https://aus.social/@lukemurray" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="Mastodon">
              <svg height="20" width="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" xml:space="preserve">
                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                <g id="SVGRepo_iconCarrier">
                  <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.510 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"></path>
                </g>
              </svg>
            </a><a href="https://bsky.app/profile/lukemurraynz.bsky.social" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="Bluesky">
              <svg class="octicon" xmlns="http://www.w3.org/2000/svg" role="img" viewBox="0 0 16 16" height="20" width="20" fill="currentColor">
                <title>Bluesky</title>
                <path d="M8 7.2c-.72-1.4-2.7-4.04-4.53-5.33C1.7.63 1.04.84.6 1.04.1 1.27 0 2.05 0 2.51c0 .46.25 3.77.42 4.32.54 1.82 2.47 2.45 4.25 2.25-2.6.38-4.92 1.33-1.88 4.71 3.33 3.46 4.57-.74 5.21-2.87.64 2.13 1.37 6.18 5.16 2.87 2.84-2.87.78-4.33-1.83-4.71 1.78.2 3.71-.43 4.25-2.25.17-.55.42-3.86.42-4.32 0-.46-.09-1.24-.6-1.47-.44-.2-1.11-.42-2.87.83A17.87 17.87 0 0 0 8 7.2Z"></path>
              </svg>
            </a><a href="https://twitter.com/lukemurraynz" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="X"><svg height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 8.586l4.293-4.293a1 1 0 011.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 011.414-1.414L10 8.586z" clip-rule="evenodd"/>
          </svg></a><a href="https://www.linkedin.com/in/ljmurray/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="LinkedIn"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/azure-naming-tool-api-bicep-resources/">Using the Azure Naming Tool API to name your Bicep resources</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/existing-resource-deploymentstack/">Add existing Azure resource to a Deployment Stack</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/service-namespace-invalid-eventhub/">The specified service namespace is invalid EventHub</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/azure-email-communication-services/">Deploying and Testing Azure Email Communication Services</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/microsoft-copilot-azure-preview/">Microsoft Copilot for Azure - Preview</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><header class="margin-bottom--xl"><h1>121 posts tagged with &quot;Azure&quot;</h1><a href="/tags/">View All Tags</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="When considering build agents to use in Azure DevOps (or GitHub), there are 2 main options to consider:"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/azure/hosted-agents-container-apps-job/">Get Ahead with Self-Hosted Agents and Container Apps Jobs</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-09-13T00:00:00.000Z" itemprop="datePublished">September 13, 2023</time> · <!-- -->23 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Luke Murray</span></a></div><small class="avatar__subtitle" itemprop="description">Author</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>When considering <a href="https://learn.microsoft.com/azure/devops/pipelines/agents/agents?view=azure-devops&amp;tabs=yaml%2Cbrowser&amp;WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">build agents</a> to use in <a href="https://azure.microsoft.com/products/devops?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Azure DevOps</a> <em>(or <a href="https://docs.github.com/en/actions/using-github-hosted-runners/about-github-hosted-runners" target="_blank" rel="noopener noreferrer">GitHub</a>)</em>, there are 2 main options to consider:</p>

















<table><thead><tr><th>Agent type</th><th>Description</th></tr></thead><tbody><tr><td><a href="https://learn.microsoft.com/azure/devops/pipelines/agents/agents?view=azure-devops&amp;tabs=yaml%2Cbrowser&amp;WT.mc_id=AZ-MVP-5004796#microsoft-hosted-agents" target="_blank" rel="noopener noreferrer">Microsoft-hosted agents</a></td><td>Agents hosted and managed by Microsoft</td></tr><tr><td><a href="https://learn.microsoft.com/azure/devops/pipelines/agents/agents?view=azure-devops&amp;tabs=yaml%2Cbrowser&amp;WT.mc_id=AZ-MVP-5004796#install" target="_blank" rel="noopener noreferrer">Self-hosted agents</a></td><td>Agents that you configure and manage, hosted on your VMs</td></tr></tbody></table>
<p><a href="https://learn.microsoft.com/en-us/azure/devops/pipelines/agents/hosted?view=azure-devops&amp;tabs=yaml&amp;WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Microsoft-hosted agents</a>, can be used for most things, but there are times where you may need to talk to internal company resources, or security is a concern, which is when you would consider self-hosting the agent yourself.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Get Ahead with Self-Hosted Agents and Container Apps Jobs" href="/azure/hosted-agents-container-apps-job/"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="Deployment Stacks! What is it? insert confused look*"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/azure/Azure-Bicep-Deployment-with-Deployment-Stacks/">Azure Bicep Deployment with Deployment Stacks</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-08-28T00:00:00.000Z" itemprop="datePublished">August 28, 2023</time> · <!-- -->14 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Luke Murray</span></a></div><small class="avatar__subtitle" itemprop="description">Author</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p><a href="https://learn.microsoft.com/azure/azure-resource-manager/bicep/deployment-stacks?tabs=azure-powershell&amp;WT.mc*id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Deployment Stacks</a>! What is it? <em>insert confused look</em></p>
<p>Maybe you have been browsing the Microsoft Azure Portal and noticed a new section in the management blade called: Deployment stacks and wondered what it was, and how you can use it.</p>
<p>Let us take a look!</p>
<blockquote>
<p>Before we get started its worth noting that as of the time of this article, this feature is under Public Preview. Features or ways of working with Deployment Stacks may change, when it becomes generally available. If you run into issues, make sure you have a look at the current <a href="https://learn.microsoft.com/en-us/azure/azure-resource-manager/bicep/deployment-stacks?tabs=azure-powershell&amp;WT.mc*id=AZ-MVP-5004796#known-issues" target="_blank" rel="noopener noreferrer">known issues</a>.</p>
</blockquote>
<p><img loading="lazy" alt="Automate your Azure Bicep deployment with ease using Deployment Stacks" src="/assets/images/Blog-Header-AzureDeploymentStacks-564504ae73ac88f9d1e0596f5c6ab693.gif" width="1200" height="628" class="img_ev3q"></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h5>
<p><a href="https://learn.microsoft.com/azure/azure-resource-manager/bicep/deployment-stacks?tabs=azure-powershell&amp;WT.mc*id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Azure Deployment Stacks</a> are a type of Azure resource that allows you to manage a group of Azure resources as an atomic unit.</p>
<p>When you submit a Bicep file or an ARM template to a deployment stack, it defines the resources that are managed by the stack.</p>
<p>You can create and update deployment stacks using Azure CLI, Azure PowerShell, or the Azure portal along with Bicep files. These Bicep files are transpiled into ARM JSON templates, which are then deployed as a deployment object by the stack.</p>
<p>Deployment stacks offer additional capabilities beyond regular deployment resources, such as simplified provisioning and management of resources, preventing undesired modifications to managed resources, efficient environment cleanup, and the ability to utilize standard templates like Bicep, ARM templates, or Template specs.</p>
<blockquote>
<p>When planning your deployment and determining which resource groups should be part of the same stack, it&#x27;s important to consider the management lifecycle of those resources, which includes creation, updating, and deletion. For instance, suppose you need to provision some test VMs for various application teams across different resource group scopes.</p>
</blockquote>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="comparisons">Comparisons<a href="#comparisons" class="hash-link" aria-label="Direct link to Comparisons" title="Direct link to Comparisons">​</a></h5>
<p>Before we dig into it further, it may help to give you a comparison between the different products and where Deployment Stacks, could be used, lets us take a look at a comparison, between similar products, that may come to mind, such as:</p>
<ul>
<li>Azure Blueprints</li>
<li>Bicep <em>(on its own)</em></li>
<li>Template Specs</li>
<li>Terraform</li>
</ul>





















































<table><thead><tr><th>Feature</th><th>Deployment Stacks</th><th>Azure Blueprints</th><th>Using Bicep</th><th>Template Specs</th><th>Terraform</th></tr></thead><tbody><tr><td>Management of Resources</td><td>Manages a group of Azure resources as an atomic unit.</td><td>Defines and deploys a repeatable set of Azure resources that adhere to organizational standards.</td><td>Defines and deploys Azure resources using a declarative language.</td><td>Defines and deploys reusable infrastructure code using template specs.</td><td>Defines and provisions infrastructure resources across various cloud providers using a declarative language.</td></tr><tr><td>Resource Definition</td><td>Bicep files or ARM JSON templates are used to define the resources managed by the stack.</td><td>Blueprint artifacts, including ARM templates, policy assignments, role assignments, and resource groups, are used to define the blueprint.</td><td>Bicep files are used to define the Azure resources.</td><td>Template specs are used to define reusable infrastructure code.</td><td>Terraform configuration files are used to define the infrastructure resources.</td></tr><tr><td>Access Control</td><td>Access to the deployment stack can be restricted using Azure role-based access control (Azure RBAC).</td><td>Access to blueprints is managed through Azure role-based access control (Azure RBAC).</td><td>Access to Azure resources is managed through Azure role-based access control (Azure RBAC).</td><td>Access to template specs is managed through Azure role-based access control (Azure RBAC).</td><td>Access to cloud resources is managed through provider-specific authentication mechanisms.</td></tr><tr><td>Benefits</td><td><em>Simplified provisioning and management of resources as a cohesive entity.</em>  Preventing undesired modifications to managed resources.*Efficient environment cleanup.*Utilizing standard templates such as Bicep, ARM templates, or Template specs for your deployment stacks.</td><td><em>Rapidly build and start up new environments with organizational compliance.</em>  Built-in components for speeding up development and delivery.</td><td>*Easier management and deployment of Azure resources.*Improved readability and understanding of resource configurations.</td><td>*  Publish libraries of reusable infrastructure code.</td><td>*  Infrastructure-as-Code approach for provisioning resources across multiple cloud providers.</td></tr><tr><td>Deprecation</td><td>N/A</td><td>Azure Blueprints (Preview) will be deprecated.</td><td>N/A</td><td>N/A</td><td>N/A</td></tr></tbody></table>
<p><em>It is always recommended to refer to the <a href="https://learn.microsoft.com/?WT.mc*id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">official documentation</a> for the most up-to-date and comprehensive information. The comparison table above, was created with the help of AI.</em></p>
<p>It is hard to do a complete comparison, as always &#x27;it depends&#x27; on your use cases and requirements, but hopefully this makes it clear where Deployment Stacks come into play (and it does not replace Bicep but works with it for better governance), with out-of-the-box benefits such as:</p>
<ul>
<li>Simplified provisioning and management of resources across different scopes as a cohesive entity.</li>
<li>Preventing undesired modifications to managed resources through deny settings.</li>
<li>Efficient environment cleanup by employing delete flags during deployment stack updates.</li>
<li>Utilizing standard templates such as Bicep, ARM templates, or Template specs for your deployment stacks.</li>
</ul>
<blockquote>
<p>The key here is that Azure Deployment Stacks, is a native way to treat your infrastructure components as an atmonic unit or stack, so you manage the lifecycle of the resources as a whole vs every resource separately.</p>
</blockquote>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="using-deployment-stacks">Using Deployment Stacks<a href="#using-deployment-stacks" class="hash-link" aria-label="Direct link to Using Deployment Stacks" title="Direct link to Using Deployment Stacks">​</a></h5>
<p>Deployment stacks requires <a href="https://learn.microsoft.com/powershell/azure/install-azure-powershell?WT.mc*id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Azure PowerShell</a> <em>(version 10.1.0 or later)</em> or <a href="https://learn.microsoft.com/cli/azure/install-azure-cli?WT.mc*id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Azure CLI</a> <em>(version 2.50.0 or later)</em>.</p>
<p>For the purposes of this article, I will be using PowerShell.</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="powershell">PowerShell<a href="#powershell" class="hash-link" aria-label="Direct link to PowerShell" title="Direct link to PowerShell">​</a></h6>
<p>Once you have the latest Azure PowerShell modules, its time to take a look at the cmdlets, that are offered to us for Deployment Stacks.</p>
<p>Open your PowerShell terminal and type in:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Get-Command -Name *DeploymentStack*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="Get-Command -Name DeploymentStack" src="/assets/images/DeploymentStacks-PowerShellCmdlets-026dd255d9fafc37ec418ee45204b5a6.gif" width="1025" height="309" class="img_ev3q">
As you can see, there are a range of cmdlets we have to work with.</p>
<p>For the purpose of this article, I will be using a Bicep file, I already have on hand (unmodified for Deployment Stacks). This bicep file will create:</p>
<ul>
<li>2 Virtual Networks</li>
<li>4 Subnets <em>(2 subnets in each Virtual Network)</em></li>
<li>4 NSGs <em>(and assign to each subnet, with Deny All rules)</em></li>
<li>Then finally, peer the virtual networks.</li>
</ul>
<p>This is the Bicep file:</p>
<div class="language-bicep codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_Ktv7">main.bicep</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bicep codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token decorator">@description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Name of the virtual network.&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">param</span><span class="token plain"> vnetName </span><span class="token datatype class-name">string</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;myVnet&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token decorator">@description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Name of the first subnet.&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">param</span><span class="token plain"> subnet1Name </span><span class="token datatype class-name">string</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;subnet1&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token decorator">@description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Name of the second subnet.&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">param</span><span class="token plain"> subnet2Name </span><span class="token datatype class-name">string</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;subnet2&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token decorator">@description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Name of the first network security group.&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">param</span><span class="token plain"> nsg1Name </span><span class="token datatype class-name">string</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;nsg1&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token decorator">@description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Name of the second network security group.&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">param</span><span class="token plain"> nsg2Name </span><span class="token datatype class-name">string</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;nsg2&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token decorator">@description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Name of the second virtual network.&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">param</span><span class="token plain"> vnet2Name </span><span class="token datatype class-name">string</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;myVnet2&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token decorator">@description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Name of the third subnet.&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">param</span><span class="token plain"> subnet3Name </span><span class="token datatype class-name">string</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;subnet3&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token decorator">@description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Name of the fourth subnet.&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">param</span><span class="token plain"> subnet4Name </span><span class="token datatype class-name">string</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;subnet4&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token decorator">@description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Name of the third network security group.&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">param</span><span class="token plain"> nsg3Name </span><span class="token datatype class-name">string</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;nsg3&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token decorator">@description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Name of the fourth network security group.&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">param</span><span class="token plain"> nsg4Name </span><span class="token datatype class-name">string</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;nsg4&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token decorator">@description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Location for all resources.&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">param</span><span class="token plain"> location </span><span class="token datatype class-name">string</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">resourceGroup</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">resource</span><span class="token plain"> vnet </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Microsoft.Network/virtualNetworks@2023-04-01&#x27;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">name</span><span class="token operator">:</span><span class="token plain"> vnetName</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">location</span><span class="token operator">:</span><span class="token plain"> location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">properties</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">addressSpace</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">addressPrefixes</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;10.0.0.0/16&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">resource</span><span class="token plain"> subnet1 </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Microsoft.Network/virtualNetworks/subnets@2023-04-01&#x27;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">parent</span><span class="token operator">:</span><span class="token plain"> vnet</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">name</span><span class="token operator">:</span><span class="token plain"> subnet1Name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">properties</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">addressPrefix</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;10.0.1.0/24&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">networkSecurityGroup</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">id</span><span class="token operator">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">resourceId</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Microsoft.Network/networkSecurityGroups&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> nsg1Name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">resource</span><span class="token plain"> subnet2 </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Microsoft.Network/virtualNetworks/subnets@2023-04-01&#x27;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">parent</span><span class="token operator">:</span><span class="token plain"> vnet</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">name</span><span class="token operator">:</span><span class="token plain"> subnet2Name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">properties</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">addressPrefix</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;10.0.2.0/24&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">networkSecurityGroup</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">id</span><span class="token operator">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">resourceId</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Microsoft.Network/networkSecurityGroups&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> nsg2Name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">resource</span><span class="token plain"> nsg1 </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Microsoft.Network/networkSecurityGroups@2023-04-01&#x27;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">name</span><span class="token operator">:</span><span class="token plain"> nsg1Name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">location</span><span class="token operator">:</span><span class="token plain"> location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">properties</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">flushConnection</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">securityRules</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Deny-All-Inbound&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">properties</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">priority</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">4096</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">access</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Deny&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">direction</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Inbound&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">destinationPortRange</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;*&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">protocol</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Tcp&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">sourcePortRange</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;*&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">destinationAddressPrefix</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;*&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">sourceAddressPrefix</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;*&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">resource</span><span class="token plain"> nsg2 </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Microsoft.Network/networkSecurityGroups@2023-04-01&#x27;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">name</span><span class="token operator">:</span><span class="token plain"> nsg2Name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">location</span><span class="token operator">:</span><span class="token plain"> location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">properties</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">flushConnection</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">securityRules</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Deny-All-Inbound&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">properties</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">priority</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">4096</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">access</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Deny&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">direction</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Inbound&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">destinationPortRange</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;*&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">protocol</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Tcp&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">sourcePortRange</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;*&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">destinationAddressPrefix</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;*&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">sourceAddressPrefix</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;*&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">resource</span><span class="token plain"> vnet2 </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Microsoft.Network/virtualNetworks@2023-04-01&#x27;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">name</span><span class="token operator">:</span><span class="token plain"> vnet2Name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">location</span><span class="token operator">:</span><span class="token plain"> location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">properties</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">addressSpace</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">addressPrefixes</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;10.1.0.0/16&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">resource</span><span class="token plain"> subnet3 </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Microsoft.Network/virtualNetworks/subnets@2023-04-01&#x27;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">parent</span><span class="token operator">:</span><span class="token plain"> vnet2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">name</span><span class="token operator">:</span><span class="token plain"> subnet3Name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">properties</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">addressPrefix</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;10.1.1.0/24&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">networkSecurityGroup</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">id</span><span class="token operator">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">resourceId</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Microsoft.Network/networkSecurityGroups&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> nsg3Name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">resource</span><span class="token plain"> subnet4 </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Microsoft.Network/virtualNetworks/subnets@2023-04-01&#x27;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">parent</span><span class="token operator">:</span><span class="token plain"> vnet2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">name</span><span class="token operator">:</span><span class="token plain"> subnet4Name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">properties</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">addressPrefix</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;10.1.2.0/24&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">networkSecurityGroup</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">id</span><span class="token operator">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">resourceId</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Microsoft.Network/networkSecurityGroups&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> nsg4Name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">resource</span><span class="token plain"> nsg3 </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Microsoft.Network/networkSecurityGroups@2023-04-01&#x27;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">name</span><span class="token operator">:</span><span class="token plain"> nsg3Name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">location</span><span class="token operator">:</span><span class="token plain"> location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">properties</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">flushConnection</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">securityRules</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Deny-All-Inbound&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">properties</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">priority</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">4096</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">access</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Deny&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">direction</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Inbound&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">destinationPortRange</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;*&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">protocol</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Tcp&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">sourcePortRange</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;*&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">destinationAddressPrefix</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;*&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">sourceAddressPrefix</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;*&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">resource</span><span class="token plain"> nsg4 </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Microsoft.Network/networkSecurityGroups@2023-04-01&#x27;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">name</span><span class="token operator">:</span><span class="token plain"> nsg4Name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">location</span><span class="token operator">:</span><span class="token plain"> location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">properties</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">flushConnection</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">securityRules</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Deny-All-Inbound&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">properties</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">priority</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">4096</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">access</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Deny&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">direction</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Inbound&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">destinationPortRange</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;*&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">protocol</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Tcp&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">sourcePortRange</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;*&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">destinationAddressPrefix</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;*&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token property">sourceAddressPrefix</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;*&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">resource</span><span class="token plain"> vnetPeering </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Microsoft.Network/virtualNetworks/virtualNetworkPeerings@2023-04-01&#x27;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">parent</span><span class="token operator">:</span><span class="token plain"> vnet</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">name</span><span class="token operator">:</span><span class="token plain"> vnet2Name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">properties</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">remoteVirtualNetwork</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">id</span><span class="token operator">:</span><span class="token plain"> vnet2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">allowVirtualNetworkAccess</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">allowForwardedTraffic</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">allowGatewayTransit</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">useRemoteGateways</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">dependsOn</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    subnet1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    subnet3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">resource</span><span class="token plain"> vnetPeering2 </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Microsoft.Network/virtualNetworks/virtualNetworkPeerings@2023-04-01&#x27;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">parent</span><span class="token operator">:</span><span class="token plain"> vnet2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">name</span><span class="token operator">:</span><span class="token plain"> vnetName</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">properties</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">remoteVirtualNetwork</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">id</span><span class="token operator">:</span><span class="token plain"> vnet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">allowVirtualNetworkAccess</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">allowForwardedTraffic</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">allowGatewayTransit</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">useRemoteGateways</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">dependsOn</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    subnet2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    subnet4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    vnetPeering</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>I have already deployed a new Resource Group to deploy our virtual network into:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">New-AzResourceGroup -Name &#x27;rg-network&#x27; -Location &#x27;Australia East&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>So let us create our first Deployment Stack!</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="new-azresourcegroupdeploymentstack">New-AzResourceGroupDeploymentStack<a href="#new-azresourcegroupdeploymentstack" class="hash-link" aria-label="Direct link to New-AzResourceGroupDeploymentStack" title="Direct link to New-AzResourceGroupDeploymentStack">​</a></h6>
<p>The &#x27;New-AzResourceGroupDeploymentStack&#x27; cmdlet is the first one we will look into.</p>
<p>Let us look at the most common syntax that you may use:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">New-AzResourceGroupDeploymentStack -Name &quot;&lt;deployment-stack-name&gt;&quot; -TemplateFile &quot;&lt;bicep-file-name&gt;&quot; -DeploymentResourceGroupName &quot;&lt;resource-group-name&gt;&quot; -DenySettingsMode &quot;none&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>









































<table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><code>-Name</code></td><td>Specifies the name of the deployment stack.</td></tr><tr><td><code>-Location</code></td><td>Specifies the Azure region where the deployment stack will be created. This is valid for Subscription based DeploymentStacks.</td></tr><tr><td><code>-TemplateFile</code></td><td>Specifies the Bicep file that defines the resources to be managed by the deployment stack.</td></tr><tr><td><code>-DeploymentResourceGroupName</code></td><td>Specifies the name of the resource group where the managed resources will be stored.</td></tr><tr><td><code>-DenySettingsMode</code></td><td>Specifies the operations that are prohibited on the managed resources to safeguard against unauthorized deletion or updates. Possible values include &quot;none&quot;, &quot;DenyDelete&quot;, &quot;DenyWriteAndDelete&quot;.</td></tr><tr><td><code>-DeleteResources</code></td><td>Deletes the managed resources associated with the deployment stack.</td></tr><tr><td><code>-DeleteAll</code></td><td>Deletes all deployment stacks and their associated resources.</td></tr><tr><td><code>-DeleteResourceGroups</code></td><td>Deletes the resource groups associated with the deployment stacks.</td></tr></tbody></table>
<p>These parameters allow you to customize the creation and management of deployment stacks.</p>
<p>The DenySettingsMode parameter is used in Azure Deployment Stacks to assign specific permissions to managed resources, preventing their deletion by unauthorized security principals, this is a key differentiator to some of the other solutions mentioned earlier, but it does mean you need to think about how your resources will be managed, let us take a look at the DenySettingsMode a bit deeper.</p>
<p>The DenySettingsMode parameter accepts different values to define the level of deny settings. Some of the possible values include:</p>
<ul>
<li>&quot;none&quot;: No deny settings are applied, allowing all operations on the managed resources.</li>
<li>&quot;DenyDelete&quot;: Denies the delete operation on the managed resources, preventing their deletion.</li>
<li>&quot;DenyWriteAndDelete&quot;: Denies all operations on the managed resources, preventing any modifications or deletions.</li>
</ul>
<p>By specifying the appropriate DenySettingsMode value, you can control the level of permissions and restrictions on the managed resources within the deployment stack.</p>
<p>For our testing, we will deploy our Azure Virtual Networks, NSGs to a new Deployment Stack, using the DenyDelete DenySettingMode.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$RGName = &#x27;rg-network&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$DenySettings = &#x27;DenyDelete&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$BicepFileName = &#x27;main.bicep&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$DeploymentStackName = &#x27;NetworkProd&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">New-AzResourceGroupDeploymentStack -Name $DeploymentStackName -TemplateFile $BicepFileName -ResourceGroupName $RGName -DenySettingsMode $DenySettings -DenySettingsApplyToChildScopes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="New-AzResourceGroupDeploymentStack" src="/assets/images/DeploymentStacks-NewAzResourceGroupDeployment-9bddf7b908a3977665163564aa2050d7.gif" width="1072" height="386" class="img_ev3q"></p>
<p>As you can see, creating a new Azure Deployment Stack is easy, with no adjustments to the underlying Bicep configuration needed.</p>
<p><em>Note: If you get an error, that the cmdlet is missing -Name parameter, make sure that the -ResourceGroupName parameter has been added.</em></p>
<p>If we navigate to the Azure Portal, we can see the Deployment Stack natively, including the Stack properties, such as what are the actions if resources are removed, what the denyDelete mode is.</p>
<p><img loading="lazy" alt="New-AzResourceGroupDeploymentStack" src="/assets/images/DeploymentStacks-AzurePortalOverview-2549a0ef65077b64ea30eea043d768e7.gif" width="1697" height="874" class="img_ev3q"></p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="testing-deny-assignment">Testing Deny-Assignment<a href="#testing-deny-assignment" class="hash-link" aria-label="Direct link to Testing Deny-Assignment" title="Direct link to Testing Deny-Assignment">​</a></h6>
<p>As we deployed our virtual networks, using the denyDelete assignment, lets take a look and attempt to delete a Network Security Group, before we do that we need to dissociate it from the subnet.</p>
<p><em>Note: Its worth noting my permissions are: Owner.</em></p>
<p>When I attempted to delete a Network Security Group I get the error below:</p>
<blockquote>
<p>Failed to delete network security group &#x27;nsg1&#x27;. Error: The client &#x27;************&#x27; with object id &#x27;cb059544-e63c-4543-930f-4b6e6b7aece1&#x27; has permission to perform action &#x27;Microsoft.Network/networkSecurityGroups/delete&#x27; on scope &#x27;rg-network/providers/Microsoft.Network/networkSecurityGroups/nsg1&#x27;&gt;nsg1&#x27;; however, the access is denied because of the deny assignment with name &#x27;Deny assignment &#x27;55ebfe82-255d-584a-8579-0e0c9f0219ff&#x27; created by Deployment Stack &#x27;/subscriptions/f0ee3c31-ff51-4d47-beb2-b1204a511f63&#x27;.</p>
</blockquote>
<p><img loading="lazy" alt="Azure Deployment Stack - Delete Resource Test" src="/assets/images/DeploymentStacks-AzurePortal-DenyAssignmentTest-c5eb08ba80367c9b541c85fa0f77b600.gif" width="1697" height="874" class="img_ev3q"></p>
<p>To delete the resource, I would need to, do one of the following:</p>
<ul>
<li>Delete the Deployment Stack (and detach the resources and delete it manually)</li>
<li>Delete the Deployment Stack (and delete all the resources)</li>
<li>Remove from the bicep code and update deployment stack.</li>
</ul>
<p>Note: In our testing, we were able to disassociate the Network Security Group, from the Subnet, because when the deployment stack was deployed - it was with the: denyDelete assignment, not the:&#x27;DenyWriteAndDelete&#x27;.</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="redeploy---deployment-stack-portal">Redeploy - Deployment Stack (Portal)<a href="#redeploy---deployment-stack-portal" class="hash-link" aria-label="Direct link to Redeploy - Deployment Stack (Portal)" title="Direct link to Redeploy - Deployment Stack (Portal)">​</a></h6>
<p>Using the Azure Portal, we can Edit and re-deploy our existing Deployment stack, if you have changes or resources that you may want to roll back:</p>
<p><img loading="lazy" alt="Azure Deployment Stack - Delete Resource Test" src="/assets/images/DeploymentStacks-AzurePortal-RedeployDeploymentStack-21280487c4e7d54cdd121c45554f2b17.gif" width="1697" height="874" class="img_ev3q"></p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="redeploy---deployment-stack-bicep">Redeploy - Deployment Stack (Bicep)<a href="#redeploy---deployment-stack-bicep" class="hash-link" aria-label="Direct link to Redeploy - Deployment Stack (Bicep)" title="Direct link to Redeploy - Deployment Stack (Bicep)">​</a></h6>
<p>What if we want to make further changes, such as removing resources from our Deployment Stack?</p>
<p>In this example, we will modify our bicep code to remove the second Virtual network, subnets and associated NSGs (Network Security Groups), and remove the resources from Azure completely <em>(we can unattach them, which will remove them from being managed by the deployment stack)</em>, but I want my Virtual Network resources to be managed completely by Bicep.</p>
<p>We could use the: Save-AzResourceGroupDeploymentStackTemplate, to save the Deployment Stack to an ARM template, if we wanted to deploy it later.</p>
<p><em>Note: In the bicep code example supplied earlier I removed everything after NSG2.</em></p>
<p>We will run the Set-AzResourceGroupDeploymentStack, pointing to the modified bicep code:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$RGName = &#x27;rg-network&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$DenySettings = &#x27;DenyWriteAndDelete&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$BicepFileName = &#x27;main.bicep&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$DeploymentStackName = &#x27;NetworkProd&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Set-AzResourceGroupDeploymentStack -Name $DeploymentStackName -ResourceGroupName $RGName -TemplateFile $BicepFileName -DenySettingsMode $DenySettings -DeleteResources -Verbose -DenySettingsApplyToChildScopes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, we tell Deployment Stacks to Delete Resources that are no longer part of the stack, and this time we will add the Verbose flag, so we can see what it is doing.</p>
<p><img loading="lazy" alt="Azure Deployment Stack - Delete Resource Test" src="/assets/images/DeploymentStacks-PowerShell-RedeployDeploymentStack-411460fee235b420a83aac2092f36ab0.gif" width="1068" height="292" class="img_ev3q"></p>
<p><em>Note: I cut the gif, thats why the timestamps don&#x27;t match, or you could be spending 10 minutes staring at the verbose output.</em></p>
<p>If we navigate to the Azure Portal, we can see the deleted resources listed in the Deployment stack history <em>(only displays the last Deployment stack changes vs keeping a history of everything)</em>, and the Resource un-managed state has changed to: delete.</p>
<p><img loading="lazy" alt="Azure Deployment Stack - Delete Resource Test" src="/assets/images/DeploymentStacks-PowerShell-RedeployDeploymentStackOverview-beaaa4632febe9a02e66ec9b09fefd17.gif" width="1714" height="894" class="img_ev3q"></p>
<p>Note: A manually created Virtual Network in the same Resource Group (but not part of the deployment stack) remained untouched.</p>
<p><em>I forgot to update, the DenySettings variable, so once I re-deployed with the &#x27;DenyWriteAndDelete&#x27; instead of: &#x27;DenyDelete&#x27;. I was unable to disassociate my Network Security Group.</em></p>
<p><img loading="lazy" alt="Azure Deployment Stack - Delete Resource Test" src="/assets/images/DeploymentStacks-Portal-NSG_Modification-86f57308017f532e5445c2f920e9865a.gif" width="1714" height="894" class="img_ev3q"></p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="permissions">Permissions<a href="#permissions" class="hash-link" aria-label="Direct link to Permissions" title="Direct link to Permissions">​</a></h6>
<p>I have &#x27;Owner&#x27; rights over my own demo subscriptions, so a bit more flexibility than I would have in a Production environment.</p>
<p>You can add <a href="https://learn.microsoft.com/azure/azure-resource-manager/bicep/deployment-stacks?tabs=azure-powershell&amp;WT.mc_id=AZ-MVP-5004796#protect-managed-resources-against-deletion" target="_blank" rel="noopener noreferrer">exclusions</a> to your Deployment Stack, allowing certain principals or actions to be completed.</p>
<p>You could also create custom role (Microsoft.Resources/deploymentStacks) to be able to Read, Update or delete deployment stacks, giving you the flexibility to allow people to modify their own stacks and redeploy, without accessing to other tooling required and self-service functionality, such as being able to give someone a deployment stack, that the users can then delete the resources and redeploy later straight from the Azure Portal when required for testing.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="Working with Azure Bicep using Visual Studio Code, is as native as an experience as you can get, made even better by the Bicep Visual Studio Code extension."><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/azure/Azure-Bicep-Deploy-Pane/">Azure Bicep - Deploy Pane</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-08-18T00:00:00.000Z" itemprop="datePublished">August 18, 2023</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Luke Murray</span></a></div><small class="avatar__subtitle" itemprop="description">Author</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Working with <a href="https://learn.microsoft.com/en-us/azure/azure-resource-manager/bicep/overview?tabs=bicep&amp;WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Azure Bicep</a> using Visual Studio Code, is as native as an experience as you can get, made even better by the <a href="https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-bicep" target="_blank" rel="noopener noreferrer">Bicep Visual Studio Code extension</a>.</p>
<p>The Bicep Visual Studio Code extension keeps evolving, with a recent (Experimental) feature being added called the <strong>Deploy Pane</strong>.</p>
<blockquote>
<p>The Deployment Pane is a UI panel in VSCode that allows you to connect to your Azure subscription and execute validate, deploy &amp; whatif operations and get instant feedback without leaving the editor.</p>
</blockquote>
<p><img loading="lazy" alt="Azure Bicep - Deploy Pane" src="/assets/images/VisualStudioCode_DeployPane-b366d4a8a89b7496c00e15ea6b328464.png" width="1491" height="760" class="img_ev3q"></p>
<p>The Deploy Pane, brings together some key actions:</p>
<ul>
<li>Deploy</li>
<li>Validate</li>
<li>What-If</li>
</ul>
<p>The Deploy step, will deploy the Bicep file using the Subscription Scope and ID specified in the pane.
The validate step, will validate that the Bicep syntax is correct for the Azure Resource Manager to process the template.
The What-If step, will let you know what it will deploy and what changes will be made, without having to deploy or touch any resources.</p>
<p>To enable the new Experimental Feature, make sure you are running the latest version of both Bicep, and the Bicep Visual Studio Code extension.</p>
<ol>
<li>Click on <strong>Settings</strong></li>
<li>Expand <strong>Extensions</strong></li>
<li>Navigate to: <strong>Bicep</strong></li>
<li>Check the box labelled: <strong>Experimental: Deploy Pane</strong></li>
</ol>
<p><img loading="lazy" alt="Azure Bicep - Deploy Pane" src="/assets/images/Bicep-DeploymentPreviewPane-9355040071cca56c4bd58e411f280351.gif" width="1908" height="944" class="img_ev3q"></p>
<p>Once enabled, you will see the new Deploy Pane, appear in the top right of your Visual Studio code interface, next to Bicep Visualizer, once you have a Bicep file loaded.</p>
<p><img loading="lazy" alt="Azure Bicep - Deploy Pane" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANUAAAAlCAYAAADV0qyaAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH5wgSBB4rcgE7DAAADBpJREFUeJztnHtYVGUexz9nLoBMsoIZ1Iq6E5Zja2hBIrum1YpmUxu1aje8NLUiFWqBpaWOT2k9iq3Srk4X0lUrxW3bbCIXutDuqmhjSaWYmbdh81bMegGEuZz9YxyYwzkgN0njfJ5nHs+c93Jenffr93femxATEyOioqLSbmh+6gaoqPzcUEWlotLO6H7qBqicm67hMChOww0mDcYrNER1hZgoDT26CQAc/5/IkQofFafgv8dFtpV5KSnzcarqJ254J0VQ36kuTC79Bdx9o47bkrT079O6gGLXAR9F27289ZGHH060cwNVGkUV1QXGAKOGCSO13DpYR6i+fer0eEU2bvOxcqObHXvVn/t8o4rqAiFEJzJ9jJ5Jt+rQaYXz9pzVhR4WrnVTXXPeHtHpUUV1ATAwTmDh5FCMVzQupl0HfGzZ6aFkp5uKU3Ckwscxlw+AyyI1xET537WSrtEz5BpdkyFj+XGRGbYatu1Wf/rzgSqqnxBRFBl1g5alj4UoupPzmI9V/6xlfbGbipM+xfIAgiAvG2EQSB2q56HbQukdIxeYxysy9aVaNm7zKpZXaT2qqBpgGm1hWKzSy0wFX67JZ3Nl+zynKUE5j/mYv/oMhZ95cHvkYmoJgiAwMlHHM+O7yMTl8Yq88KabFR94Wi6sfmYsw3rSpte+E7tZt7YYV1vquABRRSXBQq49FWMjqa4tC0ibv7nNTxFFkZsHaVn+uFRQHq/IXze6WbT2DJXVcjE1t+MHHCyYsBCBaWNCmXxHqEzEs16tZd0nLRBWPwu5z6dibIeBFNd2G5lz7T8rYanzVApUbs1h3LPFQXf8YovWhLS5blEUiYkSWJwhF9SjS6p5f0utrExwZz9XxxdFsS5PsLjO1Iq88MYZPv7cy+qnwwkPq6/nmTQ9m772Un5cbJawho9JwajfxzvmTPIayzN7HVmDjzYjTwp3YW80z8WIuqKiAwl08gUPhxBhqO+8NW5kghIEQfbRaDR1190GpDD23glMmHgf95qH0itSnif4E2BbmZu0+VVUnakXXHiYwJJH/Q6m5HIqLUN1qg4i0FlvS9IwLF4rSXtulbKgAteSP8MTsczJ4KZYqWvePm4C39iXsnj9TqoEoc6xgkUSuN5W5mZ2XjWLHwmvSxvUV8NdQzXkF3slbqfSclSn6kBEUWTczdIXkZJdXlZ+4J80UnIYqfsM5Ykl2YyKC+MHRz4vTk0jLe0xZq/8hCO+KAaMeZq5E66WlFFyLoD8T2opKHFL2nLvLTrVqdoB1akUCIlJJn1yv6A7sUS2ob5AR+3ZQ+A3v5a61DOv+RfoBTtS/cfAL4enMCr+Wq4M/4H9ofEMjdZywG5let7us3lOcPDjFcwocTL7zxlcd/uD3P/2TN48x7o/URSxrqgmJbF+svnaK7VcFavh23JRdas2oIpKQim7ys0Yeydj7t0wzUXpl9+1umZRFDEPkbrU53u8fHPIKxGURuMPHoSrzMx67H4Seoah0WjQaDQMEASEw0W88vo3sg4vVH3Ic+uH8daUeG4YK/DmSqkoAqFgsBMd/tFH8Q4Pv7u+vl1336jj+TdqVUG1AVVUEhzY0lOx9Utn+fNmYj1u3F30nN6aS/qzhbRmiiq4E5t6S6PtvxXXyAQlCAIYbubppx4ksbvI95tWs2LFu2yviMQ4KJG4sE3sbuxhHxzgWMZArrx7A+/dWcmhz97m5SXr+bJSkDlP4Pv6T2olouoVLc+j0jLUdyoZJiyPjCRW78Lxyizs37qJHJxG9ghDq2sMOETvaGkH3XnACyB73xmWOYkbLhU5VDCHRxe/y/YKABf7viikcEu9tE0PWMldmElKXdMKeX/9+xT8+yvKT4TSK2k885fPZYRBObwEOHhUOh8W20Mjc7SLCxPmjCyyMsyYFFINQ8aSlZ3F2CFKv6cJc4YV61Tlss1FdaoGmB6egvlXelxbV7OoqIzKPXbil6SSMD6blM1WCtuwoqJPgxUNB4/KO7kg3MiwayLQ/m8ra15r1JMwPbAI6z0mDEDmsksgYwGFlU4KV9nO5jCQnLmUrBGJWJ408+Hc9wH50qby41Lx9OwhFf7F5laxGZmkj44FhmPq4sSyuDQodSzWGeMx6YHkaEjNJj8oNf6JLNJvigYSiA1xYllUSmtQnSqYfhamjDaidzlY/eLZcO9gHos27MMdmUDa4ym01q+a+p9fKqw4Lu2mperg5zgayR8sKAC6J5O5bFaQYwFUsjnXhqNC4BLTEO5UfFbL26pyblRR1WHC8ogZo96FY9UiiSM5Vyw6GwZaWhQGNuycB45IQ60+MfLOLQinqXVDiKGbYp3RY+f7BeVyYP+iEnBS/N4+3N2TyVyWRbIkt4OjJ4EuXemOfDWGIAjEXibtAgHnuliF5VyWi62gmOICGzmLGzpNPtaFqyj+tJhVC60SlwIoXZyDrcCBo8hGTitdClRR1RE76WzYtyUPa1HDGM9J3hI7+9wGEiZlN3CEpgl+P2koqn69lKLvEr47JhAS91ssshFIOJq/hsKtm7FNs7K7FsCN6+WZWN9zsHldHtKViQlER4BwyoUz6G6wuPrESIf4ncfr23hxCqsM+7IccpbZKVNIrdyST86iHPK3KMXxZdiXWbEuVS7bXFRRAfS2kH2HEb1rM3nzi5XzBMLAiAQsM1oXBu5xeiXf7xzqH3WThmPlrPm7A5feiHnOLMzdG9ZSRt6zC7D/GHyvktKXrSwoCF6WaiB+8ngSu0Pldw4KG9QSeN7tyVJhHzjsRaVtdNqBCtMDVqZcHwWAPiqWWD04t7xDcRNlnPmFlI5IJ+F6C7l/Mvvfudx7sc/LbdYAxrub3GTdE1b3Pam/lt4xGpzHpPkqi+axoE8uC36fTPrr60gtP0qlZJ3tIQqn53A66E78JCuWa6PqvusjoomNNoDLwfIX7Irt6dFNICVR2gXe2+xWzKvSfDqpqCxMuSdBtsUjdvQULMsaX1WdPG0cCREABqL7BkobSZvmoLAZW0IOHvFRsstLUv/6kGvOhFAeWngGkIZlZa9m8uCedGaNv4m4nkaipVEa0SARVWRPE8a+Qf7prcS5dRW2F/MpVRC8KIo8eV+YZKX8zv1evtrnu6hG+y5EOqmo/ARv8fBvQ2g6f4gmBAje8tC8LSGB1QyCILD2o1qS+nepS7vlOh1/GKbj7X/Jwy7XpzayP7XJ7gcYHnRd/Oy4Jl02GFEUuXWw/7nBrP1Yuu1EFVfr6NSiOt8o7WvasMnN/SP0JPar/6efNymUg0dr2L7Hd17nhQLtSLhaS86UUEnazv1e3iiqD/2aaoPr5GkgEuPkdNIbyRMVE9K8PO4aTjX/r3BRoIqqgwi4lccrMjW3ig9f7Fq3UTA8TGDlU6FMfMEvrPPJ9VdpWPlUqGSTYo0bpr5UhccrnnMOC6B0aSa5l9jIvN1MfJM5I4lvKo97H+/MzJYNbV/sdGpRGQZnYbdnNTt/ra8WMJJqt5MadN/lk+/WVSLQWZ3HfMx8pZqlmfX7mcLDBFY/HYZtg5uXN7ipcZ87/GpuyCeKIjqtwMRROh4fGyI7T3Deiir2OH2SNjZss5RKCuenyUYUVfx02jMqlA54cTs/Ja+giRkKQzJjH7iWKMnNpg+ECYRcgfkqn89Xd/2QOZS5E7vIyuz7XsS6spZNX7f9pCNRFBls0vBMWojisWXzVlbzmr1Gcf8WqO9VraHTiqojCYhI6TM6Sc9fpocrHlG264CPNUUe/vEfD7WelnXuEJ1/MGLiKB0DjMrTkUqCamwbvkrzUUXVATTlVgDDB+pYOCWcy7srd/4aN+zY6x+OL93r44gLqs6IHKnwp8dE+cPHmEiIj9OQ1F/LwDhNo8dGV5z08aStmo3b/AMTSmdgBO6rtBxVVB1EY04VSIswCFgnhTNmeDsdoN4IBSVuZr5SXXc4p+pS7Y8qqg6ioVspiQtgyDU6/nhHKMMHtu+Z6sU7POTZz1C8w1N3rykxqaJqPaqoOpCmhBWcDtArWsv4kSGMTtLLVpI3F+cxH4WfeVhTVMPe8vrJZeXzMFRBtReqqDqYlggrQK9oLYP6ahncX0ffnloiwgW6hsPl3f2d//CPIqeq4GSVyP7DXhy7PZTs8nLoqHyVhiqo88//AfU4B6Dp6Uk/AAAAAElFTkSuQmCC" width="213" height="37" class="img_ev3q"></p>
<p>If you have any feedback regarding this extension, make sure to add your feedback to the <a href="https://github.com/Azure/bicep/issues" target="_blank" rel="noopener noreferrer">azure/bicep issues</a></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="Github Codespaces gives you the full capability of your favourite IDE (Integrated Development Environment) like Visual Studio Code, Jupyter, or JetBrains and an extension, to your web browser. With it, you can develop your applications without needing any dependant service or tool installed or configured locally, giving developers a standard way of working on applications and scripts."><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/azure/Getting-Started-with-GitHub-Codespaces/">Coding on the Cloud - Getting Started with GitHub Codespaces</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-08-15T00:00:00.000Z" itemprop="datePublished">August 15, 2023</time> · <!-- -->17 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Luke Murray</span></a></div><small class="avatar__subtitle" itemprop="description">Author</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p><a href="https://github.com/features/codespaces" target="_blank" rel="noopener noreferrer">Github Codespaces</a> gives you the full capability of your favourite IDE (Integrated Development Environment) like Visual Studio Code, Jupyter, or JetBrains and an extension, to your web browser. With it, you can develop your applications without needing any dependant service or tool installed or configured locally, giving developers a standard way of working on applications and scripts.</p>
<p><img loading="lazy" alt="Github Codespaces - Getting Started" src="/assets/images/Header_Getting_Started_with_GitHub_Codespace-091780758856bdf85c365aeca18a401d.gif" width="1200" height="628" class="img_ev3q"></p>
<p>Github Codespaces does this by leveraging the power of the Cloud and GitHub to run containers that you can personalize to run your IDE, extensions, and any dependencies that you may need, whether you are a developer needing Python, apache, react, or a devops engineer requiring Bicep and Terraform support, Codespaces is an ideal enabler for our toolkit, in fact, this article was written in a Github Codespace, using Visual Studio Code and Markdown extensions.</p>
<blockquote>
<p>A codespace is a development environment that&#x27;s hosted in the cloud. You can customize your project for GitHub Codespaces by configuring dev container files to your repository (often known as Configuration-as-Code), creating a repeatable codespace configuration for all project users.
GitHub Codespaces run on various VM-based compute options hosted by GitHub.com, which you can configure from 2-core machines up to 32-core machines. You can connect to your codespaces from the browser or locally using an IDE like Visual Studio Code or IntelliJ.</p>
</blockquote>
<p>Let&#x27;s delve into <a href="https://github.com/features/codespaces" target="_blank" rel="noopener noreferrer">Github Codespaces</a> a bit more!</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h4>
<p>GitHub Codespaces is a cloud-based development environment provided by GitHub, designed to enhance the coding experience and streamline collaboration for developers. It allows you to create, manage, and access your development environments directly from your web browser. With GitHub Codespaces, you can code, build, test, and debug your projects without setting up complex local development environments on your machine.</p>
<p><img loading="lazy" alt="Github Codespaces" src="/assets/images/github_codespaces-a1be408d4805fff58871dea78b9fc88d.png" width="728" height="380" class="img_ev3q"></p>
<p>Key features and benefits of GitHub Codespaces include:</p>
<ul>
<li>Access Anywhere: You can access your coding environment from anywhere with an internet connection. This is particularly useful for remote work, collaboration, and coding on the go.</li>
<li>Consistency: Codespaces ensure consistency across development environments, which can help avoid the &quot;it works on my machine&quot; issue often encountered in software development.</li>
<li>Collaboration: Multiple developers can collaborate on the same Codespace simultaneously, making it easier to pair programs, review code, and troubleshoot together in real-time.</li>
<li>Isolation: Each project or repository can have its own isolated Codespace, preventing conflicts between dependencies and configurations.</li>
<li>Quick Setup: Setting up a development environment is quick and easy. You don&#x27;t need to spend time installing and configuring software locally.</li>
<li>Configurability: Codespaces can be customized with extensions, tools, and settings to match your preferred development environment.</li>
<li>Scalability: GitHub Codespaces can scale according to your needs, making it suitable for individual developers and larger teams.</li>
<li>Version Control Integration: Codespaces is tightly integrated with GitHub repositories, making it seamless to switch between your code and the development environment.</li>
<li>Security: Codespaces offer a secure environment for development, as it doesn&#x27;t store sensitive data and is protected by GitHub&#x27;s security measures.</li>
<li>Project Setup: Codespaces can be configured to automatically set up a project with required dependencies and tools, reducing the time needed to get started.</li>
</ul>
<p>Github Codespaces went into <a href="https://azure.microsoft.com/updates/general-availability-github-codespaces/?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">general availability</a> on August 2021 and is built on top of the <a href="https://containers.dev/" target="_blank" rel="noopener noreferrer">devcontainers</a> schema.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h4>
<p>You need a <a href="https://github.com/" target="_blank" rel="noopener noreferrer">Github</a> account to use GitHub Codespaces.</p>
<p>GitHub Codespaces are available for developers in every organization. However, organizations can choose whether codespaces created from their repositories will be user-owned or organization-owned.. All personal GitHub.com accounts include a monthly quota of free usage each month.</p>
<p>GitHub will provide <strong>users in the Free plan 120 core hours, or 60 hours of run time on a two core codespace, plus 15 GB of storage each month</strong>.</p>
<p>For further pricing information, make sure you review:</p>
<ul>
<li><a href="https://docs.github.com/en/billing/managing-billing-for-github-codespaces/about-billing-for-github-codespaces" target="_blank" rel="noopener noreferrer">About billing for GitHub Codespaces</a></li>
<li><a href="https://github.com/pricing/calculator" target="_blank" rel="noopener noreferrer">Pricing calculator</a></li>
</ul>
<blockquote>
<p>Pricing, features and offerings could change at any time. For the most up-to-date information, make sure you review the documentation on github.com.</p>
</blockquote>
<p>To use GitHub Codespaces, you need an active repository; by default, Github Codespaces is configured for the repository you set.</p>
<p>You will also need a <a href="https://docs.github.com/en/get-started/using-github/supported-browsers" target="_blank" rel="noopener noreferrer">supported browser</a> (the latest versions of Chrome, Edge, Firefox, or Safari are recommended) to view your IDE; in this article, we will be using Visual Studio Code.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="setting-up-github-codespaces">Setting Up GitHub Codespaces<a href="#setting-up-github-codespaces" class="hash-link" aria-label="Direct link to Setting Up GitHub Codespaces" title="Direct link to Setting Up GitHub Codespaces">​</a></h4>
<p>Github Codespaces can be accessed directly from the GitHub interface.</p>
<ol>
<li><strong>Navigate</strong> to a new <strong>repository</strong></li>
<li>Click <strong>Code</strong></li>
<li>Click <strong>+</strong> in the Codespaces tab to open a new <strong>Codespace</strong> on your repo, by default a Visual Studio Code instance will open in your browser; note the &#x27;funky&#x27; name and URL that create to give you a unique container.</li>
</ol>
<p><em>Note: Don&#x27;t worry; nothing is saved to your repository unless you want to commit any changes.</em></p>
<p>Your Codespace is now started and running in a default GitHub-supplied development container.</p>
<blockquote>
<p>A development container is a running Docker container with a well-defined tool/runtime stack and its prerequisites.</p>
</blockquote>
<p><img loading="lazy" alt="Github Codespaces - Run" src="/assets/images/OpenCodespace-7ded5b93f6b3d8f25a98c42f2503235b.gif" width="2239" height="1201" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="exploring-the-interface">Exploring the Interface<a href="#exploring-the-interface" class="hash-link" aria-label="Direct link to Exploring the Interface" title="Direct link to Exploring the Interface">​</a></h4>
<p>Once you have your Codespace running, you have access to most native <a href="https://code.visualstudio.com/" target="_blank" rel="noopener noreferrer">Visual Studio Code</a> capability&#x27;s and all the files in your repository.</p>
<p><img loading="lazy" alt="Github Codespaces - Overview" src="/assets/images/Codespaces_VSCode_Overview-27a520ddf59bae72c1ff31de985af961.png" width="1920" height="845" class="img_ev3q"></p>
<p>We now have our workspace, consisting of Visual Studio code, running in your own docker container! The Host field <em>(lower left)</em> indicates that you are running in a Codespace.</p>
<p>Out of the box, Visual Studio Code has git integration, so you can easily commit any changes to the repository as you would if you were working from your local development workstation - this is critical to remember when making a change to your devcontainer configuration - you have to commit it before you can rebuild or you will lose your configuration (we will get to this further in the article).</p>
<p>As its runs in a hosted container, you can switch easily between computers and browsers by opening the Codespace (the same way you created your Codespace, but instead selecting an already running instance) or copying the URL of your Codespace and log back into Github on another computer to go directly to the container instance:</p>
<p><img loading="lazy" alt="Github Codespaces - Run" src="/assets/images/Github_Codespaces_OpenRunning-44c5d51040f54cc74e8432a631715740.png" width="1033" height="466" class="img_ev3q"></p>
<p>If you leave your Codespace running without interaction, or if you exit your codespace without explicitly stopping it, the codespace will timeout after a period of inactivity and stop running. You can <a href="https://docs.github.com/en/codespaces/customizing-your-codespace/setting-your-timeout-period-for-github-codespaces" target="_blank" rel="noopener noreferrer">adjust the timeout</a> of your codespace to a maximum of 240 minutes (4 hours) for new Codespaces, but keep in mind you will be charged unless the Codespace is stopped. If the Codespace remains inactive for some time, it could be deleted. You should get an email notification before this happens, but I suggest keeping an eye on your Codespace and ensuring it&#x27;s only running when needed.</p>
<blockquote>
<p>Warning: Codespaces compute usage is billed for the duration a codespace is active. If you&#x27;re not using a codespace that remains running and hasn&#x27;t yet timed out, you are billed for the total time that the codespace was active, irrespective of whether you were using it. For more information, see &quot;<a href="https://docs.github.com/en/billing/managing-billing-for-github-codespaces/about-billing-for-github-codespaces#codespaces-pricing" target="_blank" rel="noopener noreferrer">About billing for GitHub Codespaces</a>.&quot;</p>
</blockquote>
<p>As with any Visual Studio Code instance, you can also log in to your GitHub account to pull your settings and extensions, but to keep things clean and distraction-free, you can customize your Codespace instead for only what you or others working in the same repository need.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="customizing-your-codespace">Customizing Your Codespace<a href="#customizing-your-codespace" class="hash-link" aria-label="Direct link to Customizing Your Codespace" title="Direct link to Customizing Your Codespace">​</a></h4>
<p>You can customize your Codespace to suit the project you are working on; some examples I use personally are:</p>
<ul>
<li>Markdown editing <em>(for example, my website is hosted on Github Pages, and the formatting is done using Markdown, so I have a devcontainer preconfigured to run Markdown Visual Studio Code extensions and linting, so as soon as I open it - its good to go!)</em></li>
<li>Infrastructure as Code development <em>(I have preconfigured devcontainer, running on a container, that has the latest version of PowerShell, Terraform, Bicep installed and relevant Visual Studio extensions)</em></li>
</ul>
<p>I used to install everything locally, to the point when I would be reinstalling Windows every few months. To keep my device clean, I moved to an Azure Virtual Desktop host as my development environment, but Codespaces now give me the flexibility to install what I need (when I need it) within a Linux environment, and I know when I rebuild the Codespace, I will have the latest libraries.</p>
<p>There are a lot of customisation you can do, we won&#x27;t be able to cover all possible customisations in this article, but I aim to cover the basics to get you up and running!</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="setting-sync">Setting Sync<a href="#setting-sync" class="hash-link" aria-label="Direct link to Setting Sync" title="Direct link to Setting Sync">​</a></h5>
<p>Before delving into some of the customisation of the devcontainer configuration itself, let us remember the Visual Studio Code settings sync.</p>
<p>If you are someone who works on the same products and services and has invested time in configuring Visual Studio profiles, there&#x27;s nothing indicating that you can&#x27;t use this in a Github Codespace, especially if it is a trusted repository.</p>
<p>You will already be logged into Visual Studio Code with your GitHub account; you can turn on Setting Sync to have your Visual Studio code settings and profiles sync straight into your devcontainer.</p>
<p><img loading="lazy" alt="Github Codespaces - Setting Sync" src="/assets/images/VisualStudioCode_Codespace_TurnonSettingSync-7dc0899258fb4295e7903df8c63a50d4.gif" width="654" height="277" class="img_ev3q"></p>
<p>One of the downsides of this method is the container can get bloated with extensions and configurations you don&#x27;t need, and you will have to turn on Setting Sync each time a Codespace is launched.</p>
<p><a href="https://docs.github.com/en/codespaces/customizing-your-codespace/personalizing-github-codespaces-for-your-account#turning-on-settings-sync-in-a-codespace" target="_blank" rel="noopener noreferrer">Setting Sync</a> is an easy way to import your configuration from your Desktop into the Cloudspace.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="codespace-templates">Codespace templates<a href="#codespace-templates" class="hash-link" aria-label="Direct link to Codespace templates" title="Direct link to Codespace templates">​</a></h5>
<p>Instead of spending time, developing your template, you may find a devcontainer template already exists for your use case; some examples consist of:</p>
<ul>
<li>Ruby on Rails</li>
<li>React</li>
<li>Juypter Notebooks and more.</li>
</ul>
<p>These <a href="https://github.com/codespaces/templates" target="_blank" rel="noopener noreferrer">Codespace Templates</a> can easily be launched from the web browser and are a great resource to test the power of Codespace and refer to when customising your own devcontainer.</p>
<p>See <a href="https://github.com/devcontainers/template-starter" target="_blank" rel="noopener noreferrer">devcontainers/template-starter</a> and <a href="https://github.com/devcontainers/feature-starter" target="_blank" rel="noopener noreferrer">devcontainers/feature-starter</a> for information on creating your own!</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="devcontainers">Devcontainers<a href="#devcontainers" class="hash-link" aria-label="Direct link to Devcontainers" title="Direct link to Devcontainers">​</a></h5>
<p>Within each customised Codespace is a &quot;<a href="https://containers.dev/implementors/json_reference/" target="_blank" rel="noopener noreferrer">devcontainer.json</a>&quot; json file, and some containers will have a <a href="https://code.visualstudio.com/docs/devcontainers/create-dev-container#_dockerfile" target="_blank" rel="noopener noreferrer">dockerfile</a>.</p>
<p>These files will sit inside a /.devcontainer/ folder at the root of your git repository. It is worth noting that you can have multiple devcontainer files within a single repository; you will be prompted which one to be used when you start the Codespace up.</p>
<p>These files are crucial to customising your devcontainer.</p>
<p>Although they serve different purposes they can work standalone or together to create a consistent and reproducible development environment for your project.</p>

















<table><thead><tr><th>File</th><th>Purpose</th></tr></thead><tbody><tr><td>devcontainer.json</td><td>The devcontainer.json file configures how your development environment is set up within the Docker container when using the Remote - Containers extension.</td></tr><tr><td>dockerfile</td><td>The dockerfile defines the environment you need for your project. When you create a Codespace, GitHub will use the specified Dockerfile to build a container image that includes all the tools, libraries, and configurations required to work on your project.</td></tr></tbody></table>
<p>When you open your project in a GitHub Codespace that uses a devcontainer.json file, Visual Studio Code will automatically detect the configuration and set up your development environment according to the specified settings.</p>
<p>You can use a dockerfile to define the environment you need for your project. When you create a Codespace, GitHub will use the specified Dockerfile to build a container image that includes all the tools, libraries, and configurations required to work on your project.</p>
<p>Even without using a dockerfile, you can install any dependant libraries onto your codespace, but they are lost when the container gets rebuilt; there are certain approved features you can add to your devcontainer file that will be installed when a container is launched, which is great when making sure you are working on with the latest component.</p>
<p>The idea with both these files is to <em>keep them lean</em> and make sure that you are running the components you only need. To keep launch time and performance as quick as possible, it is possible to &#x27;<a href="https://docs.github.com/en/codespaces/prebuilding-your-codespaces/about-github-codespaces-prebuilds" target="_blank" rel="noopener noreferrer">prebuild</a>&#x27; your image if it is largely complex, but we won&#x27;t be covering that here.</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="devcontainerjson">devcontainer.json<a href="#devcontainerjson" class="hash-link" aria-label="Direct link to devcontainer.json" title="Direct link to devcontainer.json">​</a></h6>
<p>Let us take a look at the &#x27;devcontainer.json&#x27; file. As Codespaces uses the <a href="https://containers.dev/implementors/spec/" target="_blank" rel="noopener noreferrer">devcontainer</a> schema, all the customisations offered such as:</p>
<ul>
<li>entrypoint</li>
<li>onCreateCommand</li>
<li>customizations</li>
<li>features</li>
</ul>
<p>Can be used, offering a vast range of customisation opportunities to suit your needs.</p>
<p>For most purposes, you may be able to find you can get away with a devcontainer.json file without having to delve into building your own dockerfile.</p>
<p>Let us look into the devcontainer.json file I am using for this blog article:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">// For format details, see https://aka.ms/devcontainer.json. For config options, see the</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// README at: https://github.com/devcontainers/templates/tree/main/src/markdown</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;name&quot;: &quot;Markdown Editing&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // Or use a Dockerfile or Docker Compose file. More info: https://containers.dev/guide/dockerfile</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;image&quot;: &quot;mcr.microsoft.com/devcontainers/base:bullseye&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // Features to add to the dev container. More info: https://containers.dev/features.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // &quot;features&quot;: {},</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // Configure tool-specific properties.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;customizations&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // Configure properties specific to VS Code.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;vscode&quot;: {            </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // Add the IDs of extensions you want to be installed when the container is created.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &quot;extensions&quot;: [</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &quot;yzhang.markdown-all-in-one&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &quot;streetsidesoftware.code-spell-checker&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &quot;DavidAnson.vscode-markdownlint&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &quot;shd101wyy.markdown-preview-enhanced&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &quot;bierner.github-markdown-preview&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // Use &#x27;forwardPorts&#x27; to make a list of ports inside the container available locally.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // &quot;forwardPorts&quot;: [],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // Use &#x27;postCreateCommand&#x27; to run commands after the container is created.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // &quot;postCreateCommand&quot;: &quot;uname -a&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // Uncomment to connect as root instead. More info: https://aka.ms/dev-containers-non-root.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // &quot;remoteUser&quot;: &quot;root&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This was from an already existing template, that had everything I needed from: <a href="https://github.com/devcontainers/templates/tree/main/src" target="_blank" rel="noopener noreferrer">devcontainers/templates</a>.</p>
<p>A few things stand out:</p>
<ul>
<li>image</li>
<li>customizations</li>
<li>features</li>
</ul>
<ol>
<li>The image is the docker image, that this Codespace is running.</li>
<li>Customizations are application-specific customisations, in my example vscode, and the extensions that are automatically provisioned for me when I started this codespace.</li>
<li>Features, which are currently blank, but will allow us to run scripts to install any relevant dependencies when the container is started.</li>
</ol>
<p>This json file is a great reference point, as we go into creating our own. You can create your own devcontainer.json file - or we can do it within the devcontainer itself using the Codespaces extension, preinstalled into your new Codespace.</p>
<p>In our newly created Codespace from the Setting up Codespace step earlier, it&#x27;s time to create our own devcontainer. The project we will be working on will be Terraform development, so we want to customise our own codespace for Infrastructure as Code development.</p>
<ol>
<li>Press <strong>Ctrl+Shift+P</strong> (or click View, Command Palette)</li>
<li>Type in: <strong>Codespaces</strong> <em>(with the codespaces commands you can rebuild your container, resize and modify your codespace)</em></li>
<li>Select <strong>Add Dev Container Configuration Files</strong></li>
<li>Select <strong>Create a new Configuration</strong></li>
<li>Type in <strong>Ubuntu</strong></li>
<li>Select the latest version (or default)</li>
<li>In the <strong><a href="https://github.com/devcontainers/features" target="_blank" rel="noopener noreferrer">features</a></strong> list we have the option to install third-party tools and dependencies that will be installed when we launch our Codespace, search for <strong>Terraform</strong></li>
<li>Select <strong>Terraform, tflint, and TFGrunt</strong></li>
<li>Click <strong>Ok</strong></li>
<li>Select <strong>Configure Options</strong></li>
<li>Check the <strong>installTFsec</strong> and <strong>instalLTerraformDocs</strong></li>
<li>Click <strong>Ok</strong></li>
<li>Select the <strong>latest</strong> Terraform version</li>
<li>Select the latest <strong>Tflint</strong> version</li>
</ol>
<p>This will now create a devcontainer json file, using a base Ubuntu image, with the latest version of Terraform, tflint and Terragrunt installed!</p>
<p><img loading="lazy" alt="Github Codespaces - Create" src="/assets/images/VisualStudioCode_Codespace_CreateTerraform-eda65f694f8e7a7a4643e0c1e06845ff.gif" width="1908" height="840" class="img_ev3q"></p>
<p><strong>Make sure you save and commit the devcontainer.json file to the repository! You have now created your first custom codespace</strong>.</p>
<p>You can now rebuild your container, to run inside your Terraform container:</p>
<ol>
<li>Press <strong>Ctrl+Shift+P</strong> (or click View, Command Palette)</li>
<li>Type in <strong>Codespaces</strong></li>
<li>Select <strong>Full Rebuild Container</strong></li>
<li>Accept the prompt. that it will be rebuild with the devcontainer configuration.</li>
<li>GitHub Codespaces will then grab the Ubuntu image, and the Terraform feature and run.</li>
</ol>
<blockquote>
<p>Note: If the build fails, at the time of writing, there looked to be an issue with the latest version of <a href="https://terragrunt.gruntwork.io/docs/getting-started/supported-terraform-versions/" target="_blank" rel="noopener noreferrer">terragrunt</a>, I pined it to this specific version: 0.48.0, and it fixed it. So edit the JSON file and update latest to the version. Feel free to review my example codespace here: <a href="https://github.com/lukemurraynz/codespaces/tree/main" target="_blank" rel="noopener noreferrer">lukemurraynz/codespaces</a>.</p>
</blockquote>
<ol>
<li>Once loaded, I can immediately run &#x27;terraform init&#x27;</li>
</ol>
<p><img loading="lazy" alt="Github Codespaces - Terraform init" src="/assets/images/VisualStudioCode_Codespace_Terraforminit-eddd7311faf520ee0d4ce0ff442201ef.gif" width="1908" height="840" class="img_ev3q"></p>
<p>Now that we have Terraform installed, the Azure Terraform and HashiCorp extension - we may want the <a href="https://marketplace.visualstudio.com/items?itemName=eamodio.gitlens" target="_blank" rel="noopener noreferrer">GitLens</a> extension, to help with working with other developers, so let us add this!</p>
<ol>
<li>Navigate to the <strong>Extensions</strong></li>
<li>Search for <strong>GitLens</strong></li>
<li><strong>Right</strong> click the <strong>extension</strong> button and select &#x27;<strong>Add to devcontainer.json</strong>&#x27;</li>
<li>Then commit your save, you have now added the GitLens extension into your devcontainer, this will automatically be installed on your next rebuild.</li>
</ol>
<p><img loading="lazy" alt="Github Codespaces - Install Extension" src="/assets/images/VisualStudioCode_Codespace_AddGitLens-cf7f0f3b8dcaf74572b8a7764f01810b.gif" width="1908" height="840" class="img_ev3q"></p>
<p>Now we have created our own Github Codespaces using devcontainers, using features and adding in extensions, last thing to add is a few settings to Visual Studio Code, such as Format on Save Mode.</p>
<ol>
<li>
<p>Click on the <strong>Settings</strong> gear</p>
</li>
<li>
<p>Click <strong>Settings</strong></p>
</li>
<li>
<p>Search for: <strong>Format</strong></p>
</li>
<li>
<p>Click on the <strong>gear</strong> next to: <strong>Editor: Format On Save</strong></p>
</li>
<li>
<p>Click <strong>Copy</strong> <strong>Setting</strong> <strong>ID</strong></p>
</li>
<li>
<p><strong>Navigate</strong> to your <strong>devcontainer</strong>.json <strong>file</strong></p>
</li>
<li>
<p><strong>Under</strong> vscode <strong>customization</strong>, <strong>add</strong> a new <strong>item</strong> called <strong>Settings</strong> and add:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> &quot;settings&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         &quot;editor.formatOnSave&quot;: true </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     },</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Intellisense should help you, add it in and any other settings you may want configured. you may want to consider configuring a default formatter or linter for your project.</p>
</li>
</ol>
<p><img loading="lazy" alt="Github Codespaces - Set Setting" src="/assets/images/VisualStudioCode_Codespace_AddVSCodeSetting-e49f7d9011398781ed177fe9b5f50b09.gif" width="1908" height="840" class="img_ev3q"></p>
<p>As usual, make sure you <strong>Commit the change to the repository</strong>, before you rebuild to confirm the settings have worked.</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="dockerfile">dockerfile<a href="#dockerfile" class="hash-link" aria-label="Direct link to dockerfile" title="Direct link to dockerfile">​</a></h6>
<p>For those more complex scenarios, where there may not be a feature or shellscript that you can run as part of the launch, you may want to consider your own dockerfile.</p>
<p>In this example, I am going to use the same scenario, but use a non-devcontainer image for Apache.</p>
<p>You can create a dockerfile in the same repository.</p>
<p>To make this work, you need an adjustment to your devcontainer.json file.</p>
<ol>
<li>
<p><strong>Create</strong> a new <strong>file</strong> called: <strong>dockerfile</strong> - in the same location as the &#x27;devcontainer.json&#x27; file</p>
</li>
<li>
<p>In the dockerfile <strong>add</strong> the following line:</p>
</li>
<li>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> FROM httpd:latest</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>Save</strong></p>
</li>
<li>
<p>In the devcontainer.json file <strong>replace</strong> the image section with:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> &quot;build&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> // Path is relataive to the devcontainer.json file.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> &quot;dockerfile&quot;: &quot;Dockerfile&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> },</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Now <strong>start</strong> your <strong>Codespace</strong></p>
</li>
<li>
<p>Github will now grab the image directly from dockerhub and overly your devcontainers configuration on top of it.</p>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="port-forwarding">Port Forwarding<a href="#port-forwarding" class="hash-link" aria-label="Direct link to Port Forwarding" title="Direct link to Port Forwarding">​</a></h4>
<p>Github Codespaces can do port forwarding, which is either Private (ie visible only to your GitHub user), or Public (open to the internet). This is useful for local development and testing.</p>
<p>Let us take our Apache, httpd image supplied earlier.</p>
<p>In the same directory, we will <strong>create an index.html</strong> page:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;html lang=&quot;en&quot;&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;head&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &lt;title&gt;GitHub Codespace Port Forwarding Test&lt;/title&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;/head&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;body&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &lt;h1&gt;Hello, GitHub Codespaces!&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &lt;p&gt;This is a test webpage for port forwarding.&lt;/p&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;/body&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;/html&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And <strong>adjust the dockerfile</strong> like so:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">FROM httpd:latest</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">COPY index.html /usr/local/apache2/htdocs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">EXPOSE 80</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This will take our index.html page and feed it to the apache htdocs folder.</p>
<p>Then we go to our <strong>devcontainer.json</strong> file and add these:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;forwardPorts&quot;: [&quot;80&quot;],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;postStartCommand&quot;: &quot;httpd&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now <strong>save the changes</strong> and <strong>launch</strong> your Codespace.</p>
<p>Feel free to review my example codespace here: <a href="https://github.com/lukemurraynz/codespaces/tree/main" target="_blank" rel="noopener noreferrer">lukemurraynz/codespaces</a>.</p>
<p><img loading="lazy" alt="Github Codespaces - Port Forwarding" src="/assets/images/VisualStudioCode_Codespace_PortFowarding-44396600763815d43925c5614251c41b.gif" width="1908" height="840" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="working-from-your-own-device">Working from your own device<a href="#working-from-your-own-device" class="hash-link" aria-label="Direct link to Working from your own device" title="Direct link to Working from your own device">​</a></h4>
<p>This is all great, but sometimes it feels more natural to work from a locally installed Visual Studio Code instance.</p>
<p>Using the: <a href="https://marketplace.visualstudio.com/items?itemName=GitHub.codespaces" target="_blank" rel="noopener noreferrer">GitHub Codespaces</a> Visual Studio Code extension, you can connect to a Codespace (or start one), directly from your own Visual Studio Code installation.</p>
<ol>
<li>Install <strong><a href="https://marketplace.visualstudio.com/items?itemName=GitHub.codespaces" target="_blank" rel="noopener noreferrer">GitHub Codespaces</a></strong> extension</li>
<li>Press <strong>Ctrl+Shift+P</strong> (or click View, Command Palette)</li>
<li>Type in <strong>Codespaces</strong></li>
<li>Click <strong>Connect to a Codespace</strong></li>
<li>Select your codespace</li>
</ol>
<p><img loading="lazy" alt="Github Codespaces - Connect to Codespace" src="/assets/images/VisualStudioCode_Codespace_CodespaceLocally-c80bf1a89e74f685400cb01ed18e51de.gif" width="1908" height="944" class="img_ev3q"></p>
<p>As you can see you can now connect to one or multiple GitHub Codespaces, from your own locally installed Visual Studio instance!</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="additional-settings">Additional Settings<a href="#additional-settings" class="hash-link" aria-label="Direct link to Additional Settings" title="Direct link to Additional Settings">​</a></h4>
<p>Additional settings, that can be configured are:</p>
<ul>
<li>Setup <a href="https://docs.github.com/en/codespaces/prebuilding-your-codespaces/configuring-prebuilds" target="_blank" rel="noopener noreferrer">Prebuild</a></li>
<li>Codespace <a href="https://docs.github.com/en/codespaces/managing-your-codespaces/managing-encrypted-secrets-for-your-codespaces" target="_blank" rel="noopener noreferrer">Secrets</a> (Repo &amp; Org Level)</li>
<li><a href="https://docs.github.com/en/codespaces/customizing-your-codespace/personalizing-github-codespaces-for-your-account#dotfiles" target="_blank" rel="noopener noreferrer">Dotfiles</a> (Org Level)
Organisation</li>
<li><a href="https://docs.github.com/en/codespaces/customizing-your-codespace/configuring-automatic-deletion-of-your-codespaces" target="_blank" rel="noopener noreferrer">Configuring automatic deletion of your codespaces</a></li>
</ul>
<p>Hopefully this article has given you a taste of what GitHub Codespaces can do.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="You can move a Public IP address in Microsoft Azure, to a new Subscription (BUT NOT A DIFFERENT REGION)."><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/azure/Move-Azure-Public-IP-to-another-subscription/">Move an Azure public IP to another subscription</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-08-11T00:00:00.000Z" itemprop="datePublished">August 11, 2023</time> · <!-- -->One min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Luke Murray</span></a></div><small class="avatar__subtitle" itemprop="description">Author</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>You can move a <a href="https://learn.microsoft.com/azure/virtual-network/ip-services/public-ip-addresses?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Public IP</a> address in Microsoft Azure, to a new Subscription (BUT NOT A <a href="https://learn.microsoft.com/azure/virtual-network/move-across-regions-publicip-portal?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">DIFFERENT REGION</a>).</p>
<p>There are some limitations as below:</p>
<blockquote>
<p>You can&#x27;t move a VPN Gateway that is associated with a Standard SKU public IP address to a new subscription.
Azure Public IPs are region specific and can&#x27;t be moved from one region to another.</p>
</blockquote>
<p>Some resources aren&#x27;t <a href="https://learn.microsoft.com/azure/azure-resource-manager/management/move-support-resources?WT.mc_id=AZ-MVP-5004796#microsoftnetwork" target="_blank" rel="noopener noreferrer">supported</a> to be moved, but a Public IP is.</p>
<p>Before you move the Public IP, make sure its dissociated (unattached) from a resource.</p>
<p><img loading="lazy" alt="Dissociate IP" src="/assets/images/PublicIP_dissociate-8c977cae9c35e1e31c2cabe19f22cbd6.png" width="1174" height="202" class="img_ev3q"></p>
<p>Then once dissociated, you can trigger the move.</p>
<p><img loading="lazy" alt="Dissociate IP" src="/assets/images/PublicIP_MoveAnotherSub-4bc302c7d8a3f9c42a43417d402efb26.png" width="834" height="237" class="img_ev3q"></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/tags/azure/page/3/"><div class="pagination-nav__label">Newer Entries</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/tags/azure/page/5/"><div class="pagination-nav__label">Older Entries</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 luke.geek.nz. Powered by coffee, clouds and hamsters on wheels!</div></div></div></footer></div>
</body>
</html>