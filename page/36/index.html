<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Luke&#x27;s Tech Blog - Unleashing the power of the cloud and other technologies! | luke.geek.nz</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://luke.geek.nz/img/social-card.png"><meta data-rh="true" name="twitter:image" content="https://luke.geek.nz/img/social-card.png"><meta data-rh="true" property="og:url" content="https://luke.geek.nz/page/36/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="Luke&#x27;s Tech Blog - Unleashing the power of the cloud and other technologies! | luke.geek.nz"><meta data-rh="true" name="description" content="Follow Luke, Microsoft Azure MVP, on a journey through the latest Microsoft and Azure Cloud innovations. Learn, explore, and stay ahead in the fast-moving world of cloud computing."><meta data-rh="true" property="og:description" content="Follow Luke, Microsoft Azure MVP, on a journey through the latest Microsoft and Azure Cloud innovations. Learn, explore, and stay ahead in the fast-moving world of cloud computing."><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://luke.geek.nz/page/36/"><link data-rh="true" rel="alternate" href="https://luke.geek.nz/page/36/" hreflang="en"><link data-rh="true" rel="alternate" href="https://luke.geek.nz/page/36/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://ZBH2T1WJQD-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"Blog","@id":"https://luke.geek.nz/page/36","mainEntityOfPage":"https://luke.geek.nz/page/36","headline":"Luke's Tech Blog - Unleashing the power of the cloud and other technologies!","description":"Follow Luke, Microsoft Azure MVP, on a journey through the latest Microsoft and Azure Cloud innovations. Learn, explore, and stay ahead in the fast-moving world of cloud computing.","blogPost":[{"@type":"BlogPosting","@id":"https://luke.geek.nz/2021/07/06/create-custom-roles-for-microsoft-azure","mainEntityOfPage":"https://luke.geek.nz/2021/07/06/create-custom-roles-for-microsoft-azure","url":"https://luke.geek.nz/2021/07/06/create-custom-roles-for-microsoft-azure","headline":"Create Custom Roles for Microsoft Azure","name":"Create Custom Roles for Microsoft Azure","description":"Microsoft Azure uses Role's to define who can access what - Role-Based Access Control RBAC .","datePublished":"2021-07-06T00:00:00.000Z","author":{"@type":"Person","name":"Luke Murray","description":"Author","url":"https://luke.geek.nz","image":"https://luke.geek.nz/img/logo.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://luke.geek.nz/2021/07/05/add-shortcut-to-azure-virtual-desktop-in-the-microsoft-365-waffle","mainEntityOfPage":"https://luke.geek.nz/2021/07/05/add-shortcut-to-azure-virtual-desktop-in-the-microsoft-365-waffle","url":"https://luke.geek.nz/2021/07/05/add-shortcut-to-azure-virtual-desktop-in-the-microsoft-365-waffle","headline":"Add a shortcut to the Azure Virtual Desktop Web Client to the Microsoft 365 waffle","name":"Add a shortcut to the Azure Virtual Desktop Web Client to the Microsoft 365 waffle","description":"If you are like me, you use the application launchers in the Microsoft 365 waffle daily, if not hourly! Then having it as a single pane of glass to acce...","datePublished":"2021-07-05T00:00:00.000Z","author":{"@type":"Person","name":"Luke Murray","description":"Author","url":"https://luke.geek.nz","image":"https://luke.geek.nz/img/logo.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://luke.geek.nz/2021/07/03/start-vm-on-connect-for-azure-virtual-desktop","mainEntityOfPage":"https://luke.geek.nz/2021/07/03/start-vm-on-connect-for-azure-virtual-desktop","url":"https://luke.geek.nz/2021/07/03/start-vm-on-connect-for-azure-virtual-desktop","headline":"Start VM on Connect for Azure Virtual Desktop","name":"Start VM on Connect for Azure Virtual Desktop","description":"One of the models of Cloud governance and cost in Microsoft Azure is 'Pay As You Go', ie. Pay for what you need when you need it.","datePublished":"2021-07-02T12:00:00.000Z","author":{"@type":"Person","name":"Luke Murray","description":"Author","url":"https://luke.geek.nz","image":"https://luke.geek.nz/img/logo.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://luke.geek.nz/azure/Azure-Virtual-Desktop-Optimisations","mainEntityOfPage":"https://luke.geek.nz/azure/Azure-Virtual-Desktop-Optimisations","url":"https://luke.geek.nz/azure/Azure-Virtual-Desktop-Optimisations","headline":"Azure Virtual Desktop Optimisations","name":"Azure Virtual Desktop Optimisations","description":"If you are running Azure Virtual Desktop, you want to get the most performance and stability out of them as possible, to reduce cost and increase user e...","datePublished":"2021-07-01T00:00:00.000Z","author":{"@type":"Person","name":"Luke Murray","description":"Author","url":"https://luke.geek.nz","image":"https://luke.geek.nz/img/logo.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://luke.geek.nz/azure/how-to-setup-fslogix-profiles-for-azure-virtual-desktop","mainEntityOfPage":"https://luke.geek.nz/azure/how-to-setup-fslogix-profiles-for-azure-virtual-desktop","url":"https://luke.geek.nz/azure/how-to-setup-fslogix-profiles-for-azure-virtual-desktop","headline":"How to setup FSLogix profiles for Azure Virtual Desktop","name":"How to setup FSLogix profiles for Azure Virtual Desktop","description":"If you have a few Azure Virtual Desktop machines, you need some way to keep user persistence's and application customisations, which would usually be st...","datePublished":"2021-06-29T00:00:00.000Z","author":{"@type":"Person","name":"Luke Murray","description":"Author","url":"https://luke.geek.nz","image":"https://luke.geek.nz/img/logo.png"},"keywords":[]}]}</script><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="luke.geek.nz RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="luke.geek.nz Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="luke.geek.nz JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0QDLBY7NNN"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0QDLBY7NNN",{anonymize_ip:!0})</script>






<meta property="og:type" content="website">
<meta property="og:site_name" content="luke.geek.nz">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@lukemurraynz">
<meta name="twitter:creator" content="@lukemurraynz">
<meta name="author" content="Luke Murray">
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
<script type="application/ld+json">{"@context":"https://schema.org","@type":"WebSite","name":"luke.geek.nz","description":"Microsoft MVP - Microsoft Azure ☁, Technical Consultant, Azure Solutions Architect Expert, Technologist and a drinker of coffee.","url":"https://luke.geek.nz","author":{"@type":"Person","name":"Luke Murray","url":"https://luke.geek.nz/about","sameAs":["https://twitter.com/lukemurraynz","https://www.linkedin.com/in/ljmurray/","https://aus.social/@lukemurray","https://bsky.app/profile/lukemurraynz.bsky.social"]},"publisher":{"@type":"Person","name":"Luke Murray"},"potentialAction":{"@type":"SearchAction","target":"https://luke.geek.nz/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script><link rel="stylesheet" href="/assets/css/styles.dd27eb3d.css">
<script src="/assets/js/runtime~main.b98dcf2c.js" defer="defer"></script>
<script src="/assets/js/main.a8e72d02.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="dark";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="theme-announcement-bar announcementBar_mb4j" style="background-color:#D3D3D3" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">If you haven't already, sign up for my Weekly Azure updates Newsletter, straight to your inbox! <a target="_blank" rel="noopener noreferrer" href="https://newsletter.azurefeeds.com/join">Subscribe now!</a></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="luke.geek.nz" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="luke.geek.nz" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">luke.geek.nz</b></a><a class="navbar__item navbar__link" href="/tags/">Tags</a><a class="navbar__item navbar__link" href="/archive/">Blog</a><a class="navbar__item navbar__link" href="/about/">About</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://www.youtube.com/channel/UCUG3TKDTAZz4UXshGrjBBoQ" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="YouTube">
              <svg width="24" height="24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M23.498,6.186c-0.273-1.186-1.143-2.144-2.332-2.417C18.389,3.153,12,3.153,12,3.153s-6.389,0-9.166,0.616
                  c-1.19,0.273-2.06,1.23-2.332,2.417C0,8.07,0,12,0,12s0,3.93,0.502,5.814c0.272,1.187,1.142,2.062,2.332,2.335
                  C5.611,20.847,12,20.847,12,20.847s6.389,0,9.166-0.698c1.189-0.273,2.059-1.148,2.332-2.335C24,15.93,24,12,24,12
                  S24,8.07,23.498,6.186z M9.545,15.568V8.432l6.545,3.568L9.545,15.568z"/>
              </svg>
            </a><a href="https://aus.social/@lukemurray" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="Mastodon">
              <svg height="20" width="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" xml:space="preserve">
                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                <g id="SVGRepo_iconCarrier">
                  <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.510 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"></path>
                </g>
              </svg>
            </a><a href="https://bsky.app/profile/lukemurraynz.bsky.social" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="Bluesky">
              <svg class="octicon" xmlns="http://www.w3.org/2000/svg" role="img" viewBox="0 0 16 16" height="20" width="20" fill="currentColor">
                <title>Bluesky</title>
                <path d="M8 7.2c-.72-1.4-2.7-4.04-4.53-5.33C1.7.63 1.04.84.6 1.04.1 1.27 0 2.05 0 2.51c0 .46.25 3.77.42 4.32.54 1.82 2.47 2.45 4.25 2.25-2.6.38-4.92 1.33-1.88 4.71 3.33 3.46 4.57-.74 5.21-2.87.64 2.13 1.37 6.18 5.16 2.87 2.84-2.87.78-4.33-1.83-4.71 1.78.2 3.71-.43 4.25-2.25.17-.55.42-3.86.42-4.32 0-.46-.09-1.24-.6-1.47-.44-.2-1.11-.42-2.87.83A17.87 17.87 0 0 0 8 7.2Z"></path>
              </svg>
            </a><a href="https://twitter.com/lukemurraynz" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="X"><svg height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 8.586l4.293-4.293a1 1 0 011.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 011.414-1.414L10 8.586z" clip-rule="evenodd"/>
          </svg></a><a href="https://www.linkedin.com/in/ljmurray/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="LinkedIn"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"></path></svg></a><a href="https://luke.geek.nz/rss" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-rss-link" aria-label="RSS"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/container-apps-vnc-dosbox/">Azure Container Apps with VNC and DOSBox</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/partner-admin-link-tool/">Bulk Link Partner Admin Link (PAL) to Azure Tenants</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/microsoft-learn-contributor-chatmode/">Microsoft Learn Contributor Chatmode</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/service-groups-terraform-azapi/">Deploying Azure Service Groups with Terraform AzAPI</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/mcp-vscode-microsoft-learn/">Model Context Protocol (MCP) in VS Code with Microsoft Learn</a></li></ul></div></nav></aside><main class="col col--7"><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/2021/07/06/create-custom-roles-for-microsoft-azure/">Create Custom Roles for Microsoft Azure</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-07-06T00:00:00.000Z">July 6, 2021</time> · <!-- -->12 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Luke Murray</span></a></div><small class="authorTitle_nd0D" title="Author">Author</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>Microsoft Azure uses Role&#x27;s to define who can access what - Role-Based Access Control (<em>RBAC)</em>.</p>
<p>You may be familiar with some of the more common ones, such as:</p>
<ul>
<li>Owner</li>
<li>Contributor</li>
<li>Reader</li>
</ul>
<p>Behind the scenes, each role is a separate grouping of permissions that determine what level of permissions someone or something has in Azure; these permissions are usually in the form of:</p>
<ul>
<li>Read</li>
<li>Write</li>
<li>Delete</li>
<li>Action</li>
</ul>
<p>Each role can be assigned to a specific Resource, Subscription, Management Group or Resource Group through an &#x27;Assignment&#x27; <em>(you assign a role if you give someone Contributor rights to a Resource Group, for example)</em>.</p>
<p>These permissions can be manipulated and custom roles created.</p>
<blockquote>
<p>Why would you use custom roles you ask? As usual - it depends!</p>
</blockquote>
<p>Custom Roles can give people or objects JUST the right amount of permissions to do what they need to do, nothing more and nothing less, an example of this is maybe you are onboarding a support partner, if they are will only be supporting your Logic Apps, WebApps and Backups, you may not want them to be able to log support cases for your Azure resources; instead of attempting to mash several roles together that may give more or fewer rights than you need, you can create a custom role that specifically gives them what they need, you can then increase or decrease the permissions as needed, however, if a built-in role already exists for what you want. There is no need to reinvent the wheel, so use it!</p>
<p>I will run through a few things to help arm you understand and build your own Custom Roles, primarily using PowerShell.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-the-azure-powershell-modules">Install the Azure PowerShell Modules<a href="#install-the-azure-powershell-modules" class="hash-link" aria-label="Direct link to Install the Azure PowerShell Modules" title="Direct link to Install the Azure PowerShell Modules">​</a></h3>
<p>As a pre-requisite for the following, you need to install the Azure (Az) PowerShell Module. You can skip this section if you already have the PowerShell modules installed.</p>
<ol>
<li>
<p>Open <strong>Windows PowerShell</strong></p>
</li>
<li>
<p>Type <strong>in</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Install-Module -Name Az -Scope CurrentUser -Repository PSGallery -Force</span><br></span></code></pre></div></div>
</li>
<li>
<p>If you have issues <strong>installing</strong> the <strong>Azure PowerShell module</strong> - see the Microsoft documentation directly: Install the <a href="https://learn.microsoft.com/en-us/powershell/azure/install-az-ps?view=azps-7.5.0&amp;WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer" title="Install the Azure Az PowerShell module">Azure Az PowerShell module</a>.</p>
</li>
<li>
<p>Once you have the Azure PowerShell module installed, you can <strong>connect to</strong> your <strong>Azure</strong> subscription using the little snippet below:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#Prompts for Azure credentials </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Connect-AzAccount</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#Prompts Window allowing you to select which  Azure Subscription to connect to </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$subscriptionName = (Get-AzSubscription) | Out-GridView -Title &#x27;Select Azure Subscription&#x27; -PassThru | Set-AzContext -SubscriptionName $subscriptionName</span><br></span></code></pre></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="export-built-in-azure-roles">Export Built-in Azure Roles<a href="#export-built-in-azure-roles" class="hash-link" aria-label="Direct link to Export Built-in Azure Roles" title="Direct link to Export Built-in Azure Roles">​</a></h3>
<p>One of the best ways to learn about how an Azure Role is put together is to look at the currently existing roles.</p>
<ol>
<li>
<p>The following PowerShell command will <strong>list</strong> all <strong>current</strong> Azure <strong>roles</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Get-AzRoleDefinition</span><br></span></code></pre></div></div>
</li>
<li>
<p>For a more human-readable view that <strong>lists</strong> the B<strong>uilt-in Azure roles and their descriptions,</strong> you can filter it by:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Get-AzRoleDefinition | Select-Object Name, Description</span><br></span></code></pre></div></div>
</li>
<li>
<p>As you can see in the screenshot below, there are many various roles, from EventGrid Contributor to AgFood Platform Service and more! At the time of this article, there were 276 built-in roles.</p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="Azure Builtin Roles" src="/assets/images/az_roledefinitions-fff78907e8017f7dd46c24a57387e876.png" title="Azure Builtin Roles" width="1113" height="907" class="img_ev3q"></p>
</li>
<li>
<p>Now that we have successfully been able to pull a list of the existing roles, we will now <strong>export</strong> them as <strong>JSON</strong> files to take a proper look at them.</p>
</li>
<li>
<p>The PowerShell script below will create a few folders on your computer as a base to work from <em>(feel free to change the folders to suit your folder structure or access rights)</em>.</p>
<ul>
<li>c:\Temp</li>
<li>c:\Temp\AzureRoles</li>
<li>C:\Temp\AzureRoles\BuiltinExports\</li>
<li>C:\Temp\AzureRoles\CustomRoles</li>
</ul>
</li>
<li>
<p>Once the folders have been created, it will Get the Azure Role definitions and export them into JSON into the <strong>BuiltinExports folder</strong> to be reviewed.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">New-Item -ItemType Directory -Path c:\Temp -Force</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">New-Item -ItemType Directory -Path c:\Temp\AzureRoles -Force</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">New-Item -ItemType Directory -Path c:\Temp\AzureRoles\BuiltInExports -Force</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">New-Item -ItemType Directory -Path c:\Temp\AzureRoles\CustomRoles -Force</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$a = Get-AzRoleDefinition</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Foreach ($role in $a)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    $name = $role.Name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Get-AzRoleDefinition -Name ($role).Name | ConvertTo-Json | Out-File c:\Temp\AzureRoles\BuiltInExports\$name.json</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre></div></div>
</li>
<li>
<p>Once completed, you should now <strong>see</strong> the <strong>JSON files</strong> below:</p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="Azure Role - JSON files" src="/assets/images/az_exportroles-64761ffc82b21830748f99bbc45f2d9c.png" title="Azure Role - JSON files" width="803" height="356" class="img_ev3q"></p>
</li>
</ol>
<p><em>Although you can use Notepad, I recommend using</em> <a href="https://code.visualstudio.com/Download" target="_blank" rel="noopener noreferrer"><em>Visual Studio Code</em></a><em>to read these files. This is because Visual Studio Code will help with the syntax as well.</em></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="review-built-in-azure-roles">Review Built-in Azure Roles<a href="#review-built-in-azure-roles" class="hash-link" aria-label="Direct link to Review Built-in Azure Roles" title="Direct link to Review Built-in Azure Roles">​</a></h3>
<p>If you open one of the roles, I will open the Azure Digital Twins Data Owner role; however, it doesn&#x27;t matter.</p>
<p>You should see the following fields:</p>
<ul>
<li>Name</li>
<li>Id</li>
<li>IsCustom</li>
<li>Description</li>
<li>Actions</li>
<li>NotActions</li>
<li>DataActions</li>
<li>NotDataActions</li>
<li>AssignableScopes</li>
</ul>
<p>These fields make up your Role.</p>
<p><img decoding="async" loading="lazy" alt="Azure Role - JSON" src="/assets/images/az_rolereview_azdigitaltwinsdataowner-151b998cd27bc5f2f950093d17203c29.png" title="Azure Role - JSON" width="725" height="437" class="img_ev3q"></p>
<ul>
<li>
<p>The <strong>Name field</strong> is pretty self-explanatory - this is the name of the Azure Role and what you see in the Azure Portal, under Access control (IAM).</p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="Azure Portal - Role" src="data:image/png;base64,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" title="Azure Portal - Role" width="398" height="168" class="img_ev3q"></p>
</li>
<li>
<p>The same is true for the: <strong>Description</strong> <strong>field</strong>.</p>
<p><em>These are essential fields as they should tell the users what resource or resources the role is for and what type of access is granted.</em></p>
</li>
<li>
<p>The <strong>IsCustom field</strong> is used to determine if the Azure Role is a custom made policy or not; any user-created Role will be set to True, while any In-Built role will be False.</p>
</li>
<li>
<p>The <strong>Actions field</strong> is used to determine what management operations can be performed. However, the Azure Digital Twins role doesn&#x27;t have any (as it is mainly Data Action based) if we look at another Role such as the: Azure Kubernetes Service RBAC Admin role:</p>
<ul>
<li>&quot;&quot;Microsoft.Authorization/*/read&quot;,</li>
<li>&quot;Microsoft.Insights/alertRules/*&quot;,</li>
<li>&quot;Microsoft.Resources/deployments/write&quot;,</li>
</ul>
<p>You can see that it has the rights to Read the permissions, create and delete any Alert rules and update resources.</p>
</li>
<li>
<p>The <strong>NotActions field</strong> is used to exclude anything from the Allowed actions</p>
</li>
<li>
<p>The <strong>DataActions field</strong> allows you to determine what data operations can be performed. Usually, these are sub-resource tasks, where management or higher-level operations are performed in the Actions field, more specific resource actions are performed in the DataActions field.</p>
<p>The NotDataActions field is used to exclude anything from the Allowed actions in the DataActions</p>
</li>
</ul>
<p>To help get a feel of the differences with the Actions, here is a list of Actions and DataActions for the Azure Kubernetes Service RBAC Admin role:</p>
<ul>
<li><img decoding="async" loading="lazy" alt="Azure Custom Role - JSON" src="/assets/images/az_rolereview_azkuberservicerbacactions-07a6afc5bb072ae8da4a212b4cb59b06.png" title="Azure Custom Role - JSON" width="625" height="366" class="img_ev3q"></li>
<li>And finally, the <strong>AssignableScopes</strong> is used to specify where the role will be available for assignment, whether it can be assigned at a subscription or resource group or management group level. You will notice that most if not all built-in Azure Roles have an Assignable scope of &quot;/&quot; - this means that it can be assigned everywhere <em>(Subscriptions, Resource Groups, Management Groups etc.).</em></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="review-azure-provider-namespaces">Review Azure Provider Namespaces<a href="#review-azure-provider-namespaces" class="hash-link" aria-label="Direct link to Review Azure Provider Namespaces" title="Direct link to Review Azure Provider Namespaces">​</a></h3>
<p>You may have noticed that each Action has a provider. In the example of a Virtual Machine, the provider is Microsoft.Compute.</p>
<ol>
<li>
<p>To get a <strong>list</strong> of all <strong>current Providers,</strong> run the following command:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Get-AzProviderOperation | Select-Object ProviderNamespace -Unique</span><br></span></code></pre></div></div>
<p>At the time of writing, there are 198 current Providers! So that&#x27;s 198 providers or overall buckets of resources that has permissions over.</p>
</li>
<li>
<p>We can <strong>drill</strong> into a <strong>provider</strong> a bit <strong>further</strong> to check out current Operations:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Get-AzProviderOperation -Name Microsoft.Compute/*</span><br></span></code></pre></div></div>
</li>
<li>
<p>This <strong>displays</strong> a <strong>list</strong> of <strong>all providers</strong> within the Microsoft.Compute namespace, such as (but definitely not limited to):</p>
<ol>
<li>Virtual machines</li>
<li>Virtual Machine Scale Sets</li>
<li>Locations</li>
<li>Disks</li>
<li>Cloud Services</li>
</ol>
</li>
<li>
<p>If we wanted to drill into the Virtual Machines <strong>providers</strong> a bit more, we could <strong>filter</strong> it like:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Get-AzProviderOperation -Name Microsoft.Compute/virtualMachines/*</span><br></span></code></pre></div></div>
</li>
<li>
<p>Here we can finally see the available actions, and for example, the following Action will allow you to Read the VM sizes available to a Virtual Machine:</p>
</li>
</ol>
<ul>
<li>Operation: Microsoft.Compute/virtualMachines/vmSizes/read</li>
<li>operation name: Lists Available Virtual Machine Sizes</li>
<li>ProviderNamespace: Microsoft Compute</li>
<li>ResourceName: Virtual Machine Size</li>
<li>Description: Lists available sizes the virtual machine can be updated to</li>
<li>IsDataAction      : False</li>
</ul>
<ol>
<li>
<p>You can use the PowerShell script below to export all the Providers and their Operations to a CSV for review:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$Providers = Get-AzProviderOperation</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$results = @()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ForEach ($Provider in $Providers) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    $results += [pscustomobject]@{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &#x27;Provider NameSpace&#x27; = $Provider.ProviderNamespace</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Description          = $Provider.Description</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &#x27;Operation Name&#x27;     = $Provider.OperationName</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Operation            = $Provider.Operation</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ResourceName         = $Provider.ResourceName</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$results | Export-csv c:\temp\AzureRBACPermissions.csv -NoTypeInformation</span><br></span></code></pre></div></div>
</li>
</ol>
<p>Using the namespace, providers and actions, you should now be able to see the power behind Role-based access control and how granular you can get.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-a-custom-role-using-powershell">Add a Custom Role using PowerShell<a href="#add-a-custom-role-using-powershell" class="hash-link" aria-label="Direct link to Add a Custom Role using PowerShell" title="Direct link to Add a Custom Role using PowerShell">​</a></h3>
<p>Now that we understand how to navigate the Namespaces and Built-In Roles available in Microsoft Azure using PowerShell, now we will create one.</p>
<p>I have created a base template to help you start.</p>
<p>This base template has the following fields that the majority of most custom roles will use:</p>
<ul>
<li>Name</li>
<li>IsCustom</li>
<li>Description</li>
<li>Actions</li>
<li>AssignableScopes <em>(make sure you put in the <subscriptionid> of your Azure subscription, you are assigning the role to.)</subscriptionid></em></li>
</ul>
<ol>
<li><strong>Edit</strong> these <strong>fields</strong> <em>(apart from IsCustom, which you should leave as True)</em> as you need.</li>
</ol>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_OeMC">CustomRoleTemplate.json</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;properties&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;roleName&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Custom Role - Template&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;IsCustom&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;description&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;This is a Template for creating Custom Roles.&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;assignableScopes&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/subscriptions/&lt;SubscriptionID&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;permissions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token property">&quot;actions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/register/action&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/checkNameAvailability/action&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/operationresults/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/operationsstatus/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/operations/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/services/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/services/problemClassifications/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/supportTickets/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/supportTickets/write&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Resources/subscriptions/resourceGroups/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Resources/subscriptions/resourcegroups/resources/read&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token property">&quot;notActions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token property">&quot;dataActions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token property">&quot;notDataActions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>This Custom Role - Template allows you to read the name of all Resource Groups in a subscription and open a Microsoft Support case.</p>
<p>In my example, I am going to add a new role called:</p>
<ul>
<li>LukeGeek-WebApp Deployment-RW</li>
</ul>
<p>This role will allow users to Deploy and modify Azure WebApps, among other things!</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_OeMC">LukeGeekWebDeployment-RW.json</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;properties&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;roleName&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Custom Role - Template&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;description&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;This is a Template for creating Custom Roles.&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         </span><span class="token property">&quot;IsCustom&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;assignableScopes&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/subscriptions/&lt;SubscriptionID&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;permissions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token property">&quot;actions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/register/action&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/checkNameAvailability/action&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/operationresults/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/operationsstatus/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/operations/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/services/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/services/problemClassifications/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/supportTickets/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/supportTickets/write&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Resources/subscriptions/resourceGroups/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Resources/subscriptions/resourcegroups/resources/read&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token property">&quot;notActions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token property">&quot;dataActions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token property">&quot;notDataActions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li>
<p>To <strong>add</strong> the <strong>Custom Role</strong> to Azure, I will <strong>run</strong> the following <strong>PowerShell</strong> command:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">New-AzRoleDefinition -InputFile &quot;C:\\temp\\AzureRoles\\CustomRoles\\LukeGeek-WebApp Deployment-RW.json&quot; -Verbose</span><br></span></code></pre></div></div>
</li>
</ol>
<p><strong>Your new Custom Role has now been uploaded to Azure and can be selected for an assignment.</strong></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-a-custom-role-using-the-azure-portal">Add a Custom Role using the Azure Portal<a href="#add-a-custom-role-using-the-azure-portal" class="hash-link" aria-label="Direct link to Add a Custom Role using the Azure Portal" title="Direct link to Add a Custom Role using the Azure Portal">​</a></h3>
<p>Now that we have been through and investigated the Azure roles and their providers and actions, instead of using PowerShell to look through and create manually, you can use the Azure Portal!</p>
<blockquote>
<p><em><em>Gasp!</em> Why didn&#x27;t you tell me earlier about this, Luke?</em></p>
<p><em>Well, fellow Azure administrator, I found it easier to look at PowerShell and JSON to explain how the Custom Roles were made, vs staring at the Azure Portal and to be honest, really just because! Like most things in IT there are multiple ways something can be done!</em></p>
</blockquote>
<ol>
<li>Log in to the <strong>Azure Portal</strong></li>
<li>Navigate to your <strong>Subscription</strong></li>
<li>Click on <strong>Access Control (IAM)</strong> on the left-hand side blade</li>
<li>Click on <strong>Add</strong></li>
<li>Click on <strong>Add Custom Role</strong></li>
<li>Type in the <strong>Role Name</strong>, for example, WebAdmin-RO</li>
<li>Type in a clear <strong>description</strong> so that you can remember what this role is used for in a year!</li>
<li>For Baseline permissions, select: <strong>Start from Scratch</strong></li>
<li>Click <strong>Next</strong></li>
<li>Click <strong>Add Permissions</strong></li>
<li>If you want, you can select: Download all permissions to review the providers and actions <em>(very similar to the Get-AzProviderOperation PowerShell command)</em>.<img decoding="async" loading="lazy" alt="Azure Portal - Create Custom Role" src="/assets/images/ad_role_addpermissions-0278703408d158c4db94a595c5fd2bde.png" title="Azure Portal - Create Custom Role" width="747" height="596" class="img_ev3q"></li>
<li>As you should <strong>see</strong>, all the <strong>Namespace providers</strong> are listed with the Actions/Permissions that you can do.</li>
<li>In my example, I am going to search for <strong>Microsoft Web Apps</strong></li>
<li><strong>Select</strong> all &#x27;<strong>Read</strong>&#x27; operations <em>(remember to look at Data Actions as well, there may be resource level actions you might want to allow or exclude)</em></li>
<li>Click <strong>Add</strong></li>
<li><img decoding="async" loading="lazy" alt="Azure Portal - Create Custom Role" src="/assets/images/ad_role_webpermissions-e018979c285f779b5e7e38270ed47f86.png" title="Azure Portal - Create Custom Role" width="1090" height="942" class="img_ev3q"></li>
<li>Review the permissions and click <strong>Next</strong></li>
<li><strong>Select</strong> your assignable <strong>scope</strong> <em>(where the Role will be allowed so that you can assign it)</em></li>
<li>Click <strong>Next</strong></li>
<li>You can <strong>review</strong> and download the JSON for backup later <em>(this is handy if you are going to Automate the creation of roles in the future and want a base to start from)</em></li>
<li>Click <strong>Next</strong></li>
<li>Click <strong>Create to create your Custom Role!</strong></li>
<li><img decoding="async" loading="lazy" alt="Azure Portal - Create Custom Role" src="/assets/images/ad_role_createcustomroleportal-d2a9ae3b4c8fd50d676e21ffebdae8c7.png" title="Azure Portal - Create Custom Role" width="1003" height="826" class="img_ev3q"></li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="assign-a-custom-role-using-the-azure-portal">Assign a Custom Role using the Azure Portal<a href="#assign-a-custom-role-using-the-azure-portal" class="hash-link" aria-label="Direct link to Assign a Custom Role using the Azure Portal" title="Direct link to Assign a Custom Role using the Azure Portal">​</a></h3>
<p>Now that you have created your Custom Role - it is time to assign it! So it is actually in use.</p>
<ol>
<li>Log in to the <strong>Azure Portal</strong></li>
<li>Navigate to your <strong>Subscription or Resource Group</strong> you want to delegate this role to</li>
<li>Click on <strong>Access Control (IAM)</strong></li>
<li>Click <strong>Add</strong></li>
<li>Click on <strong>Role Assignment</strong></li>
<li>Under the &#x27;Role&#x27; dropdown, <strong>select</strong> your Custom <strong>Role.</strong></li>
<li><img decoding="async" loading="lazy" alt="Azure Portal - Add Role Assignments" src="/assets/images/ad_roleassignmentportal-06b0eb5d3a8c93ca719e5e71dac491e2.png" title="Azure Portal - Add Role Assignments" width="354" height="958" class="img_ev3q"></li>
<li>Now you can <strong>select</strong> the <strong>Azure AD Group/User or Service Principal</strong> you want to <strong>assign</strong> the role to and click <strong>Save.</strong></li>
<li>Congratulations, <strong>you have now assigned your Custom role!</strong></li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="assign-a-custom-role-using-powershell">Assign a Custom Role using PowerShell<a href="#assign-a-custom-role-using-powershell" class="hash-link" aria-label="Direct link to Assign a Custom Role using PowerShell" title="Direct link to Assign a Custom Role using PowerShell">​</a></h3>
<p>You can assign Custom Role&#x27;s using PowerShell. To do this, you need a few things such as the Object ID, Assignable Scope IDs etc., instead of rehashing it, this Microsoft article does an excellent job of running through the process.</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/role-based-access-control/role-assignments-powershell?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer" title="Assign Azure roles using Azure PowerShell">Assign Azure roles using Azure PowerShell</a></li>
</ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/2021/07/05/add-shortcut-to-azure-virtual-desktop-in-the-microsoft-365-waffle/">Add a shortcut to the Azure Virtual Desktop Web Client to the Microsoft 365 waffle</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-07-05T00:00:00.000Z">July 5, 2021</time> · <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Luke Murray</span></a></div><small class="authorTitle_nd0D" title="Author">Author</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>If you are like me, you use the application launchers in the Microsoft 365 waffle daily, if not hourly! Then having it as a single pane of glass to access all your applications is a no-brainer!</p>
<p>That includes access to the Azure Virtual Desktop Web client! In addition, Microsoft has given us the ability to add Custom App Launchers for applications that are accessible to a URL to the Launchers in the waffle!</p>
<blockquote>
<p>Create custom tiles that will appear in the All apps section of the Office 365 app launcher for all of your users. Users can pin the custom tiles directly to their app launcher for quick access.</p>
</blockquote>
<p>You can add much more than the Azure Virtual Desktop web client to help improve your user&#x27;s experience, but this quick guide will focus on adding the Azure Virtual Desktop Web Client.</p>
<p><img decoding="async" loading="lazy" alt="M365 Waffle" src="/assets/images/m365_waffle_default-8455c4640b6e48dff7d2cf95d7f73dbc.png" title="M365 Waffle" width="317" height="372" class="img_ev3q"></p>
<ol>
<li>Open the <a href="https://admin.microsoft.com/#/homepage" target="_blank" rel="noopener noreferrer" title="M365 Admin"><strong>Microsoft 365 Admin Panel</strong></a></li>
<li>Expand <strong>Settings</strong></li>
<li>Click on <strong>Org Settings</strong></li>
<li>Select <strong>Organisation Profile</strong></li>
<li>Click on <strong>Custom app launcher tiles</strong></li>
</ol>
<p><img decoding="async" loading="lazy" alt="M365 - Organisation Profile" src="/assets/images/m365_customapplaunchertitle-590a7d67693e3b98a5a3e28321e71a90.png" title="M365 - Organisation Profile" width="1349" height="548" class="img_ev3q"></p>
<ol>
<li>Click <strong>+ Add a custom title.</strong></li>
<li>Please type in the name of your Desktop; in my example, it is <strong>Contoso Desktop.</strong></li>
<li>For the <strong>URL</strong> of the website, type in: <a href="https://rdweb.wvd.microsoft.com/arm/webclient/index.html" target="_blank" rel="noopener noreferrer" title="https://rdweb.wvd.microsoft.com/arm/webclient/index.html"><strong>https://rdweb.wvd.microsoft.com/arm/webclient/index.html</strong></a></li>
<li>Type in a <strong>URL</strong> of the <strong>icon</strong> you want the App Launcher to have <em>(Make sure this is a location that you have access to and can manage (i.e. even sitting on your website or Azure Storage account as long as it&#x27;s publically available)).</em></li>
<li><strong>Add</strong> a <strong>description</strong> <em>(such as Contoso Desktop, used for Line of Business Applications)</em></li>
<li><img decoding="async" loading="lazy" alt="M365 - Custom App Launcher" src="/assets/images/m365_customapplaunchertitle1-adf7587e11b2cfb460f3c803016ede0f.png" title="M365 - Custom App Launcher" width="579" height="508" class="img_ev3q"></li>
<li>Click <strong>Save</strong></li>
<li><img decoding="async" loading="lazy" alt="M365 - Custom App Launcher" src="/assets/images/m365_contosoapp-a66ee8bd18dcb410f09b5bd42f4fc189.png" title="M365 - Custom App Launcher" width="528" height="304" class="img_ev3q"></li>
<li>Log out of your Admin account and <strong>log</strong> into an <strong>account</strong> with an Exchange license attached to it. It may take some time for the Custom App Launcher to display.</li>
<li>Once the <strong>Custom App Launcher</strong> has displayed, your users can <strong>pin</strong> it to the <strong>launcher,</strong> so it is always right on top.</li>
<li><strong>Click</strong> on your Azure Virtual Desktop <strong>launcher,</strong> and you should be <strong>redirected</strong> to the Azure Virtual Desktop <strong>Web client</strong>!</li>
<li><img decoding="async" loading="lazy" alt="M365 Waffle - App Launcher" src="/assets/images/m365_pin-e65f9100d3f7808632b437e38328b7d1.png" title="M365 Waffle - App Launcher" width="453" height="452" class="img_ev3q"></li>
</ol>
<p>Just some notes on additional testing:</p>
<ul>
<li>I attempted copying the Azure Virtual Desktop RDP file (C:\Users\%UserAccount%\AppData\Local\rdclientwpf) to my website to access directly however received an error, even opening up the RDP file directly failed, to test the Remote Desktop client.</li>
<li>I had some success opening that RDP up with the Remote Desktop application directly using &#x27;Open With&#x27; C:\Users\%UserAccount%\AppData\Local\Apps\Remote Desktop\msrdcw.exe, instead of the default Remote Desktop Connection client locally.</li>
<li>This will add it for all M365 users, if you want to restrict it to Users/Groups, I would look at testing and creating an App Registration.</li>
</ul>
<p>At this stage, having a launcher to the Web Client is the best bet vs a shortcut directly to the RDP file as you don&#x27;t have to worry about users having the Remote Desktop agent installed when working remotely.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/2021/07/03/start-vm-on-connect-for-azure-virtual-desktop/">Start VM on Connect for Azure Virtual Desktop</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-07-02T12:00:00.000Z">July 2, 2021</time> · <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Luke Murray</span></a></div><small class="authorTitle_nd0D" title="Author">Author</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>One of the models of Cloud governance and cost in Microsoft Azure is <em>&#x27;Pay As You Go&#x27;, ie. Pay for what you need when you need it.</em></p>
<p>The Azure Resource Manager fabrics allow you to scale up and down resources when you need it, whether built-in to the Azure portal or through various other automation mechanisms.</p>
<p>For Azure Virtual Desktop, this means ensuring that session hosts <em>(Virtual Machines)</em> are available for users to connect to consume their services when they need it the most, whether first thing in the morning or late hours of the evening.</p>
<p>One of the technologies that can help with this is: <a href="https://learn.microsoft.com/en-us/azure/virtual-desktop/start-virtual-machine-connect?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer" title="Start VM On Connect">Start VM on Connect</a><em>(Start VM on Connect allows users to start the virtual machine from a deallocated state)</em>.</p>
<blockquote>
<p><strong>You no longer need to create a Custom Role for Start VM on Connect - a built-in role now exists named:</strong> <a href="https://learn.microsoft.com/azure/virtual-desktop/start-virtual-machine-connect?tabs=azure-portal&amp;WT.mc_id=AZ-MVP-5004796#assign-the-desktop-virtualization-power-on-contributor-role-with-the-azure-portal" target="_blank" rel="noopener noreferrer"><strong>Desktop Virtualization Power On Contributor</strong></a> <strong>- once that role is assigned to the Azure Virtual Desktop application, you can skip straight to Configure</strong></p>
</blockquote>
<ul>
<li>Imagine a 9 AM -&gt; 5 PM Monday to Friday business; during the day, Azure Virtual Desktop is available, however anything out of these hours (through Scheduled Shutdowns or Azure Automation Runbooks etc.), the session hosts are shut down to reduce operational costs.</li>
<li>A business user gets some urgent work on Saturday morning and then tries to connect to Azure Virtual Desktop resources to complete the work; because they were turned off outside of business hours, they can&#x27;t connect and then have to ring IT support to get resources started (the alternative would be to leave Virtual Machines running, which may or may not be needed).</li>
<li>Using &#x27;Start Virtual Machine on Connect&#x27;, the moment that the user attempts to connect a Virtual Machine is started.</li>
<li>Then it allows the users to log in and do their work without a call to IT, overall saving money, as the hosts are only started when they are first needed. The feature will also only turn on additional VMs (if available) when the first VM reaches the session limit.</li>
</ul>
<p>This is a host-level setting, so setting &#x27;Start VM on Connect&#x27; will affect all session hosts in the host pool. Therefore, you cannot target specific Virtual Machines in a session host at this stage. This is now supported for both Personal and Pooled session hosts!</p>
<blockquote>
<p><em>As of 03/07/21 (NZ date format - DD/MM/YY): The Start VM on Connect feature is currently in public preview. This preview version is provided without a service level agreement, and it&#x27;s not recommended for production workloads. Certain features might not be supported or might have constrained capabilities. For more information, see</em> <a href="https://azure.microsoft.com/en-us/support/legal/preview-supplemental-terms/?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer"><em>Supplemental Terms of Use for Microsoft Azure Previews</em></a><em>.</em></p>
</blockquote>
<p>Follow the guide below to implement; the Microsoft documentation is pretty good but hoping this might fill in a few gaps for people.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-custom-role-for-windows-virtual-desktop">Create a Custom Role for &quot;Windows Virtual Desktop&quot;<a href="#create-a-custom-role-for-windows-virtual-desktop" class="hash-link" aria-label="Direct link to Create a Custom Role for &quot;Windows Virtual Desktop&quot;" title="Direct link to Create a Custom Role for &quot;Windows Virtual Desktop&quot;">​</a></h3>
<p>For the &quot;Windows Virtual Desktop&quot; service principal (this should already exist, it is an inbuilt SPN created by the Azure infrastructure, it is currently called Windows Virtual Desktop but expect this name to be updated in the future) to have the ability to Start a Virtual Machine, we first need to give it rights. You could give it Contributor or Virtual Machine Contributor rights but want to go with the least privileged to create a custom role.</p>
<ol>
<li>Log in to the <strong>Azure Portal</strong></li>
<li>Navigate to the <strong>Subscription</strong> <em>(you can only currently create custom roles at a subscription level)</em> that your session hosts exist in</li>
<li>Look for the <strong>Subscription ID</strong> <em>(<strong>copy</strong> this, we will need it later on, usually found on the Overview window of the Subscription)</em></li>
<li><strong>Download</strong> the AVD-StartVMOnConnect <strong>JSON</strong> file <strong>below</strong> and <strong>save</strong> it to a location you can edit.</li>
</ol>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_OeMC">AVD-StartVMOnConnect.json</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;properties&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;roleName&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;AVD-StartVMOnConnect&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;description&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Custom role, designed to allow &#x27;Windows/Azure Virtual Desktop&#x27; rights to Start session hosts.&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;assignableScopes&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/subscriptions/&lt;SubscriptionID&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;permissions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token property">&quot;actions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Compute/virtualMachines/start/action&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Compute/virtualMachines/read&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token property">&quot;notActions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token property">&quot;dataActions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token property">&quot;notDataActions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol start="6">
<li>
<p><strong>Open</strong> up the <strong>JSON</strong> file <em>(this is the Custom Role we are creating, as you can see, we are only allowing the ability to Read a Virtual Machine and Start it)</em></p>
</li>
<li>
<p><strong>Replace</strong> the: <subscriptionid> with your <strong>subscription ID</strong>, created earlier and save the JSON file.</subscriptionid></p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="AVD-StartVMOnConnect Custom Role" src="/assets/images/customrolejson_subscriptionid-e3280f423f07f93ad00ee7616c6fa624.png" title="AVD-StartVMOnConnect Custom Role" width="637" height="135" class="img_ev3q">.</p>
</li>
<li>
<p>Click on <strong>Access Control (IAM)</strong> on the left-hand side blade</p>
</li>
<li>
<p>Click <strong>Add</strong></p>
</li>
<li>
<p>Click <strong>Add Custom Role</strong></p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="AVD-StartVMOnConnect Custom Role" src="data:image/png;base64,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" title="AVD-StartVMOnConnect Custom Role" width="471" height="176" class="img_ev3q"></p>
</li>
<li>
<p><strong>Name</strong> your Custom Role <strong>Name</strong> something meaningful, for example, <em>AVD-StartVMOnConnect.</em></p>
</li>
<li>
<p><strong>Add</strong> a meaningful <strong>Description</strong>; for example, mine is:</p>
<p><em>Created: 03/07/21</em></p>
<p><em>Created by: Luke Murray</em></p>
<p><em>Created for: Custom role, designed to allow &#x27;Windows/Azure Virtual Desktop&#x27; rights to Start session hosts.</em></p>
</li>
<li>
<p>For: Baseline permissions, select <strong>Start from JSON</strong></p>
<p><strong>Select</strong> the <strong>JSON file</strong> you downloaded and edited earlier</p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="AVD-StartVMOnConnect Custom Role" src="/assets/images/azureportal_iam_customrole_create-94dbef5f9b8814a478458d79c2ccee3e.png" title="AVD-StartVMOnConnect Custom Role" width="626" height="474" class="img_ev3q"></p>
</li>
<li>
<p>Click on <strong>Next</strong></p>
</li>
<li>
<p><strong>Verify</strong> the <strong>permissions</strong> are as below <em>(if they aren&#x27;t, you may need the redownload or check the JSON file for syntax issues - I recommend downloading</em> <a href="https://code.visualstudio.com/" target="_blank" rel="noopener noreferrer" title="Visual Studio Code"><em>Visual Studio Code</em></a><em>)</em>:</p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="AVD-StartVMOnConnect Custom Role" src="/assets/images/azureportal_iam_customrole_permissions-474c456fa204684bbd18f632ca30a67f.png" title="AVD-StartVMOnConnect Custom Role" width="1433" height="352" class="img_ev3q"></p>
</li>
<li>
<p>Click <strong>Next</strong></p>
</li>
<li>
<p>We used the subscription property to <strong>select</strong> the <strong>assignable scope</strong> <em>(i.e. the scope is where this role will be available for you to assign access to)</em>, but now using the Azure Portal, we can select a specific Resource Group to limit the roles access, please be careful with doing this, especially if you are planning on expanding out your Azure Virtual Desktop infrastructure in the future as you may forget that this role may not be available in other resource groups. I am going to leave mine at the Subscription level and click <strong>Next</strong></p>
</li>
<li>
<p>Here we can <strong>verify</strong> and <strong>save</strong> the changed JSON file <em>(if you want for future reference)</em> and click Next to review your configuration.</p>
</li>
<li>
<p>Click Create to create your Custom Role!</p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="AVD-StartVMOnConnect Custom Role" src="/assets/images/azureportal_iam_customrole_reviewcreate-f29d18635ab6a1aba2cd86b0517fb9d7.png" title="AVD-StartVMOnConnect Custom Role" width="930" height="297" class="img_ev3q"></p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="assign-your-custom-role">Assign your Custom Role<a href="#assign-your-custom-role" class="hash-link" aria-label="Direct link to Assign your Custom Role" title="Direct link to Assign your Custom Role">​</a></h3>
<p>Now that you have created your custom role for Azure Virtual Desktop, it is now time to assign it, and this is where you can assign and lock down the role; in my case, I only have one Resource Group where my session hosts sit in, so going to assign it a Resource Group level, but feel free to assign this at a subscription level.</p>
<ol>
<li>Log in to the <strong>Azure Portal</strong></li>
<li><strong>Navigate</strong> to the <strong>Resource Group</strong> <em>(or Subscription)</em> that has your Azure Virtual Desktop session hosts</li>
<li>Click on <strong>Access Control (IAM)</strong> in the left-hand side blade</li>
<li>Click on <strong>+ Add</strong></li>
<li>Click on <strong>Add role assignment</strong></li>
<li><strong>Select</strong> the <strong>Role</strong> you created earlier <em>(i</em>.e. <em>AVD-StartVMOnConnect)</em></li>
<li><strong>Specify</strong> the &#x27;<strong>Windows Virtual Desktop</strong>&#x27; service principal and select <strong>Save</strong></li>
<li><img decoding="async" loading="lazy" alt="AVD-StartVMOnConnect Custom Role" src="/assets/images/azureportal_addroleassignment-412dc853d174a8fa8386b89196dbe565.png" title="AVD-StartVMOnConnect Custom Role" width="394" height="702" class="img_ev3q"></li>
<li>If you want, you can click on Role Assignments to verify your role has been assigned:</li>
<li><img decoding="async" loading="lazy" alt="AVD-StartVMOnConnect Custom Role" src="/assets/images/azureportal_assignedrolecheck-88df2b0e3d954434ad9d4dcf09f7fccd.png" title="AVD-StartVMOnConnect Custom Role" width="1510" height="204" class="img_ev3q"></li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-start-vm-on-connect">Configure Start VM on Connect<a href="#configure-start-vm-on-connect" class="hash-link" aria-label="Direct link to Configure Start VM on Connect" title="Direct link to Configure Start VM on Connect">​</a></h3>
<ol>
<li>Log in to the <strong>Azure Portal</strong></li>
<li>Navigate to your <strong>Host Pool</strong></li>
<li>Click on <strong>Properties</strong></li>
<li>Select &#x27;<strong>Yes</strong>&#x27; to <strong>Start VM on Connect</strong></li>
<li>Click <strong>Save</strong></li>
<li><img decoding="async" loading="lazy" alt="Azure Virtual Desktop - Start VM on Connect" src="data:image/png;base64,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" title="Azure Virtual Desktop - Start VM on Connect" width="410" height="260" class="img_ev3q"></li>
<li><strong>Congratulations, you have now set up Azure Virtual Desktop - Start VM on Connect</strong>; next time someone connects to a turned-off Azure Virtual Desktop session host, the Virtual Machines will now automatically start the users will get a prompt like below:</li>
<li><img decoding="async" loading="lazy" alt="Azure Virtual Desktop - Start VM on Connect" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAaMAAACQCAIAAAAqbpMUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABJBSURBVHhe7d17bFNXngfw64SmmdISk+6wo05JR47BxcNslqhjStiKmXZiCBkhPCKtVtsp6bADCRLBfUTaVN3+sUublSLaFKTasIMI1bbalqiumIY0MTszQBOGqLJ2gLoKJC5kKdthW0jK8MjT+zsPX7/t6ySE5Ob7aRSde3zO9bVUvvqda/vEYDQalTjBYFC2AABmFIPBIFsRopIuJyfnueeeK+IeeOAB2QsAMENcunTpT9wbb7wxNDQkeyOTzm63v/baa4WFheIQAGDm6u3tfemll9rb28WhTDqKuffee090AQDow1NPPSXCjiUdLVo7OztRzQGAzlBlV1JSQsvY7Nzc3BdffHHdunXyEQAAvcjPzx8dHe3o6MgKBoNFRUWyGwBAX0S+ZaktAAD9oXyjes6Ql5fX398v+6I9/nKTbKUT5D9/2FEpjwEApg2j0Zgm6f7uF5VZBiUYVEaDygj9jLHfw/R7TBnmh7dGlesj7NEbR5uOvYqkA4Bph5KOrV5TmJOlzDEo2VkK5Z2B/xD2izco5q6NsOyjpBvDtyoA4LZZvnx5R0eHPIhAnY8++qg8SC5N0iWML+qkXKNSbmCYV3m80BuTD0Zq3WII29Iqe6dW1DWsfLNHdqdHEzMZDgC30+uvv15VVRUTdnRInTt37pTHyaVJulGeYpRlFG20hqXfS+crdX+j/PtK5b2fKG12xVWirFggByRS0nguyBzevHft5Gad9iQKXUPw8FLnogkkLrIP4I5ZuXKl2+2ODDsRc9RJD4meFNIlHb8rp96kK/2+8swPhr7wHX/nnXf2799Pv//3v4+/snSochHLwVTK1m9Wzpy9wzFRtudcY8neD+9McQkAExMZdhnFHEmTdOzNh6AyNMZ+HjYqj393qLW1dWhoqKys7Nlnn12zZg21qeeXDw09Zi2QcxJq/XBvyZPlZt7ueXOlXE2K+orXSq2yk7rUx8MVVHiKmENT1u5VOqlEk+eIPWcS5vIn1aiLnZLsFPRc1LUl+TOq46NeCMo/gEmnhl1GMUfSJ93gqDI0yn6v+b5y8uTJe++994knnsjPz6fVoNNX95sb/zl37lzq3/yzv5VzovBoIB+uD3Zs50HXumXR+0/KJa2yQ8ZBp3OHcoD10CLXsJE3qd3pbOAZQlOcSw+zvuC5xjNrKUPK9tDDYlm6pyzJOVOLm9LaEHoOfkqJ8mytQt179sQ9Y8wlifGhF3KuUXFuRNYBTBOpko7Wo4M86W6NsfdYH5yr9PX1LVu2jD0UDD5zZMvIreB/rHUXFRVR/+IH8sWsaDwaIteMPWfPqPG3dm+n/xzvLWk8wHOQLXJDtZ+64GVTNq8X6WPe/vLm0CRV4nMmU2JdlGjKImvJ3nBiCe9vZHEYEXwhSS8p9EISXicATIy6aBWVHR3KB9JJlXRjQeXMR01nWpo++6jpxh+bqYfWqlTN/fK3W/7hyK8PPOHOzlWePrzFaDRG7gOVgHn7gcYzEaXWZlk7kQQpMj7aztnT8n7n0sViER0zxby9Ixg8oGyk6AutRjspucYbVywLAWASRd6bU5exGsMuVdIdfbXy2KuVx1+t/OS1yubaDdSTk5PzzTffvP1zd/at7KeP/Lrpp66317iuXLlC/WJKMlTiLBWrOfPipcpebQvMED5Fvbm2Y2+omFJpPadYcvIgTDKF4o4K0NBbJyVPHug4rMQWekzSS+p8v4UPZpEad50AMF7xb0FkFnZ5eXmyrknpzQO/vfzNwLFjx44cOfL0oc1/3/ar4eFhKuUGBwfb29upX46LErqxxVGCyCPWCmF1VeSwJO3wlPAJ6WFGVGax51TJUVx4LhMzJTxQzFefnY/jzSTPqJ6WTdm8WXZHXQUATMDY2Njy5cs/+eQTeRyBOm02mzxIglIu1bfB4ol3WufOnVtUVESLVqrmTp06dePGjbKysrRl3SzQusWww3pOvvMCAJOIAsuQ6A9EaJHme69XBq5d+fYvVwf+MjI6KnoWfu+vFsyfd/Lkyb6+Pko9SreCggLK2oHrN7OzsvLz7hPDZiskHcB0lCbpdr39kWxFMC383vKixd/NnycO/+/Ktyf/dDbwP19Ru+aZn4vO2QpJBzAdpUk6AAAdoKRL88lhAAAdQNIBgP4h6QBA/5B0AKB/SDoA0D8kHQDoH5IOAPSPfZ7uwoUL8ggAQHceeugh1HQAoH9IOgDQPyQdAOgfkg4A9A9JBwD6h6QDAP1D0gGA/iHpAED/kHQAoH9IOgDQPyQdAOhf1pIlS2QTAECPKOXwDX8A0Dl8wx8AZoUMki7gctqNnN3u9AZkLwDAtKc16QIue7HHUuvrZ9y1SkWV6/ZlHT2ZnZ9ebWg3jikAoHdak67No9S7q0tN/MBU2tjfXi3at5Wpun1KngcA9E1r0nkUx+r4yFEXtLSc5Ye0ro3qiu+JniWrr4BXXRg7vV5XVV1XV10xlWaiQEtzErsxXMQFwnP5UcwkRfE6jWobAGaLibwjwWJF4Qtan8NfIQKky99d7mYr3INWfwOPm9gemuWx8I5+t8XDFsHUU6E4+MLYR+viBqW23mar90VWcwlOIp+63+2wyUHEVO1W5ya6PIWq0cZS3gKA2WMCSRdgK9oavqA1rXbY/D0s12wO0aMUWthvEtNDs1jRxUutYqq/PG1efh4Ra2JdXMiaUeJPEnrqpBJeHgDMSlnBYFA2U3IonrZJi4rKg6wYExLlGgDApNJa0612KHVVLvnZkoDXabS7eN8u3sUKNas5ZYkVwuqrpha+rqX1JbsNRz10HtnDz9zLmqmIKeJqert5V5yIMRlcHgDokdakM1W3+xzdDXLV2aAcdFeb2E0xhXcVexw+rbe/aNZBxcNPVNXtoNNE9ogzl5oppIpTvXXAntpfwac0+LtkJ2dS5ya8PLwjATAbGebNm9fX1yePZiCqAotbyvE2AwAkU1BQMJH3Xu8k9WMpVAXW1yDmACCVGV/TAQCkNoNrOgAA7ZB0AKB/SDoA0D8kHQDoX4ZJ53Uaw9+nD7js0R9OU7+QL94WZewJdrJLOyAhcXJ5AACQgcySztvir6y0hr4XFvt1UvZNU7Hjia1ebGTX76u1NMiNRaKkHaAFsg8AtMko6QI9fmt5Y3lk1EV8HTYcdGGmUvZFhRRfmU07AABgwjJJOooya3kp204kUdQlCjrGZLZ2daf6Jqs6IG7futAyV93HTvA62fbuEdvYUV+infLiNqcDgFkqg6STQRcVb+F2sqBjGy2l2TJJDIjft867q87Kdj3xOfx1u2RasT07Gyzu9sZSVgym2oquSxFni9icDgBmKe1JR1HW1VTBiiSxrVx01CUPOqW3O81GInyAErdvXYASsKmCarM2s1t8Qb/LU1VV0WStjdiik2NPHr9TnkVcTrgHAGYrzUnHKjp1Wzlf+NaajLrkQRfo8dssqfagCw+I3rfOZKpuZ3+dx9LdUFwsqjJrrdtXjxINADKkNelYlIXzKrxole2qJEEXYHfT4ouwMHUAK72i961jH2mxu5TS6kZapvp7elmZVsi3iorNOnYJcVvRdXWLCwz3AMBspTXpYmq22Kjrig660DLUWNzQXZto57oEA+L3rSutqbfyjmIPHYdjlmcdRWHqrehs/u4qdrJM9s4DAH3S6V4mVBVWKW78BUUAwF4mADBLYH86ANA51HQAMCtkPfzww7IJAKBHlHJYvQKAzmH1CgCzApIOAPQPSQcA+oekAwD90/qOxKeffipbADCdPPLII7KVXN/A6NaWK6cvDw/cGpNdM1n5ou/U/8xYkJctj9MpKCjQmnQL/vBj2UruvO2obAHAlPD7/WmTjmLusf1/3l4yv2ZF/ry7DbJ3xvp2MNjkG/jX3319/Fd/rTHs8N4rgP7V/Vf/K4/f//JP7tdBzBF6FTUrjDUl86lKlV0aIOkAdK7l7M2Ny4zyQC9qVsw//edheZBOMBhE0gHonz6quUh5uVkDgxncc0TSAYD+IekAIJWe3VtX5XCrVm39uEf2TlzP7lWrdk/e6dJA0gFAUhRH1uYldf4hZl+dsm7T1IXTpELSAUAyPa3Nys5929aY+ZF5zVtDR7eJ9kyDpAOAJFjQbSiLj7aPQ+vZHFrPinXo1tAal/eQHnVQaM2rLoNp8JQXhkg6AMjQmreO8uXskH/DZ/U8tU589vm6fazn0A95T8/uTeuUDXzR6xdrXuppXsKHDO1b0jzli2AkHQBkiFVnvDyzvnBC9KzY8LxY4pqXsN981fu8WOiKNa/S2nzixAtWXtPRrBPNrVMbdUg6AEjCXLZBiY+kj7eyNyl4eebfuUJ2avGPh3hJx031/T4kHQAkw6LuhU275WdLej7emiM+GPJDxcyCqqf1c1nTxeDzXhcrVDFLKduw4jeHZM+Ufr5EQNIBQFLmbUf9Gz6vl6vOeuXQvm3mNc/vVJp5z6bmz+S4WOZt+w7JQXJWRM+mzzdQhxw5RSa6l4mB/hMNgyHw49+LNgBMDS17mRj/7eLQvyyWBzqS88rZ/n96UB6ktHDhwvHXdJRx7IfLov9CkQcAMN2MM+nUjJN5x3oAYDrKy836djAoD/Qioy1Fx7OXiYy2UMbxHt7P4g4App0fLbhr14mr8kAvmnwD5Yu+Iw/S6ejoGM/u6gg1gDuIKhTZ4jTsOTzy2P7L//zT+zcuy6P6TvbOWFTNvdl5dfcfrx5/dkFB3hzZm9KFCxfwl60B9I/Crq7lYov/KsWk7Jqx8nKzf/TgvLd+sVBjzBEkHQDoHyUdPk8HAPqHpAMAncPfkQCAWQFJBwD6l2WxWGQTAECPDAZDVnd3tzwCANAprF4BQOfwjgQAzAqZJF3AZTdydrvLK/t0Qn1pjN0ZenUBl1N9yU5vQPYCwEyjPem8zmKPw9fPuB2eCvqH76LES/OvXx2jZfDtoP15bfXixfX7HP4GNoWmFnsstfIl1yoVVXfiBQDAJNCcdIEev82x2sTbpur2/sZS3tSKprRXi9nTncls7eruVQJtHqXeXV0qX3JpY/9MeQEAEEtz0plWO5S6XS5vQNY1AVdVXVdXXbGomLyhVZ5Y+rFKyul0Go3FoTGituL9oRVhaJGoLhHtdmNk/SVPQo+x+lGdJMst+RDN8PLHQqvLiJFeOoi8yJiTJBHwtvhtlkIWdKFkB4AZTvvq1VTtPmjpbiguZlHhCtBhvY1WfKLQKW1s54s8demndPkt5b5+X8QYocvfXe5mIw9a+UgWRopYIrodNjkohJ2EBtf0VHksfFK/2+IRi0h6qKadzq/UNSisQc/bFnk26qhw9kZcJD0Ud5JIFIg8BosbFIcb1RuArmTyjoSptJoHmu+gtS4mKVi5xOslKuJEDy115cIvms1RI/oL+SeW+RpR9sQTJ6ExrDATOUQ1mqetlz8kJqkNEnE2qkFt/p7wRcafJCbq1Pt07Y3IOQCdySTpQkyl5ZXsTpaKvVlhqeX1EhVxsnNyVR7kKcS1VxfK3gxFnyR1nLHVelwaAsDMpDXpAi67MXR3K+BtabJZotPGqhSy5Ai0dcuaTiNx+0/cYutN8m0NVp41tYgnF/f7eHcCEWdjNZzVHE4z7SeR+LmqXPKzJQGvM+omIgDMGBl8cpjdpVM86p2sg+5qk8lMUVBsdHqV0pp6+ViVxy8nCOExybD7ff4KPrnBnyQlI568qjvlTTR2NqWBjWQfiWksjbgA7SeRTNXtPkc3P5n6mqmbIk+8nPgGAExT02jPYSqbilvKM/34CgBAal988cV47tNNLvUDKlQ21dcg5gBgkrG/ZYi/IwEA+nb+/Pk7X9MBANxuSDoA0D8kHQDoH5IOAPQPSQcAOoc9hwFgVkDSAYDO3bp1C0kHAPqHpAMA/UPSAYD+IekAQP+QdACgf0g6ANA/lnRfffWVOAAA0JmRkZEsQq3Tp0+LLgAAnbl582Z2djaSDgD0jH1smFit1iNHjnz55ZeyGwBALwYHB7/++muq6bKvXbt2+fLl8+fPr1+/Xj4IAKALly5dMhgMc+bMyc7NzaVWIBA4depUUVHR/Pnz5RAAgBmLqjlaqtLS9e6776bFK0s66hVh9+67746MjFCVd88999x3331iAgDATDE8PHz9+vWrV69evHiRYk3EHDUMeXl5YkQwGBQNEtmeFBmdkAZ/8MEH8iCJcV9hionje2jcZso5b4fxXSf97ypbU+J2PN24z5li4vgeGrdxP93tfgk0klCu3XXXXdnZ2fSbvREhYs5g+H/iaRN5Zxyn5gAAAABJRU5ErkJggg==" title="Azure Virtual Desktop - Start VM on Connect" width="419" height="144" class="img_ev3q"></li>
<li><img decoding="async" loading="lazy" alt="Azure Virtual Desktop - Start VM on Connect" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAaMAAACQCAIAAAAqbpMUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABJ8SURBVHhe7d1/TJR3ngfw74ClbG1lpLfeplvpZhidOuseJ+mNFa/pbrugyMY4G2lzuW6l662CiUh/kBxNr3/c2XIJsaWalNFbIzbX5lpJp3GLVPAuqxZcSTO5VTvNKEyVs17XaxXq+oOfc5/vj3nm98wzCAgP79c25Hm+8/1+58Gs73w+8+PRZDabWYxAIKCOAABmFJPJpI7CRCRdVlbW888/XyA88MADahQAYIa4dOnSH4U333xzaGhIjYYnXUlJyeuvv56fny9PAQBmrt7e3pdffrm9vV2eqqSjmHv//fflEACAMTz99NMy7HjSUdPa1dWFag4ADIYqu6KiImpjM7Ozs1966aW1a9eqRwAAjCI3N3d0dLSzszMjEAgUFBSoYQAAY5H5lqEdAQAYD+Ub1XOmnJyc/v5+NRbpiVea1VEqAfHf77dXqHMAgGnDbDanSLq//WVFhokFAmw0wEbovzH+c5h+jrFhcXprlF0f4Y/eONp87DUkHQBMO5R0vHtNYk4Gm2NimRmM8s4k/iP8hzigmLs2wrOPkm4M36oAgEmzfPnyzs5OdRKGBh999FF1kliKpIsbXzRIuUal3MCwqPJEoTemHgzXttkUsrlNjU6tiGtY+VaPGk6NFqYzHQAm0xtvvFFZWRkVdnRKgzt27FDniaVIulGRYpRlFG3Uw9LPpfNZ3V+xf1vJ3v8pO1zCmorYigVqQjxFjecC3KFNe9ZMbNbpT6LgNQQOLa1ZdBuJi+wDuGNWrlzpcrnCw07GHA3SQ3IkiVRJJ16V016kK/4he/ZHQ196jr/77rv79u2jn//738dfXTpUsYjnYDKl6zaxM2fvcEyU7j7XWLTnoztTXALA7QkPu7RijqRIOv7mQ4ANjfH/HjazJ74/1NbWNjQ0VFpa+txzz61evZqOaeRXDw09Zs9Ta+Jq+2hP0VNlVnHc89ZK1U3K+krUSm1qkIa0x0MVVGiJXENL1uxhXVSiqT2i90zAWvaUFnXRSxJtQc9FQ5sTP6M2P+IXQfkHMOG0sEsr5kjqpBscZUOj/OfqH7KTJ0/ee++9Tz75ZG5uLnWDNZ663974j7lz59L4pp//tVoTQUQD+WhdoHObCLq2zYs+eEq1tGy7ioOumu1sPx+hJte0QRzScVdNg8gQWlKz9BAfC5xrPLOGMqR0Nz0s29LdpQn2TC5mSVtD8DnElgrl2RpGw7t3xzxj1CXJ+cFf5Fwjq9mArAOYJpIlHfWjgyLpbo3x91gfnMv6+vqWLVvGHwoEnj2yeeRW4N/XuAoKCmh88QO5clUkEQ3hPWPP2TNa/K3Z0+U9J0aLGveLHORNbrD20xpevmTTOpk+1m2vbAou0sTfM5Ei+6J4SxbZi/aEEkv6YAOPw7DgC0p4ScFfJO51AsDt0ZpWWdnRqXoglWRJNxZgZz5uPtPa/PnHzTf+0EIj1KtSNfer323++yO/2f+kKzObPXNos9lsDr8PVBzWbfsbz4SVWptU7UTipMj46Nuzp/WDrqWLZRMdtcS6rTMQ2M82UPQFu9EuSq7xxhXPQgCYQOGvzWltrM6wS5Z0R1+rOPZaxfHXKj59vaKldj2NZGVlffvtt+/8wpV5K/OZI79p/lnTO6ubrly5QuNySSJU4iyV3Zx18VK2R1+DGSSWaC+ubd8TLKY0eveULacIwgRLKO6oAA2+dVL01P7OQyy60OMSXlLXB61iMo/UmOsEgPGKfQsivbDLyclRdU1Sb+3/3eVvB44dO3bkyJFnDm76u8O/Hh4eplJucHCwvb2dxtW8CMEXtgRKEHXGj4J4XRU+LcFxaEloQ3qYk5VZ9J4aNUsIreWiloQmyvXas4t54jDBM2rb8iWbNqnhiKsAgNswNja2fPnyTz/9VJ2HoUGHw6FOEqCUS/ZtsFjynda5c+cWFBRQ00rV3KlTp27cuFFaWpqyrJsF2jabttvPqXdeAGACUWCZ4v0DEXqk+N7rlYFrV77789WBP4+MjsqRhT/4iwXz5508ebKvr49Sj9ItLy+Psnbg+s3MjIzcnPvktNkKSQcwHaVIup3vfKyOwlgW/mB5weLv586Tp/935buTfzzr/5+v6bj62V/IwdkKSQcwHaVIOgAAA6CkS/HJYQAAA0DSAYDxIekAwPiQdABgfEg6ADA+JB0AGB+SDgCMj3+e7sKFC+oMAMBwHnroIdR0AGB8SDoAMD4kHQAYH5IOAIwPSQcAxoekAwDjQ9IBgPEh6QDA+JB0AGB8SDoAMD4kHQAYX8aSJUvUIQCAEVHK4Rv+AGBw+IY/AMwKaSSdv6mmxCyUlNR0+NUoAMC0pzfp/E0lhW5braefc9Wy8sqmycs6erISsb12oN84lgCA0elNusNuVu+qKraIE0txY397lTyeVJaq9il5HgAwNr1J52bOVbGRozW01M6KU+prI4ZiRyJXqerL36E1xjUdHU2Vdd3ddYVUmskCLcUmJeZQEecPrRVnUYsY66gxa8cAMFvczjsSPFaYaGg9Tm+5DJBur6/MxTvcA3Zvg4ib6BFa5baJgX6Xzc2bYBopZ07RGHuoL25gtfUOR70nvJqLs4l66n6X06EmEUuVS1sb7/IYVaONxeIIAGaP20g6P+9oq0VDa1nldHh7eK45nHKE5dv4TxI1Qqt40SVKrUKqv9yHO8Q+MtZkX5zPDyPEbhJ86oTiXh4AzEoZgUBAHSblZO7DExYVFQd4MSbFyzUAgAmlt6Zb5WR1lU3qsyX+jhpzSZMY2ymGeKFmtyYtsYJ4fdXcKvpa6i/5y3A0QvuoEbFzLz9MRi6RV9PrE0MxwuakcXkAYER6k85S1e5x+hpU19nADriqLPxFMSaGCt1Oj96Xv2jVAeYWG1X6nLRN+IjcudhKIVWY7K0D/tTecrGkwdutBgWLtjbu5eEdCYDZyDRv3ry+vj51NgNRFVjYWoa3GQAgkby8vNt57/VO0j6WQlVgfTViDgCSmfE1HQBAcjO4pgMA0A9JBwDGh6QDAOND0gGA8aWZdB015tD36f1NJZEfTtO+kC/fFuVK4tzJLuWEuOTm6gQAIA3pJV1Hq7eiwh78Xlj010n5N03lHU8c9fJGdv2eWluDurFIhJQT9ED2AYA+aSWdv8drL2ssC4+6sK/DhoIuxFLMv6iQ5CuzKScAANy2dJKOosxeVsxvJxIv6uIFHWex2rt9yb7Jqk2IuW9dsM3V7mMnddTw27uH3caOxuLdKS/m5nQAMEulkXQq6CLiLXScKOj4jZZS3DJJToi9b13Hzjo7v+uJx+mt26nSit+zs8Hmam8s5sVgslvRdTO5W9jN6QBgltKfdBRl3c3lvEiSt5WLjLrEQcd6fSluJCImsJj71vkpAZvLqTY7bHXJL+h3uysry5vttWG36BT4k8feKc8mLyc0AgCzle6k4xWddls5T+ilNRV1iYPO3+N12JLdgy40IfK+dRZLVTv/13lsvobCQlmV2WtdnnqUaACQJr1Jx6MslFehplUdVyYIOj9/NS22CAvRJvDSK/K+dfwjLSVNrLiqkdpUb08vL9Pyxa2iorOOX0LMrei6ffICQyMAMFvpTbqomi066rojgy7YhpoLG3y18e5cF2dC7H3riqvr7WKg0E3noZgVWUdRmPxWdA6vr5Jvls698wDAmAx6LxOqCiuZC/+CIgDgXiYAMEvg/nQAYHCo6QBgVsh4+OGH1SEAgBFRyqF7BQCDQ/cKALMCkg4AjA9JBwDGh6QDAOPT+47EZ599po4AYDp55JFH1FFifQOjW1qvnL48PHBrTA3NZGWLvlf/c3NeTqY6TyUvL09v0i34/d+oo6DzjqPqCADuEK/XmzLpKOYe2/enbUXzq1fkzrvbpEZnrO8GA82egX/5r2+O//ovdYYd3nsFML66/+x/9Yn7X/np/QaIOUK/RfUKc3XRfKpS1ZAOSDoAg2s9e3PDMrM6MYrqFfNP/2lYnaQSCASQdADGZ4xqLlxOdsbAYBqvOSLpAMD4kHQAkEzPri2PZwmPP77lkx41evt6dj3++K6J2y4FJB0AJERxZG9ZUucd4vbWsbUbpy6cJhSSDgAS6WlrYTv2bl1tFWfW1W8PHd0qj2caJB0AJMCDbn1pbLR9Euxns6iflX3olmCPK0ZIjzYp2PNqbTBNnvLCEEkHAGla/fZR0c4Oedd/Xi9S68TnX6zdy0cO/liM9OzauJatF02vV/a8NNKyREwZ2rukZcqbYCQdAKSJV2eiPLO/eEKOrFj/gmxxrUv4T9H1viAbXdnzsraWEydetIuajladaGmb2qhD0gFAAtbS9Sw2kj7Zwt+kEOWZd8cKNajHPxwUJZ0w1a/3IekAIBEedS9u3KU+W9LzyZYs+cGQHzMrD6qeti9UTRdFrHtDdqhyFStdv+K3B9XIlH6+RELSAUBC1q1Hveu/qFddZz07uHerdfULO1iLGNnY8rmaF826de9BNUmtChvZ+MV6GlAzpwjuZQIwg+m5l4n5Xy8O/fNidWIgWa+e7f/HB9VJUgsXLkRNBwDGN86kM9H/AGAmyMnO+G4woE6MIq1bio7zXiaIOYAZ5CcL7tp54qo6MYpmz0DZou+pk1Q6OzvHf3d1kwl5BzBFqCpRRzF03HN45LF9l//pZ/dvWJZD9Z0anbGomnur6+quP1w9/tyCvJw5ajSpCxcu4F+2BjA+Cru61out3qsUmWpoxsrJzvzJg/Pe/uVCnTFHkHQAYHyUdHjvFQCMD0kHAAaHf0cCAGYFJB0AGF+GzWZThwAARmQymTJ8Pp86AwAwKHSvAGBweEcCAGYFvUnXUWOu6VDH/qYSc+iMHilp8quTidVRQ08UeqbpQvz+QSVhfyzicvkYDU7OnwgAjIvepMu3Obw98m+v/7CbOUJnPV5mt1rEcTiKAwpA+VM7lQ/p1dHabD/Q399YrM4nnf6LdNR7+gWP09vAl9DSQretVo66all55SSlPwCMg96ks1jt3e7D4i9vr485a51MO+uuKIuTRZaq9vaqUABGnepBGeqw5auT6Yr/ufh6RfrXu6qK5W9oKW7sT/e3BYBJpPt1uuKyCv5XWlZa1uJVTibOQnEkW03RvPGGjtdHNTWVdd3ddYVacScGg01esO/Tur6SkrA+uKOmUKyVzWtojjrlm/OhYO8YPhI2WZVb6iHavkM8FuwuI7b1N2lXG/lQkurM39HKf38edM5ViDaA6Ur/OxKqf6Vo4zUc1TLiLPRXvLixXbRuWkPHmK3aVe+gRi+8vun2+spcfNoBu5jG84XJrs/ldKhJpLjRI9by5jU0h/Yul+HW7bXxfcJaWzVS3VPptoln6HfZ3LKJpIeq2/s99ayugfEDukKqSKO27a0KXS09FLNJOB7BXGEDc7pQvQFMd/qTziLKOB5toobLt/H+lXrX4It0vAgSVRDVYmIgPoezWvZ4tAERbZ8aSSRsDl2EeoXQ4VwVtUqO0GRRCqoroZabSk96SM7VDkjcbaXYTaKiTnudrr0ROQcw/elPOlHGte70qRpOBN/OVlHgEWo23bZaUQVRLcZH7qCKAyKFhPaqcb7UF7lJ8jjjfxgxaQgA00YaSceKy+zNzc3BGo6Cj85kgSfYWT5/xH/Yl6ymi8Izom6nfNWsN8G3NcLm8GIr3ju9Ibw8a26V7aZ8cVAMx5FkW/2bKGKvyib12RL/JH7yBgDSle4nh/NtDhZ6O7S4rCLUDRZX1zO3aPcq3V4xIlislADqXYX4LFWuem+5WNngTRCRfA5r4HMK3U5Pik+d0OQDwUvxJX0RLWbb0NXq30SxVLV7nD6xGW3XwA7INdrHEGMPAGDqTKN7DlMlVNhaNoUfnwOAWeHLL79Mq6abFNqnU6gSqq9GzAHABDMR/DsSAGBs58+fv/M1HQDAZEPSAYDxIekAwPiQdABgfEg6ADA43HMYAGYFJB0AGNytW7eQdABgfEg6ADA+JB0AGB+SDgCMD0kHAMaHpAMA4+NJ9/XXX8sTAACDGRkZySB0dPr0aTkEAGAwN2/ezMzMRNIBgJHxjw0Tu91+5MiRr776Sg0DABjF4ODgN998QzVd5rVr1y5fvnz+/Pl169apBwEADOHSpUsmk2nOnDmZ2dnZdOT3+0+dOlVQUDB//nw1BQBgxqJqjlpVal3vvvtual550tGoDLv33ntvZGSEqrx77rnnvvvukwsAAGaK4eHh69evX7169eLFixRrMubowJSTkyNnBAIBeUDCjydEWhvS5A8//FCdJDDuK0yycHwPjdtM2XMyjO866f+u6mhKTMbTjXvPJAvH99C4jfvpJvtXoJmEcu2uu+7KzMykn/yNCBlzJtP/A3B3YOyoBgZwAAAAAElFTkSuQmCC" title="Azure Virtual Desktop - Start VM on Connect" width="419" height="144" class="img_ev3q"></li>
<li>Before finally prompting for their login credentials!</li>
</ol></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/azure/Azure-Virtual-Desktop-Optimisations/">Azure Virtual Desktop Optimisations</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-07-01T00:00:00.000Z">July 1, 2021</time> · <!-- -->15 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Luke Murray</span></a></div><small class="authorTitle_nd0D" title="Author">Author</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>If you are running Azure Virtual Desktop, you want to get the most performance and stability out of them as possible, to reduce cost and increase user experience.</p>
<p>These are a few recommended policies and optimisations to apply to your Azure Virtual Desktop setup. These are in no particular order; they are just recommendations.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-timezone-redirection">Configure Timezone Redirection<a href="#configure-timezone-redirection" class="hash-link" aria-label="Direct link to Configure Timezone Redirection" title="Direct link to Configure Timezone Redirection">​</a></h3>
<p>Timezone redirection will allow you to pass through the time from the local device to the Azure Virtual Desktop host. This is useful to keep the consistent time between the device you are connecting from and the session host, and by default, the timezone in Azure is UTC.</p>
<ol>
<li>On a server with the Group Policy Management Console is installed for managing your Azure Virtual Desktop farm, <strong>open</strong> the <strong>Group Policy Management Console</strong>.</li>
<li><strong>Expand</strong> your <strong>domain</strong> and <strong>Group Policy Objects</strong>.</li>
<li><strong>Right</strong>-<strong>click</strong> the <strong>GPO</strong> that you created for the group policy settings and select <strong>Edit</strong>.</li>
<li>In the Group Policy Management Editor, <strong>navigate to Computer Configuration</strong> &gt; <strong>Policies</strong> &gt; <strong>Administrative Templates</strong> &gt; <strong>Windows Components</strong> &gt; <strong>Remote Desktop Services</strong> &gt; <strong>Remote Desktop Session Host</strong> &gt; <strong>Device</strong> <strong>and Resource Redirection</strong>.</li>
<li><strong>Enable</strong> the setting <strong>Allow time zone redirection</strong>.</li>
<li><strong>Close</strong> the <strong>Group Policy Management console</strong>; as this is a Computer-based policy, it may take up to 90 minutes to take effect unless the session hosts are restarted to force it to pick up the policy sooner.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-session-time-limit-policies">Configure Session Time Limit Policies<a href="#configure-session-time-limit-policies" class="hash-link" aria-label="Direct link to Configure Session Time Limit Policies" title="Direct link to Configure Session Time Limit Policies">​</a></h3>
<p>You can use this policy to specify the maximum amount of time that a disconnected session remains active on the server. By default, Remote Desktop Services allows users to disconnect from a Remote Desktop Services session without logging off and ending the session. Unfortunately, this means that sessions users sessions may remain open for an extended period of time, taking up usable resources.</p>
<p>When configuring these, take into consideration a users normal work time, the time they have for lunch etc., the sweet spot to disconnect their session is not during their lunch break, but after they have finished for the day, usually 8-12 hours is recommended, but is dependant on how Azure Virtual Desktop is used.</p>
<ol>
<li>On a server with the Group Policy Management Console is installed for managing your Azure Virtual Desktop farm, <strong>open</strong> the <strong>Group Policy Management Console</strong>.</li>
<li><strong>Expand</strong> your <strong>domain</strong> and <strong>Group Policy Objects</strong>.</li>
<li><strong>Right</strong>-<strong>click</strong> the <strong>GPO</strong> that you created for the group policy settings and select <strong>Edit</strong>.</li>
<li>In the Group Policy Management Editor, <strong>navigate to Computer Configuration</strong> &gt; <strong>Policies</strong> &gt; <strong>Administrative Templates</strong> &gt; <strong>Windows Components</strong> &gt; <strong>Remote Desktop Services</strong> &gt; <strong>Remote Desktop Session Host</strong> &gt; <strong>Session Time Limits</strong>.</li>
<li>Configure the below settings per your organisation policies:</li>
</ol>
<ul>
<li><strong>Set time limit for active but idle Remote Desktop Services sessions</strong></li>
<li><em>This policy allows you to specify the maximum amount of time that an active Remote Desktop Services session can be idle (without user input) before it is automatically disconnected.</em></li>
<li><strong>Set time limit for active Remote Desktop Services sessions</strong></li>
<li><em>This policy allows you to specify the maximum amount of time that a Remote Desktop Services session can be active before it is automatically disconnected.</em></li>
<li><strong>Set time limit for disconnected sessions</strong></li>
<li><em>This policy allows you to configure a time limit for disconnected Terminal Services sessions.</em></li>
<li><strong>End session when time limits are reached</strong></li>
<li><em>This policy allows you to specify whether to terminate a timed-out Terminal Services session instead of disconnecting it.</em></li>
<li><strong>Set a time limit for log off of RemoteApp sessions</strong></li>
<li><em>This policy allows you to specify how long a user&#x27;s RemoteApp session will remain in a disconnected state after closing all RemoteApp programs before the session is logged off from the RD Session Host server.</em></li>
<li><strong>Close</strong> the <strong>Group Policy Management console</strong>; as this is a Computer-based policy, it may take up to 90 minutes to take effect unless the session hosts are restarted to force it to pick up the policy sooner.</li>
</ul>
<p><em>Reference: Taken from:</em> <a href="https://kb.parallels.com/en/123638" target="_blank" rel="noopener noreferrer" title="https://kb.parallels.com/en/123638"><em>https://kb.parallels.com/en/123638</em></a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="deleteuserappcontainersonlogoff">DeleteUserAppContainersOnLogoff<a href="#deleteuserappcontainersonlogoff" class="hash-link" aria-label="Direct link to DeleteUserAppContainersOnLogoff" title="Direct link to DeleteUserAppContainersOnLogoff">​</a></h3>
<p>Back in March 2019, there were issues with slow server performance caused by numerous Windows Firewall Rules getting created on user login. A patch was released; however, to enable this &#x27;<em>fix</em>&#x27;, a registry key needs to be set. You could eventually run into host performance/hang issues if this key is not configured. See: <a href="https://support.microsoft.com/en-us/help/4490481" target="_blank" rel="noopener noreferrer" title="https://support.microsoft.com/en-us/help/4490481">https://support.microsoft.com/en-us/help/4490481</a></p>
<ol>
<li>On a server with the Group Policy Management Console is installed for managing your Azure Virtual Desktop farm, <strong>open</strong> the <strong>Group Policy Management Console</strong>.</li>
<li><strong>Expand</strong> your <strong>domain</strong> and <strong>Group Policy Objects</strong>.</li>
<li><strong>Right</strong>-<strong>click</strong> the <strong>GPO</strong> that you created for the group policy settings and select <strong>Edit</strong>.</li>
<li>In the Group Policy Management Editor, <strong>navigate to Computer Configuration</strong> &gt; <strong>Preferences</strong>&gt; <strong>Windows Settings</strong> &gt; <strong>Registry</strong>.</li>
<li>Right-click in the window and select <strong>New</strong>, <strong>Registry Item</strong></li>
<li>Select <strong>Update</strong> as the Action</li>
<li>Make sure <strong>HKEY_LOCAL_MACHINE</strong> is set to <strong>Hive</strong></li>
<li>Enter in the following for the Key Path: <strong>SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy</strong></li>
<li>For the Value name type: <strong>DeleteUserAppContainersOnLogoff</strong></li>
<li>Change the Value type to <strong>REG_DWORD</strong></li>
<li>Put: &#x27;<strong>1</strong>&#x27; to enable the option and click <strong>Apply</strong></li>
<li><strong>Close</strong> the <strong>Group Policy Management console</strong>. As this is a Computer-based policy, it may take up to 90 minutes to take effect unless the session hosts are restarted to force it to pick up the policy sooner.</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Delete user Apps" src="/assets/images/deleteuserapp-a0c4502573171f9f13ca6e1aafa9e644.png" width="396" height="452" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-rdp-shortpath">Configure RDP Shortpath<a href="#configure-rdp-shortpath" class="hash-link" aria-label="Direct link to Configure RDP Shortpath" title="Direct link to Configure RDP Shortpath">​</a></h3>
<p>RDP Shortpath is a feature of Azure Virtual Desktop that establishes a direct UDP-based transport between Remote Desktop Client and Session host. RDP uses this transport to deliver Remote Desktop and RemoteApp while offering better reliability and consistent latency. RDP Shortpath establishes the direct connectivity between Remote Desktop client and Session Host. Direct connectivity reduces the dependency on the Azure Virtual Desktop gateways, improves the connection&#x27;s reliability, and increases the bandwidth available for each user session. You can read more about it here: <a href="https://learn.microsoft.com/en-us/azure/virtual-desktop/shortpath?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer" title="Azure Virtual Desktop RDP Shortpath">Azure Virtual Desktop RDP Shortpath</a>.</p>
<ol>
<li>On a server with the Group Policy Management Console is installed for managing your Azure Virtual Desktop farm, <strong>open</strong> the <strong>Group Policy Management Console</strong>.</li>
<li><strong>Expand</strong> your <strong>domain</strong> and <strong>Group Policy Objects</strong>.</li>
<li><strong>Right</strong>-<strong>click</strong> the <strong>GPO</strong> that you created for the group policy settings and select <strong>Edit</strong>.</li>
<li>In the Group Policy Management Editor, <strong>navigate to Computer Configuration</strong> &gt; <strong>Preferences</strong>&gt; <strong>Windows Settings</strong> &gt; <strong>Registry</strong>.</li>
<li>Right-click in the window and select <strong>New</strong>, <strong>Registry Item</strong></li>
<li>Select <strong>Update</strong> as the Action</li>
<li>Make sure <strong>HKEY_LOCAL_MACHINE</strong> is set to <strong>Hive</strong></li>
<li>Enter in the following for the Key Path: <strong>SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations</strong></li>
<li>For the Value name type: <strong>fUseUdpPortRedirector</strong></li>
<li>Change the Value type to <strong>REG_DWORD</strong></li>
<li>Put: &#x27;<strong>1</strong>&#x27; to enable the option and click <strong>Apply</strong></li>
<li>Right-click in the window and select <strong>New</strong>, <strong>Registry Item</strong></li>
<li>Select <strong>Update</strong> as the Action</li>
<li>Make sure <strong>HKEY_LOCAL_MACHINE</strong> is set to <strong>Hive</strong></li>
<li>Enter in the following for the Key Path: <strong>SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations</strong></li>
<li>For the Value name type: <strong>UdpPortNumber</strong></li>
<li>Change the Value type to <strong>REG_DWORD</strong></li>
<li>Put: &#x27;<strong>3390</strong>&#x27; as the UDP report and click <strong>Apply</strong></li>
<li><strong>Close</strong> the <strong>Group Policy Management console</strong>. Restart the session hosts.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="virtual-desktop-optimization-tool">Virtual-Desktop-Optimization-Tool<a href="#virtual-desktop-optimization-tool" class="hash-link" aria-label="Direct link to Virtual-Desktop-Optimization-Tool" title="Direct link to Virtual-Desktop-Optimization-Tool">​</a></h3>
<p>Automatically apply a range of optimisations for pooled and personal Azure Desktop hosts, this is a good resource to add to your initial image creation builds.</p>
<p><a href="https://github.com/The-Virtual-Desktop-Team/Virtual-Desktop-Optimization-Tool" target="_blank" rel="noopener noreferrer" title="Virtual-Desktop-Optimization-Tool">Virtual-Desktop-Optimization-Tool</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="implement-windows-defender-fslogix-exclusions">Implement Windows Defender FSLogix exclusions<a href="#implement-windows-defender-fslogix-exclusions" class="hash-link" aria-label="Direct link to Implement Windows Defender FSLogix exclusions" title="Direct link to Implement Windows Defender FSLogix exclusions">​</a></h3>
<p>Make sure to configure antivirus exclusions for FSLogix Profiles.</p>
<p>For a list of exclusions, along with a PowerShell script to implement them, please refer to the following Microsoft documentation: <a href="https://learn.microsoft.com/en-us/azure/architecture/example-scenario/wvd/windows-virtual-desktop-fslogix?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer" title="FSLogix for the enterprise">FSLogix for the enterprise</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="implement-fslogix-profile-exclusions">Implement FSLogix Profile Exclusions<a href="#implement-fslogix-profile-exclusions" class="hash-link" aria-label="Direct link to Implement FSLogix Profile Exclusions" title="Direct link to Implement FSLogix Profile Exclusions">​</a></h3>
<p>By default, FSLogix will capture a lot of user profile data, including Teams Cache, Chrome cache and save it to the profile VHD/VHDX; this causes profile size bloat and can decrease the performance of your applications.</p>
<p>It is recommended to implement exclusions to reduce storing user profile data that you don&#x27;t need.</p>
<ol>
<li>On a server with the Group Policy Management Console is installed for managing your Azure Virtual Desktop farm, <strong>open</strong> the <strong>Group Policy Management Console</strong>.</li>
<li><strong>Expand</strong> your <strong>domain</strong> and <strong>Group Policy Objects</strong>.</li>
<li><strong>Right</strong>-<strong>click</strong> the <strong>GPO</strong> that you created for the group policy settings and select <strong>Edit</strong>.</li>
<li>In the Group Policy Management Editor, <strong>navigate to Computer Configuration</strong> &gt; <strong>Policies</strong> &gt; <strong>Administrative Templates</strong> &gt; <strong>FSLogix</strong> &gt; <strong>Profile Containers</strong> &gt; <strong>Advanced</strong></li>
<li><strong>Enable</strong> the setting <strong>Provide RedirXML file to customize directions</strong>.</li>
<li>Point the path to a <strong>UNC path</strong> that is <strong>accessible</strong> to all session hosts that <strong>contains</strong> are &#x27;<strong>redirections.xml</strong>&#x27; file. This just needs the folder; it will automatically pick up the redirections.xml file.</li>
<li><strong>Close</strong> the <strong>Group Policy Management console</strong>. As this is a Computer-based policy, it may take up to 90 minutes to take effect unless the session hosts are restarted to force it to pick up the policy sooner.</li>
</ol>
<p>An example redirections.xml can be found here:</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_OeMC">redirections.xml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token prolog" style="color:rgb(189, 147, 249)">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">FrxProfileFolderRedirection</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">ExcludeCommonFolders</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">0</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Excludes</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">AppData\Local\Google\Chrome\User Data\Default\Cache\</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">AppData\Local\Google\Chrome\User Data\Default\Cached Theme Images\</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">AppData\Roaming\Google\Chrome\UserData\Default\Code Cache\js</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">AppData\Local\Google\Chrome\UserData\Default\Code Cache\js</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">AppData\Local\Mozilla\Firefox</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">Copy</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">0</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">AppData\Local\Microsoft\Terminal Server Client</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">Copy</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">0</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">AppData\Local\Microsoft\Edge SxS\User Data\Default\Cache</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">AppData\Roaming\Adobe\Flash Player\AssetCache</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">AppData\Roaming\Adobe\Flash Player\NativeCache</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">AppData\Roaming\Microsoft\Teams\Cache</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">AppData\Roaming\Microsoft\Teams\Service Worker\CacheStorage</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">Desktop</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">Documents</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">Downloads</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">Musics</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">Pictures</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">Videos</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Exclude</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Excludes</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Includes</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Include</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">Copy</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">3</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">AppData\LocalLow\Sun\Java\Deployment\security</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Include</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Include</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">AppData\Roaming\Google\Chrome\User Data\Default\Extensions</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Include</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Includes</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">FrxProfileFolderRedirection</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p><em>Note: Make sure you test and adjust this for your own environment. The Desktop/Documents have been excluded as the assumption is these are redirected or covered by OneDrive.</em></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="deleteuserappcontainersonlogoff-1">DeleteUserAppContainersOnLogoff<a href="#deleteuserappcontainersonlogoff-1" class="hash-link" aria-label="Direct link to DeleteUserAppContainersOnLogoff" title="Direct link to DeleteUserAppContainersOnLogoff">​</a></h3>
<p>Back in March 2019, there were issues with slow server performance caused by numerous Windows Firewall Rules getting created on user login. A patch was released; however, to enable this &#x27;<em>fix</em>&#x27;, a registry key needs to be set. You could eventually run into host performance/hang issues if this key is not configured. See: <a href="https://support.microsoft.com/en-us/help/4490481" target="_blank" rel="noopener noreferrer" title="https://support.microsoft.com/en-us/help/4490481">https://support.microsoft.com/en-us/help/4490481</a></p>
<ol>
<li>On a server with the Group Policy Management Console is installed for managing your Azure Virtual Desktop farm, <strong>open</strong> the <strong>Group Policy Management Console</strong>.</li>
<li><strong>Expand</strong> your <strong>domain</strong> and <strong>Group Policy Objects</strong>.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="implement-storage-sense">Implement Storage Sense<a href="#implement-storage-sense" class="hash-link" aria-label="Direct link to Implement Storage Sense" title="Direct link to Implement Storage Sense">​</a></h3>
<p>On Windows 10, Storage sense is a built-in tool designed to free up space automatically. When it&#x27;s enabled, the feature monitors your device. When it&#x27;s running low on space, it deletes temporary files, empties the Recycle Bin, cleans up the Downloads folder, removes previous installation files, and more to make space to install new updates or store more important data. Storage Sense can also help dehydrate files that are available locally and do not need to be stored locally anymore, helping to reduce profile space and OneDrive processing.</p>
<p><em>Note: If you find that Storage Sense is missing, it is because it is mainly a client setting and may be missing from the Windows Server; you can copy the PolicyDefinitions folder from an Azure Virtual Desktop host to your domains Central Store, i.e. in my case \\luke.geek.nz\SYSVOL\luke.geek.nz\Policies\PolicyDefinitions. Or just look for StorageSense.admx and StorageSense.adml and copy it (the ADML goes in the language directory, i.e. en-US).</em></p>
<ol>
<li>On a server with the Group Policy Management Console is installed for managing your Azure Virtual Desktop farm, <strong>open</strong> the <strong>Group Policy Management Console</strong>.</li>
<li><strong>Expand</strong> your <strong>domain</strong> and <strong>Group Policy Objects</strong>.</li>
<li><strong>Right</strong>-<strong>click</strong> the <strong>GPO</strong> that you created for the group policy settings and select <strong>Edit</strong>.</li>
<li>In the Group Policy Management Editor, <strong>navigate to Computer Configuration</strong> &gt; <strong>Policies</strong> &gt; <strong>Administrative Templates</strong> &gt; <strong>System</strong> &gt; <strong>Storage Sense</strong>.</li>
<li><strong>Enable</strong> the setting <strong>Allow Storage Sense</strong>.</li>
<li><strong>Enable</strong> the setting <strong>Configure Storage Sense Cloud Content dehydration threshold</strong></li>
<li>Now we can provide the minimum number of days a cloud-backed file can remain unopened before Storage Sense dehydrates it back to Files on Demand, for example, <strong>30</strong> days since it was last accessed.</li>
<li><strong>Enable</strong> the setting <strong>Configure Storage Storage Downloads cleanup threshold</strong></li>
<li><strong>Type</strong> in a minimum number of <strong>days</strong>, that files sit in the Downloads before before Storage sense will delete it.</li>
<li><strong>Close</strong> the <strong>Group Policy Management console</strong>. As this is a Computer-based policy, it may take up to 90 minutes to take effect unless the session hosts are restarted to force it to pick up the policy sooner.</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Storage Sense - Group Policy" src="/assets/images/storagesense_gpo-d9f1fe1587d3ad83fec68b801a49673d.png" title="Storage Sense - Group Policy" width="1534" height="901" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-microsoft-teams-optimisations">Configure Microsoft Teams Optimisations<a href="#configure-microsoft-teams-optimisations" class="hash-link" aria-label="Direct link to Configure Microsoft Teams Optimisations" title="Direct link to Configure Microsoft Teams Optimisations">​</a></h3>
<p>You can run Microsoft Teams in Azure Virtual Desktop. To do so, you need to install as a Machine installer and set the WVD environment variable.</p>
<p><strong>Install as Machine:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">msiexec /i Teams_windows_x64 /l*v teams_install.log ALLUSER=1</span><br></span></code></pre></div></div>
<p><strong>Set IsWVDEnvironment key</strong>:</p>
<ol>
<li>On a server with the Group Policy Management Console is installed for managing your Azure Virtual Desktop farm, <strong>open</strong> the <strong>Group Policy Management Console</strong>.</li>
<li><strong>Expand</strong> your <strong>domain</strong> and <strong>Group Policy Objects</strong>.</li>
<li><strong>Right</strong>-<strong>click</strong> the <strong>GPO</strong> that you created for the group policy settings and select <strong>Edit</strong>.</li>
<li>In the Group Policy Management Editor, <strong>navigate to Computer Configuration</strong> &gt; <strong>Preferences</strong>&gt; <strong>Windows Settings</strong> &gt; <strong>Registry</strong>.</li>
<li>Right-click in the window and select <strong>New</strong>, <strong>Registry Item</strong></li>
<li>Select <strong>Update</strong> as the Action</li>
<li>Make sure <strong>HKEY_LOCAL_MACHINE</strong> is set to <strong>Hive</strong></li>
<li>Enter in the following for the Key Path: <strong>SOFTWARE\Microsoft\Teams</strong></li>
<li>For the Value name type: <strong>IsWVDEnvironment</strong></li>
<li>Change the Value type to <strong>REG_DWORD</strong></li>
<li>Put: &#x27;<strong>1</strong>&#x27; to enable the option and click <strong>Apply</strong></li>
<li><strong>Close</strong> the <strong>Group Policy Management console</strong>. Restart the session hosts.</li>
</ol>
<p><strong>Install the Remote Desktop WebRTC Redirector</strong></p>
<ol>
<li>The Remote Desktop WebRTC Redirector onto the Sessions Hosts: <a href="https://learn.microsoft.com/en-us/azure/virtual-desktop/teams-on-AVD#install-the-teams-websocket-service" target="_blank" rel="noopener noreferrer" title="hhttps://learn.microsoft.com/en-us/azure/virtual-desktop/teams-on-AVD?WT.mc_id=AZ-MVP-5004796#install-the-teams-websocket-service">https://learn.microsoft.com/en-us/azure/virtual-desktop/teams-on-AVD#install-the-teams-websocket-service</a></li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-auto-close-apps-on-logoff">Configure Auto Close Apps on Logoff<a href="#configure-auto-close-apps-on-logoff" class="hash-link" aria-label="Direct link to Configure Auto Close Apps on Logoff" title="Direct link to Configure Auto Close Apps on Logoff">​</a></h3>
<p>When users may go to logoff, open applications may halt or prolong the logoff process and prompts for users to close applications, this can leave to sessions being left connected, if a user hits logoff or shutdown and walks away. To stop the prompt about open Applications we need to set a registry key - this is not an &#x27;optimisation&#x27; to be treated lightly, as it won&#x27;t ask users to double check some of the apps they have open, as soon as they hit the logoff button - that it is, any open apps will be closed!</p>
<ol>
<li>On a server with the Group Policy Management Console is installed for managing your Azure Virtual Desktop farm, <strong>open</strong> the <strong>Group Policy Management Console</strong>.</li>
<li><strong>Expand</strong> your <strong>domain</strong> and <strong>Group Policy Objects</strong>.</li>
<li><strong>Right</strong>-<strong>click</strong> the <strong>GPO</strong> that you created for the group policy settings and select <strong>Edit</strong>.</li>
<li>In the Group Policy Management Editor, <strong>navigate to User Configuration</strong> &gt; <strong>Preferences</strong>&gt; <strong>Windows Settings</strong> &gt; <strong>Registry</strong>.</li>
<li>Right-click in the window and select <strong>New</strong>, <strong>Registry Item</strong></li>
<li>Select <strong>Update</strong> as the Action</li>
<li>Make sure <strong>HKEY_CURRENT_USER</strong> is set to <strong>Hive</strong></li>
<li>Enter in the following for the Key Path: <strong>Control Panel\Desktop</strong></li>
<li>For the Value name type: <strong>AutoEndTasks</strong></li>
<li>Change the Value type to <strong>REG_SZ</strong></li>
<li>Put: &#x27;<strong>1</strong>&#x27; to enable the option and click <strong>Apply</strong></li>
<li><strong>Close</strong> the <strong>Group Policy Management console</strong>. Restart the session hosts.</li>
</ol>
<p>This is a user-based policy, so will take effect on next logon.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hide-the-shutdown-button">Hide the Shutdown button<a href="#hide-the-shutdown-button" class="hash-link" aria-label="Direct link to Hide the Shutdown button" title="Direct link to Hide the Shutdown button">​</a></h3>
<p>This is not so much of an optimization, but it is one of my favourite group policy configurations, something I implement in server base policies; it prevents that &quot;Oops!&quot; moment when someone clicks Shutdown on a server, especially with multi-session VDI machines, this just removes the shortcuts to shutdown and restart the server from the Start Menu.</p>
<p><em>Note: You can still restart and shut down the server from the Command Prompt with the &#x27;shutdown&#x27; command.</em></p>
<ol>
<li>On a server with the Group Policy Management Console is installed for managing your Azure Virtual Desktop farm, <strong>open</strong> the <strong>Group Policy Management Console</strong>.</li>
<li><strong>Expand</strong> your <strong>domain</strong> and <strong>Group Policy Objects</strong>.</li>
<li><strong>Right</strong>-<strong>click</strong> the <strong>GPO</strong> that you created for the group policy settings and select <strong>Edit</strong>.</li>
<li>In the Group Policy Management Editor, <strong>navigate to User Configuration</strong> &gt; <strong>Policies</strong> &gt; <strong>Administrative Templates</strong> &gt; <strong>Start Menu and Taskbar</strong></li>
<li><strong>Enable</strong> the setting <strong>Remove and prevent access to Shut Down, Restart, Sleep, and Hibernate commands.</strong></li>
<li><strong>Close</strong> the <strong>Group Policy Management console</strong>; as this is a User-based policy, it should take effect on the next user login.</li>
</ol></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/azure/how-to-setup-fslogix-profiles-for-azure-virtual-desktop/">How to setup FSLogix profiles for Azure Virtual Desktop</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-06-29T00:00:00.000Z">June 29, 2021</time> · <!-- -->10 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Luke Murray</span></a></div><small class="authorTitle_nd0D" title="Author">Author</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>If you have a few Azure Virtual Desktop machines, you need some way to keep user persistence&#x27;s and application customisations, which would usually be stored in the user profile locally across multiple machines <em>(or even the same machine if using Ephemeral OS)</em>, this is where FSLogix Profile Containers can assist.</p>
<p>We are going to implement FSLogix using an Azure File Share, to store the profiles.</p>
<p>I am going to assume you already have an Azure Virtual Desktop farm <em>(and Azure ADDS)</em>, if not you can check out my guide <a href="https://luke.geek.nz/azure/create-a-azure-virtual-desktop-farm/" target="_blank" rel="noopener noreferrer" title="How to create a Azure Virtual Desktop farm ">here</a>.</p>
<p>This article will be based on the Azure Virtual Desktop farm created in a previous article, however, you can just still along and replace the resource names and groups with your own.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="setup-storage-account">Setup Storage Account<a href="#setup-storage-account" class="hash-link" aria-label="Direct link to Setup Storage Account" title="Direct link to Setup Storage Account">​</a></h3>
<ol>
<li>Log in to the <strong>Azure Portal</strong></li>
<li>Click on <strong>Create a resource</strong></li>
<li>Type in <strong>Storage Account</strong> and press Enter to search</li>
<li>Select Storage account</li>
<li><img decoding="async" loading="lazy" alt="FSLogix - Azure Storage Account" src="/assets/images/storageaccount-2801dccd641138f94c83c89ae389a5c5.png" title="FSLogix - Azure Storage Account" width="998" height="360" class="img_ev3q"></li>
<li>Click <strong>Create</strong></li>
<li>If you already have a Resource Group, then <strong>select</strong> it, if not you can create a new <strong>resource group</strong>. I am going to put my resources user profiles in the same resource group as my utility server: aad_infra <em>(this is just personal preference, keeping the session hosts in their own resource groups)</em>.</li>
<li><strong>Type in</strong> a Storage <strong>Account Name</strong> <em>(the name needs to be globally unique across all of Azure, the field can contain only lowercase letters and numbers. Name must be between 3 and 24 characters.)</em>, in my case I have gone with: fslogixprofileslgnz.</li>
<li><strong>Select</strong> your <strong>Region</strong> <em>(the same region you have your Azure Virtual Desktop session hosts and Virtual Network)</em></li>
<li><strong>Select</strong> Standard <strong>performance</strong> <em>(Microsoft have recommendations, based on users on what Tier to select -</em> <a href="https://learn.microsoft.com/en-us/azure/virtual-desktop/store-fslogix-profile?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer" title="https://learn.microsoft.com/en-us/azure/virtual-desktop/store-fslogix-profile?WT.mc_id=AZ-MVP-5004796"><em>https://learn.microsoft.com/en-us/azure/virtual-desktop/store-fslogix-profile</em></a><em>)</em></li>
<li>For Redundancy, I am going to <strong>select LRS</strong> storage <em>(I haven&#x27;t built have any redundancy in my Azure Virtual Desktop farm)</em>.</li>
<li><em>Note: Just a heads up, don&#x27;t select Geo-Redundant if you are looking to create File Shares on this Storage account over 100TiB, it is only supported in LRS. If you do need this kind of large file size, I recommend using a completely different storage account from the one you are using for user profiles. My screenshot below has GRS, just ignore it!</em></li>
<li><img decoding="async" loading="lazy" alt="FSLogix - Azure Storage Account" src="/assets/images/storageaccount_projectdetails-839ccecc467cdf1704c728f298727e9a.png" title="FSLogix - Azure Storage Account" width="769" height="552" class="img_ev3q"></li>
<li>Click <strong>Next: Advanced</strong></li>
<li>Leave everything as default and <strong>select Next: Networking</strong></li>
<li>Now we need to configure a Private Endpoint for the Azure storage account to add onto the Virtual Network directly.</li>
<li>Select <strong>Private endpoint</strong> and click <strong>+ Add Private endpoint</strong></li>
<li><strong>Verify</strong> that your <strong>Location</strong> is <strong>correct</strong> and <strong>type</strong> in a <strong>Name for</strong> your <strong>Private Endpoint</strong> service, in my case: fslogixprofileslgnzPE</li>
<li><strong>Select</strong> the drop-down for <strong>Storage sub-resource</strong> and select <strong>file</strong></li>
<li><strong>Select</strong> your <strong>Virtual Network</strong> and <strong>subnet</strong> <em>(I will be selecting my main resource subnet of aadds-subnet, where the Azure Virtual Desktop hosts are)</em></li>
<li>Click <strong>Ok</strong></li>
<li><img decoding="async" loading="lazy" alt="FSLogix - Azure Storage Account" src="/assets/images/storageaccount_privateendpoint-57650fe4060dc07aa1150353bed7248f.png" title="FSLogix - Azure Storage Account" width="1671" height="717" class="img_ev3q"></li>
<li>Select <strong>Next: Data Protection</strong></li>
<li><strong>Untick</strong> the <strong>Enable soft delete for Blogs and Container&#x27;s</strong> <em>(we will only be using Azure Files in this storage account)</em></li>
<li>Soft delete allows you to quickly recover a deleted file-share, even though we can backup the Azure Fileshare, my recommendation would be to leave this on for additional protection and &#x27;7&#x27; days is enough for me.</li>
<li><img decoding="async" loading="lazy" alt="FSLogix - Azure Storage Account" src="/assets/images/storageaccount_softdelete-f99ec396a4d126592b3bdd9cce89eedb.png" title="FSLogix - Azure Storage Account" width="753" height="689" class="img_ev3q"></li>
<li>Select <strong>Review + Create</strong></li>
<li><strong>Validate</strong> your <strong>configuration</strong> and select <strong>Create</strong></li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-storage-account">Configure Storage Account<a href="#configure-storage-account" class="hash-link" aria-label="Direct link to Configure Storage Account" title="Direct link to Configure Storage Account">​</a></h3>
<ol>
<li>
<p>Once your storage account has been created, go to it.</p>
</li>
<li>
<p>Navigate down the left-hand side Blade and select: <strong>Networking</strong></p>
<p>Make sure: Selected networks are selected and the Private Endpoint connection is displaying.</p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="FSLogix - Azure Storage Account" src="/assets/images/storageaccount_firewalls-dd944f693e41a8503e0566839495faad.png" title="FSLogix - Azure Storage Account" width="653" height="310" class="img_ev3q"></p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="FSLogix - Azure Storage Account" src="/assets/images/storageaccount_peapproved-6debcc29f48cc0a69fc6c792153764e8.png" title="FSLogix - Azure Storage Account" width="974" height="191" class="img_ev3q"></p>
</li>
<li>
<p>Now its time to join the Storage account to Microsoft Entra ID Domain Services, on the left-hand side Blade, click on <strong>Configuration</strong> <em>(under Settings)</em></p>
</li>
<li>
<p>Navigate to: <strong>Identity-based access for file shares</strong></p>
</li>
<li>
<p>Select <strong>Enabled</strong></p>
</li>
<li>
<p>Click <strong>Save</strong></p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="FSLogix - Azure Storage Account" src="/assets/images/storageaccount_adds_identity-fe967979aade968af246f28cd5978a5d.png" title="FSLogix - Azure Storage Account" width="632" height="612" class="img_ev3q"></p>
</li>
<li>
<p>Now its time to create the File Share, On the left-hand side Blade, navigate to <strong>File Shares</strong> (under Data Storage)</p>
</li>
<li>
<p>Select <strong>+ File Share</strong></p>
</li>
<li>
<p>Give this <strong>File share</strong> a <strong>name</strong>: fslogixprofiles</p>
</li>
<li>
<p>Even though you don&#x27;t need to have a Quota <em>(the Fileshare will grow)</em>, I will add one in stop any surprises and make sure that I have an ongoing task to review and optimize the profiles</p>
</li>
<li>
<p>Because user profiles are generally a lot of read/write activity, select <strong>Transaction Optimized</strong> <em>(take a look at the</em> <a href="https://azure.microsoft.com/en-us/pricing/details/storage/files/?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer" title="https://azure.microsoft.com/en-us/pricing/details/storage/files/?WT.mc_id=AZ-MVP-5004796"><em>https://azure.microsoft.com/en-us/pricing/details/storage/files/</em></a> <em>)</em></p>
</li>
<li>
<p>Click <strong>Create</strong></p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="FSLogix - File Share" src="/assets/images/storageaccount_newfileshare-95f161154ef1674774aa4a9c41b98da5.png" title="FSLogix - File Share" width="295" height="373" class="img_ev3q"></p>
</li>
<li>
<p>One last thing we can do on the Storage Account is <strong>enable backups</strong> for your <strong>Azure File Share</strong> - <a href="https://learn.microsoft.com/en-us/azure/backup/backup-afs?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer" title="https://learn.microsoft.com/en-us/azure/backup/backup-afs?WT.mc_id=AZ-MVP-5004796">https://learn.microsoft.com/en-us/azure/backup/backup-afs?WT.mc_id=AZ-MVP-5004796</a></p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-file-share">Configure File Share<a href="#configure-file-share" class="hash-link" aria-label="Direct link to Configure File Share" title="Direct link to Configure File Share">​</a></h3>
<p>Now that the Microsoft Entra ID rights have been assigned and the File Share has been created, we now need to set up the NTFS permissions on the FSLogix share.</p>
<ol>
<li>
<p>Navigate to <strong>File Shares</strong> <em>(under Data Storage)</em></p>
</li>
<li>
<p><strong>Click</strong> on <strong>your</strong> file-<strong>share</strong></p>
</li>
<li>
<p>Click on <strong>Properties</strong></p>
</li>
<li>
<p><strong>Copy</strong> the <strong>URL</strong></p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="FSLogix - File Share" src="/assets/images/storageaccount_fslogixprofiles-6e8f1169f72bacd246c5a3edf61c6729.png" title="FSLogix - File Share" width="761" height="578" class="img_ev3q"></p>
</li>
<li>
<p><strong>Remove http</strong> and replace the forward slashes with backslashes so it looks like this: \\fslogixprofileslgnz.file.core.windows.net\fslogixprofiles</p>
</li>
<li>
<p><strong>Using</strong> a <strong>user</strong> that is a <strong>member of</strong> the &#x27;<strong>AVD Admins&#x27;</strong> group and can <strong>log into</strong> the <strong>Azure Virtual Desktop</strong> farm <em>(it’s a good chance to test connectivity to the Storage account through the private endpoint from your Azure Virtual Desktop session host)</em></p>
</li>
<li>
<p>Open <strong>Computer</strong></p>
</li>
<li>
<p>Select the Computer Tab and select <strong>Map network drive</strong></p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="FSLogix - Mapped Drive" src="/assets/images/computermappeddrive-b6d4b059bbc60cae71cf413c53ed4a8b.png" title="FSLogix - Mapped Drive" width="420" height="184" class="img_ev3q"></p>
</li>
<li>
<p><strong>Select a drive letter</strong> that isn&#x27;t in use and paste in the <strong>UNC path</strong> created earlier <em>(step 6)</em>.</p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="FSLogix - Mapped Drive" src="/assets/images/computermappingdrive-643b7416f45e128e07e11d1d71ea851d.png" title="FSLogix - Mapped Drive" width="522" height="264" class="img_ev3q"></p>
</li>
<li>
<p>Hopefully, you should <strong>successfully</strong> have <strong>mapped</strong> a <strong>drive</strong>!</p>
</li>
<li>
<p>Once the drive is mapped, <strong>open</strong> up a <strong>Command Prompt</strong></p>
<p><em>Note: Don&#x27;t run the Command Prompt as Administrator, as this runs in a separate context and doesn&#x27;t have permissions to the mapped drive.</em></p>
</li>
<li>
<p><strong>Run</strong> the <strong>following command</strong> to <strong>set</strong> the necessary <strong>NTFS permissions</strong> <em>(change the Drive mapping and AVD Users group to your own group)</em>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">icacls z: /grant &quot;AVD Users&quot;:(M)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">icacls z: /grant &quot;Creator Owner&quot;:(OI)(CI)(IO)(M)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">icacls z: /remove &quot;Authenticated Users&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">icacls z: /remove &quot;Builtin\Users&quot;</span><br></span></code></pre></div></div>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="FSLogix - Security Permissions" src="/assets/images/setfslogixpermissions-68547b485f7bc90692b642b71edbde17.png" title="FSLogix - Security Permissions" width="932" height="473" class="img_ev3q"></p>
</li>
<li>
<p>The permissions should look similar to:</p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="FSLogix - Security Permissions" src="/assets/images/setfslogixpermissions2-f5d2a6470c03a6dc2c1fc2b73bd03eef.png" title="FSLogix - Security Permissions" width="729" height="218" class="img_ev3q"></p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-fslogix-policies">Configure FSLogix policies<a href="#configure-fslogix-policies" class="hash-link" aria-label="Direct link to Configure FSLogix policies" title="Direct link to Configure FSLogix policies">​</a></h3>
<p>Now that you have successfully created a Storage Account and granted it the proper permissions, we now need to configure Group Policy for FSLogix.</p>
<ol>
<li><strong>Connect to</strong> your Microsoft Entra ID <strong>Utility server</strong>, that has <strong>Group Policy management</strong> installed using an account in the: AAD DC Administrators group</li>
<li><strong>Download</strong> the latest <strong>FSLogix Agent</strong> - <a href="https://aka.ms/fslogix_download" target="_blank" rel="noopener noreferrer" title="https://aka.ms/fslogix_download?WT.mc_id=AZ-MVP-5004796">https://aka.ms/fslogix_download</a> onto the Utility server</li>
<li><strong>Extract</strong> the FSLogix agent <strong>zip</strong> file to a folder</li>
<li>Now we will <strong>create</strong> a <strong>Central Store</strong> to manage the Group Policy consistently</li>
<li>On your Utility server, browse to <strong>C:\Windows</strong> <em>(If you are primarily using Azure Virtual Desktop, it may be best to copy the PolicyDefinitions folder from an Azure Virtual Desktop session host to make sure you can edit all the latest Windows 10 policies)</em></li>
<li><strong>Copy</strong> the <strong>PolicyDefinitions</strong> folder</li>
<li>Copy <strong>the PolicyDefinitions</strong> folder to your <strong>Policies</strong> folder on your <strong>domain</strong>: \luke.geek.nz\SYSVOL\luke.geek.nz\Policies<br>
<em>(replace luke.geek.nz, with your ADDS DNS name)</em></li>
<li><img decoding="async" loading="lazy" alt="FSLogix - Group Policy" src="/assets/images/sysvolpolicies-f5f02ecdb5e5547339c11eb39f2021b8.png" title="FSLogix - Group Policy" width="554" height="230" class="img_ev3q"></li>
<li><strong>Go to</strong> your <strong>extracted</strong> FSLogix <strong>folder</strong> and <strong>copy</strong>:
<ul>
<li>fslogix.admx to: \luke.geek.nz\SYSVOL\luke.geek.nz\Policies\PolicyDefinitions\</li>
<li>fslogix.adml to: \luke.geek.nz\SYSVOL\luke.geek.nz\Policies\PolicyDefinitions\en-US\</li>
</ul>
</li>
<li>This will allow us to use Group Policy to manage FSLogix using Group Policy, <strong>Open Group Policy Management</strong></li>
<li><strong>Navigate</strong> to your <strong>Hosts OU</strong></li>
<li>Right-click the OU and select: <strong>Create a GPO in this domain, and Link it here…</strong></li>
<li>Name it according to your naming standards (this is a Computer-based policy) - in my example, I am using: AVD_ComputerPolicy</li>
<li>Click <strong>Ok</strong></li>
<li><img decoding="async" loading="lazy" alt="FSLogix - Group Policy" src="/assets/images/gpo_management_createpolicy-7658db17732ed0748448c741dcba3244.png" title="FSLogix - Group Policy" width="580" height="355" class="img_ev3q"></li>
<li>Right-click the GPO you have just created and select <strong>Edit…</strong></li>
<li>Because this is a Computer-based policy, to speed up processing, <strong>right-click</strong> the <strong>Policy heading</strong> and select <strong>Properties</strong></li>
<li>Tick: <strong>Disable User Configuration Settings</strong></li>
<li>Confirm that you want to do it and select <strong>Yes</strong></li>
<li>Click <strong>Apply</strong></li>
<li>While you have the screen open, <strong>click on</strong> <strong>Comment</strong>, and <strong>add</strong> in some <strong>details</strong> about the GPO for future reference then click <strong>Apply</strong> and <strong>Ok</strong></li>
<li><img decoding="async" loading="lazy" alt="FSLogix - Group Policy" src="/assets/images/gpo_avd_computerpolicy-013e44a036919779c77128f2dd3be4be.png" title="FSLogix - Group Policy" width="799" height="563" class="img_ev3q"></li>
<li>Now it&#x27;s time to actually configure the FSLogix Group Policy settings.</li>
<li><strong>Navigate</strong> to: Computer Configuration\Policies\Administrative Templates\FSLogix\<strong>Profile Containers</strong></li>
<li>Open up <strong>Enabled</strong> and select: <strong>Enabled</strong> and <strong>Apply</strong></li>
<li>Open: <strong>VHD Location</strong> and <strong>copy</strong> in your Profiles <strong>UNC share</strong> <em>(for example, mine is:</em> [<em>\\fslogixprofileslgnz.file.core.windows.net\fslogixprofiles)</em> click <strong>Ok</strong></li>
<li>Select: <strong>Delete local profile when FSLofix profile should apply</strong>, click <strong>Enabled</strong> and check to <strong>Delete local profile when FSLogix Profile should apply</strong> <em>(don&#x27;t blindly follow this, I am making the assumption this is a new farm, with no user-based profile stored on it. You may need to create a separate GPO to test this setting on, or you could lose valuable data)</em>.</li>
<li>Open: <strong>Set Outlook cached mode on successful container attach</strong> to <strong>Enabled</strong>.</li>
<li>Now in Group Policy Management console, click on <strong>Container and Directory Naming</strong> and select <strong>Virtual Disk type</strong></li>
<li>Click <strong>Enabled</strong> and change the Option to <strong>VHDX</strong>, click <strong>Ok</strong></li>
<li>Click on: <strong>Swap directory name components setting</strong> and click <strong>Enabled</strong>, <strong>check</strong> the s<strong>wap directory name components</strong> and click <strong>Apply</strong></li>
<li><strong>Restart</strong> the Azure Virtual Desktop <strong>session hosts</strong> to pick up the new policies.</li>
<li><strong>You have now set up FSLogix profiles! If you map the drive you should see your user profile folders!</strong></li>
<li><img decoding="async" loading="lazy" alt="FSLogix - Mapped Profiles" src="/assets/images/computermappingdrivelast-295af306bce86bb195f492335abb6f73.png" title="FSLogix - Mapped Profiles" width="753" height="346" class="img_ev3q"></li>
</ol></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/page/35/"><div class="pagination-nav__label">Newer entries</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/page/37/"><div class="pagination-nav__label">Older entries</div></a></nav></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 luke.geek.nz. Powered by coffee, clouds and hamsters on wheels!</div></div></div></footer></div>
</body>
</html>