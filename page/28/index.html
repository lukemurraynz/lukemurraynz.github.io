<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Lukes Tech Blog - Unleashing the power of the cloud and other technologies! | luke.geek.nz</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://luke.geek.nz/img/social-card.png"><meta data-rh="true" name="twitter:image" content="https://luke.geek.nz/img/social-card.png"><meta data-rh="true" property="og:url" content="https://luke.geek.nz/page/28/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="Lukes Tech Blog - Unleashing the power of the cloud and other technologies! | luke.geek.nz"><meta data-rh="true" name="description" content="Embark on a tech journey with Luke, a Microsoft Azure MVP, as he delves into the cutting-edge realm of Microsoft and Azure Cloud technologies. Explore, learn, and stay ahead in the dynamic world of cloud computing!"><meta data-rh="true" property="og:description" content="Embark on a tech journey with Luke, a Microsoft Azure MVP, as he delves into the cutting-edge realm of Microsoft and Azure Cloud technologies. Explore, learn, and stay ahead in the dynamic world of cloud computing!"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://luke.geek.nz/page/28/"><link data-rh="true" rel="alternate" href="https://luke.geek.nz/page/28/" hreflang="en"><link data-rh="true" rel="alternate" href="https://luke.geek.nz/page/28/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="luke.geek.nz RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="luke.geek.nz Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="luke.geek.nz JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0QDLBY7NNN"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0QDLBY7NNN",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.4a383e58.css">
<script src="/assets/js/runtime~main.3adabeb3.js" defer="defer"></script>
<script src="/assets/js/main.677f59ab.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#D3D3D3" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">Happy New Year! This is a redesign of my website, hopefully you like it!</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="luke.geek.nz" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="luke.geek.nz" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">luke.geek.nz</b></a><a class="navbar__item navbar__link" href="/Tags/">Tags</a><a class="navbar__item navbar__link" href="/Archive/">Blog Archive</a></div><div class="navbar__items navbar__items--right"><a href="https://twitter.com/lukemurraynz" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="X"><svg height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 8.586l4.293-4.293a1 1 0 011.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 011.414-1.414L10 8.586z" clip-rule="evenodd"/>
          </svg></a><a href="https://www.linkedin.com/in/ljmurray/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="LinkedIn"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/azure-email-communication-services/">Deploying and Testing Azure Email Communication Services</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/microsoft-copilot-azure-preview/">Microsoft Copilot for Azure - Preview</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/Azure-DevTest-Subscription-Considerations/">Azure Dev/Test Subscription considerations</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/Azure-Image-Builder-Build-Pipeline-with-Azure-DevOps/">Azure Image Builder Image Build with Bicep and Azure DevOps</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/misc/Book-Review-Azure-architecture-explained/">Book Review Azure Architecture Explained</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="Microsoft Azure has a good user portal where you can do most things, however"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/2018/06/10/Using PowerShell to connect to Azure/">Using PowerShell to connect to Microsoft Azure</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2018-06-10T00:00:00.000Z" itemprop="datePublished">June 10, 2018</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Luke Murray</span></a></div><small class="avatar__subtitle" itemprop="description">Author</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Microsoft Azure has a good user portal where you can do most things, however
when it comes to automation, gathering a lot of information at once and more
in-depth scenarios that the Portal doesn’t quite offer – PowerShell is used.</p>
<p>Before you can use PowerShell to connect to Microsoft Azure, you need to install
the Azure Resource Manager modules first – follow the guide below:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/powershell/azure/new-azureps-module-az?view=azps-7.5.0&amp;viewFallbackFrom=azps-5.7.0&amp;WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Install and configure Azure
PowerShell</a></li>
</ul>
<p><img loading="lazy" alt="Disable SMB1" src="/assets/images/InstallAzureRMModule-cdd7b327079e99ee7c8a9f167c67c779.gif" width="856" height="314" class="img_ev3q"></p>
<p>Once the Az modules has been installed – you can now connect to Azure.</p>
<p>Usually you would have to go through the process of logging in to Azure, finding
what subscription you need to connect to and then selecting that manually,
however I have created a little function that will connect to Azure and
automatically populate a list of the subscriptions that your account has access
to in a window which you can then select to connect to which makes the process
easier without having to remember different Azure subscription names or ids.
This function can easily be used in any environment. I have it loaded as part of
my PowerShell profile script so the function can be run from the second I open
up a new PowerShell prompt.</p>
<p><em>Note: Script is also hosted on my Github repository. Feel free to
clone/recommend improvements or fork.</em></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/power-shell/">PowerShell</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="On a computer running Windows 7 x64 SP1 Enterprise running Internet Explorer 11 browser, I had issues connecting to the console of Virtual Machines hosted by VMWare vCloud."><link itemprop="image" href="https://luke.geek.nz/wp-content/uploads/2016/12/123116_0852_StuckataBla1.jpg"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/2017/01/01/stuck-black-screen-connecting-vcloud-console/">Stuck at a Black Screen and Connecting on a vCloud console</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2017-01-01T00:00:00.000Z" itemprop="datePublished">January 1, 2017</time> · <!-- -->One min read</div></header><div class="markdown" itemprop="articleBody"><p>On a computer running Windows 7 x64 SP1 Enterprise running Internet Explorer 11 browser, I had issues connecting to the console of Virtual Machines hosted by VMWare vCloud.</p>
<img loading="lazy" class="alignnone img_ev3q" src="https://i1.wp.com/luke.geek.nz/wp-content/uploads/2016/12/123116_0852_StuckataBla1.jpg?resize=636%2C572&amp;ssl=1" alt="vCloud Console black screen" width="636" height="572" data-recalc-dims="1">
<p>This was resolved by completing the following:</p>
<ol>
<li>Adding the website to the Trusted Site list</li>
<li>Adding the website to Internet Explorer’s compatibility list</li>
<li>Updating Java on the workstation to the newest</li>
</ol></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/windows/">Windows</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="The Windows Performance Toolkit, developed by Microsoft has 3 separate tools and are key to solving a lot of boot and general performance issues:"><link itemprop="image" href="https://luke.geek.nz/wp-content/uploads/2016/12/122816_0751_Howtocaptur5.png"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/2016/12/28/capturing-windows-boot-performance-windows-performance-toolkit/">Capturing Windows boot performance with the Windows Performance Toolkit</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2016-12-28T00:00:00.000Z" itemprop="datePublished">December 28, 2016</time> · <!-- -->3 min read</div></header><div class="markdown" itemprop="articleBody"><p>The Windows Performance Toolkit, developed by Microsoft has 3 separate tools and are key to solving a lot of boot and general performance issues:</p>
<p>•    Windows Performance Recorder</p>
<p>•    Windows Performance Analyzer</p>
<p>•    Xperf</p>
<div id="toc_container" class="no_bullets">
  <p class="toc_title">
    Table of Contents
  </p>
  <ul class="toc_list">
    <li>
      <a href="#Download_Windows_Performance_Toolkit"><span class="toc_number toc_depth_1">1</span> Download Windows Performance Toolkit</a>
    </li>
    <li>
      <a href="#Run_Windows_Performance_Recorder"><span class="toc_number toc_depth_1">2</span> Run Windows Performance Recorder</a>
    </li>
    <li>
      <a href="#Run_Windows_Performance_Analyzer"><span class="toc_number toc_depth_1">3</span> Run Windows Performance Analyzer</a>
    </li>
    <li>
      <a href="#Useful_resources"><span class="toc_number toc_depth_1">4</span> Useful resources</a>
    </li>
  </ul>
</div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="download-windows-performance-toolkit"><span id="Download_Windows_Performance_Toolkit">Download Windows Performance Toolkit</span><a href="#download-windows-performance-toolkit" class="hash-link" aria-label="Direct link to download-windows-performance-toolkit" title="Direct link to download-windows-performance-toolkit">​</a></h3>
<p>This can be downloaded by going to the Microsoft website and looking for the latest Windows Assessment and Deployment Toolkit for the operating system you want to analyze – for example: Windows 10</p>
<p><a href="https://developer.microsoft.com/en-us/windows/hardware/windows-assessment-deployment-kit" target="_blank" rel="noopener noreferrer"></a><a href="https://developer.microsoft.com/en-us/windows/hardware/windows-assessment-deployment-kit" target="_blank" rel="noopener noreferrer">https://developer.microsoft.com/en-us/windows/hardware/windows-assessment-deployment-kit</a></p>
<p>Download and run, we only need the Windows Performance Toolkit portion of the ADK:</p>
<img loading="lazy" class="alignnone img_ev3q" src="https://i2.wp.com/luke.geek.nz/wp-content/uploads/2016/12/122816_0751_Howtocaptur1.png?resize=697%2C404&amp;ssl=1" alt="Windows Performance Toolkit" width="697" height="404" data-recalc-dims="1">
<p>Once installed navigate to: C:\Program Files (x86)\Windows Kits\10\Windows Performance Toolkit</p>
<p>Tip: You can copy the Redistributables folder if you need to install the Windows Performance Toolkit only on another computer.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="run-windows-performance-recorder"><span id="Run_Windows_Performance_Recorder">Run Windows Performance Recorder</span><a href="#run-windows-performance-recorder" class="hash-link" aria-label="Direct link to run-windows-performance-recorder" title="Direct link to run-windows-performance-recorder">​</a></h3>
<p>We only need too: WPRUI.EXE – Windows Performance Recorder &amp; WPA.EXE – Windows Performance Analyzer.</p>
<img loading="lazy" src="https://i0.wp.com/luke.geek.nz/wp-content/uploads/2016/12/122816_0751_Howtocaptur2.png?w=1500&amp;ssl=1" alt="" data-recalc-dims="1" class="img_ev3q">
<p>Run WPRUI to launch Windows Performance Recorder</p>
<p>Change the Performance Scenario to Boot, and File</p>
<p>Select Resource Analysis and click CPU usage</p>
<p><em>Tip: You can add more: File I/O, Networking I/O, GPU usage etc if you know what in particular may be causing your boot slowness, the more you add the more data and complexity is added. I would recommend to only add additional resource analytics when required.</em></p>
<img loading="lazy" class="alignnone img_ev3q" src="https://i0.wp.com/luke.geek.nz/wp-content/uploads/2016/12/122816_0751_Howtocaptur3.png?resize=659%2C518&amp;ssl=1" alt="Windows Performance Recorder" width="659" height="518" data-recalc-dims="1">
<p>Click Start to select where your boot traces will go and click Ok to start your boot traces, this will restart your computer 3 times.</p>
<p><em>Tip: If you need to login, please make sure you login quickly during each trace as the longer you leave it unattended the more data and delay it will collect.</em></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="run-windows-performance-analyzer"><span id="Run_Windows_Performance_Analyzer">Run Windows Performance Analyzer</span><a href="#run-windows-performance-analyzer" class="hash-link" aria-label="Direct link to run-windows-performance-analyzer" title="Direct link to run-windows-performance-analyzer">​</a></h3>
<p>Once the computer has been restarted 3 times and your traces have been complete navigate back to: C:\Program Files (x86)\Windows Kits\10\Windows Performance Toolkit and click on WPR.EXE to open the Windows Performance Analyzer or click Open in WPA from the Windows Performance Recorder dialog.</p>
<p>The Windows Performance Analyzer will be our canvas in analyzing issues, you can expand areas like System Activity to dig into Processes, Services. Just drag the data onto the Analysis screen to go through it</p>
<img loading="lazy" src="https://i1.wp.com/luke.geek.nz/wp-content/uploads/2016/12/122816_0751_Howtocaptur4.png?w=1500&amp;ssl=1" alt="" data-recalc-dims="1" class="img_ev3q">
<p>From here you can drill down into the data to find the cause or improvements for your login time, from here I can see one of the delays of my system is the CortanaUI.</p>
<p>I am running this on a 16GB i7 4GHZ machine running on an SSD so it isn’t really a good example, but have used this in the past to work out that my login was slow because Lync had logging turned on.</p>
<img loading="lazy" src="https://i0.wp.com/luke.geek.nz/wp-content/uploads/2016/12/122816_0751_Howtocaptur5.png?w=1500&amp;ssl=1" alt="" data-recalc-dims="1" class="img_ev3q">
<p>Hopefully this gets you through the first steps in diagnosis and resolving your performance issues.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="useful-resources"><span id="Useful_resources">Useful resources</span><a href="#useful-resources" class="hash-link" aria-label="Direct link to useful-resources" title="Direct link to useful-resources">​</a></h3>
<p>Troubleshooting Windows Internals when unexpected events happen – <a href="https://channel9.msdn.com/events/Ignite/New-Zealand-2016/M405" target="_blank" rel="noopener noreferrer"></a><a href="https://channel9.msdn.com/events/Ignite/New-Zealand-2016/M405" target="_blank" rel="noopener noreferrer">https://channel9.msdn.com/events/Ignite/New-Zealand-2016/M405</a></p>
<p>Investigating website performance with Windows Performance Toolkit – <a href="https://github.com/MicrosoftEdge/MicrosoftEdge-Documentation/tree/master/performance-analysis/windows-performance-toolkit" target="_blank" rel="noopener noreferrer"></a><a href="https://github.com/MicrosoftEdge/MicrosoftEdge-Documentation/tree/master/performance-analysis/windows-performance-toolkit" target="_blank" rel="noopener noreferrer">https://github.com/MicrosoftEdge/MicrosoftEdge-Documentation/tree/master/performance-analysis/windows-performance-toolkit</a></p>
<p>Slow Boot Slow Logon (SBSL), A Tool Called XPerf and Links You Need To Read – <a href="https://blogs.technet.microsoft.com/askpfeplat/2012/06/09/slow-boot-slow-logon-sbsl-a-tool-called-xperf-and-links-you-need-to-read/" target="_blank" rel="noopener noreferrer"></a><a href="https://blogs.technet.microsoft.com/askpfeplat/2012/06/09/slow-boot-slow-logon-sbsl-a-tool-called-xperf-and-links-you-need-to-read/" target="_blank" rel="noopener noreferrer">https://blogs.technet.microsoft.com/askpfeplat/2012/06/09/slow-boot-slow-logon-sbsl-a-tool-called-xperf-and-links-you-need-to-read/</a></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/windows/">Windows</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="&#x27;An error occurred while accessing the DHCP database.&#x27;"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/2016/12/28/database-error-making-changes-dhcp-reservations/">Database error when making changes to DHCP reservations</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2016-12-28T00:00:00.000Z" itemprop="datePublished">December 28, 2016</time> · <!-- -->One min read</div></header><div class="markdown" itemprop="articleBody"><p>&#x27;An error occurred while accessing the DHCP database.&#x27;</p>
<img loading="lazy" class="alignnone img_ev3q" src="https://i1.wp.com/luke.geek.nz/wp-content/uploads/2016/12/122816_0625_Databaseerr1.png?resize=515%2C179&amp;ssl=1" alt="an error occurred while accessing the DHCP database" width="515" height="179" data-recalc-dims="1">
<p>One of the issues I have ran into since an upgrade to Windows Server 2012 R2 DHCP servers – was due to multiple processes access the DHCP database when I was attempting to Create or Modify a DHCP v4 reservation.</p>
<ol>
<li>Adding an exclusion to DHCP.MDB file for Real Time scanning on my antivirus product.</li>
<li>Disabling the Windows indexing service from indexing the DHCP folder.</li>
</ol>
<p>To disable the Windows indexing service from indexing the DHCP server follow the quick steps below:</p>
<ol>
<li>Open Windows Explorer – or Computer: on the DHCP server</li>
<li>Navigate to: c:\Windows\System32\DHCP</li>
<li>Click on the General Tab up the top and click Advanced</li>
<li>Uncheck ‘For Fast Searching, Allow Indexing Service to Index this Folder.’</li>
<li>Click Ok</li>
</ol>
<p>Useful Resources:</p>
<p>Microsoft Anti-Virus Exclusion List – <a href="https://social.technet.microsoft.com/wiki/contents/articles/953.microsoft-anti-virus-exclusion-list.aspx?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer"></a><a href="https://social.technet.microsoft.com/wiki/contents/articles/953.microsoft-anti-virus-exclusion-list.aspx" target="_blank" rel="noopener noreferrer">https://social.technet.microsoft.com/wiki/contents/articles/953.microsoft-anti-virus-exclusion-list.aspx</a></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/windows/">Windows</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="Upgrading MDT (Microsoft Deployment Toolkit) is generally not an issue – the main points are:"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/2016/12/13/upgrade-mdt-2013-mdt-current-branch/">Upgrade MDT 2013 to MDT Current Branch</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2016-12-13T00:00:00.000Z" itemprop="datePublished">December 13, 2016</time> · <!-- -->5 min read</div></header><div class="markdown" itemprop="articleBody"><p>Upgrading MDT <em>(Microsoft Deployment Toolkit)</em> is generally not an issue – the main points are:</p>
<ul>
<li>Upgrade the Windows ADK before upgrading MDT.</li>
<li>Make sure you have a backup <em>(or can restore to a pre-upgraded MDT)</em> of the Deployment Share – the Upgrade will upgrade the schema of the MDT database – including allowing new ADK features for your Deployment Share.</li>
</ul>
<p>Now that we have a backup it is now time to go through the Windows ADK <em>(Windows Assessment and Deployment Kit)</em> upgrade on the MDT server and MDT current branch update. Follow the guide below to complete.</p>
<div id="toc_container" class="no_bullets">
  <p class="toc_title">
    Table of Contents
  </p>
  <ul class="toc_list">
    <li>
      <a href="#Upgrade_Windows_ADK"><span class="toc_number toc_depth_1">1</span> Upgrade Windows ADK</a>
    </li>
    <li>
      <a href="#Upgrade_MDT"><span class="toc_number toc_depth_1">2</span> Upgrade MDT</a>
    </li>
  </ul>
</div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade-windows-adk"><span id="Upgrade_Windows_ADK">Upgrade Windows ADK</span><a href="#upgrade-windows-adk" class="hash-link" aria-label="Direct link to upgrade-windows-adk" title="Direct link to upgrade-windows-adk">​</a></h2>
<p>I will be using Windows ADK for Windows 10, version 1607 in my example.</p>
<ol>
<li>Download the latest Windows ADK – <a href="https://developer.microsoft.com/en-us/windows/hardware/windows-assessment-deployment-kit" target="_blank" rel="noopener noreferrer"></a><a href="https://developer.microsoft.com/en-us/windows/hardware/windows-assessment-deployment-kit" target="_blank" rel="noopener noreferrer">https://developer.microsoft.com/en-us/windows/hardware/windows-assessment-deployment-kit</a> and save the setup file to your MDT server.</li>
</ol>
<img loading="lazy" class="alignnone img_ev3q" src="https://i0.wp.com/luke.geek.nz/wp-content/uploads/2016/12/121316_0538_UpgradeMDT21.png?resize=624%2C333" alt="Windows ADK" width="624" height="333" data-recalc-dims="1">
<ol>
<li>If you try to install the ADK without upgrading, you will get the following error:</li>
</ol>
<img loading="lazy" src="https://i0.wp.com/luke.geek.nz/wp-content/uploads/2016/12/121316_0538_UpgradeMDT22.png?w=1500" alt="" data-recalc-dims="1" class="img_ev3q">
<ol>
<li>So open Program and Features and select Windows Assessment and Deployment Kit – Windows 10 and select Uninstall to uninstall the old ADK (in this example I am uninstalling the v1511 Windows 10 ADK).</li>
</ol>
<img loading="lazy" src="https://i0.wp.com/luke.geek.nz/wp-content/uploads/2016/12/121316_0538_UpgradeMDT23.png?w=1500" alt="" data-recalc-dims="1" class="img_ev3q">
<ol>
<li>Select Yes to uninstall the Windows ADK and Close when the uninstall has been completed</li>
</ol>
<img loading="lazy" src="https://i0.wp.com/luke.geek.nz/wp-content/uploads/2016/12/121316_0538_UpgradeMDT24.png?w=1500" alt="" data-recalc-dims="1" class="img_ev3q">
<ol>
<li>Now that the old Windows ADK has been uninstalled you can now launch the new Windows ADK downloaded in Step 1 and make sure Install the Windows Assessment and Deployment Kit – Windows 10 to this computer is selected and the install path is correct and click Next</li>
</ol>
<img loading="lazy" src="https://i2.wp.com/luke.geek.nz/wp-content/uploads/2016/12/121316_0538_UpgradeMDT25.png?w=1500" alt="" data-recalc-dims="1" class="img_ev3q">
<ol start="6">
<li>You can either select Yes or No to allow Microsoft to collect usage data – I am just going to select No and click Next to proceed with the install</li>
</ol>
<img loading="lazy" src="https://i2.wp.com/luke.geek.nz/wp-content/uploads/2016/12/121316_0538_UpgradeMDT26.png?w=1500" alt="" data-recalc-dims="1" class="img_ev3q">
<ol start="7">
<li>
<p>Click Accept on the license agreement</p>
</li>
<li>
<p>You will now get greeted by a dialog for installing the features of the Windows ADK – you need: Deployment Tools, Windows Preinstallation Environment (Windows PE) and User State Migration Tool (USMT) and select Install</p>
</li>
</ol>
<img loading="lazy" class="alignnone img_ev3q" src="https://i2.wp.com/luke.geek.nz/wp-content/uploads/2016/12/121316_0538_UpgradeMDT27.png?resize=690%2C508" alt="Windows ADK" width="690" height="508" data-recalc-dims="1">
<ol start="9">
<li>Once the Windows Assessment and Deployment Kit installation has been completed, restart your MDT server (this is not required – but I prefer to do it to make sure any registered DLLs or registry changes have taken affect and it is in a clean state).</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade-mdt"><span id="Upgrade_MDT">Upgrade MDT</span><a href="#upgrade-mdt" class="hash-link" aria-label="Direct link to upgrade-mdt" title="Direct link to upgrade-mdt">​</a></h2>
<ol>
<li>Now that the Windows ADK has been updated – it is time to download the Microsoft Deployment Toolkit – <a href="https://www.microsoft.com/en-us/download/details.aspx?id=54259" target="_blank" rel="noopener noreferrer"></a><a href="https://www.microsoft.com/en-us/download/details.aspx?id=54259" target="_blank" rel="noopener noreferrer">https://www.microsoft.com/en-us/download/details.aspx?id=54259</a> by selecting Download</li>
</ol>
<img loading="lazy" class="alignnone img_ev3q" src="https://i0.wp.com/luke.geek.nz/wp-content/uploads/2016/12/121316_0538_UpgradeMDT28.png?resize=639%2C525" alt="MDT Download" width="639" height="525" data-recalc-dims="1">
<ol start="2">
<li>We are upgrading the x64 version so select this and click Next <em>(same process for x32 – just download that instead)</em>.</li>
</ol>
<p><img loading="lazy" src="https://i2.wp.com/luke.geek.nz/wp-content/uploads/2016/12/121316_0538_UpgradeMDT29.png?w=1500" alt="" data-recalc-dims="1" class="img_ev3q">12. Select Run to start the install</p>
<img loading="lazy" src="https://i1.wp.com/luke.geek.nz/wp-content/uploads/2016/12/121316_0538_UpgradeMDT210.png?w=1500" alt="" data-recalc-dims="1" class="img_ev3q">
<ol start="3">
<li>You will now have the Install Microsoft Deployment Toolkit Setup wizard – select Next to start the install</li>
</ol>
<img loading="lazy" class="alignnone img_ev3q" src="https://i1.wp.com/luke.geek.nz/wp-content/uploads/2016/12/121316_0538_UpgradeMDT211.png?resize=508%2C396" alt="MDT install" width="508" height="396" data-recalc-dims="1">
<ol start="4">
<li>Accept the License Agreement and select Next</li>
</ol>
<img loading="lazy" src="https://i0.wp.com/luke.geek.nz/wp-content/uploads/2016/12/121316_0538_UpgradeMDT212.png?w=1500" alt="" data-recalc-dims="1" class="img_ev3q">
<ol start="5">
<li>Make sure that Microsoft Deployment Toolkit – Documents and Tools and Templates are select and the install path is correct (matches your current MDT install) and click Next</li>
</ol>
<img loading="lazy" src="https://i2.wp.com/luke.geek.nz/wp-content/uploads/2016/12/121316_0538_UpgradeMDT213.png?w=1500" alt="" data-recalc-dims="1" class="img_ev3q">
<ol start="6">
<li>
<p>Select Yes or No to joining the Customer Experience Improvement Program and select Next</p>
</li>
<li>
<p>Finally – click Install to start the MDT install</p>
</li>
</ol>
<img loading="lazy" src="https://i2.wp.com/luke.geek.nz/wp-content/uploads/2016/12/121316_0538_UpgradeMDT214.png?w=1500" alt="" data-recalc-dims="1" class="img_ev3q">
<ol start="8">
<li>
<p>Once installed click Finish</p>
</li>
<li>
<p>Open the Deployment Workbench</p>
</li>
</ol>
<img loading="lazy" src="https://i1.wp.com/luke.geek.nz/wp-content/uploads/2016/12/121316_0538_UpgradeMDT215.png?w=1500" alt="" data-recalc-dims="1" class="img_ev3q">
<ol start="10">
<li>It should automatically have your Deployment Share listed under Deployment Shares – if you will need to click File, Add Deployment Share to add your deployment share. Right click your deployment share and select Upgrade Deployment Share</li>
</ol>
<img loading="lazy" class="alignnone img_ev3q" src="https://i2.wp.com/luke.geek.nz/wp-content/uploads/2016/12/121316_0538_UpgradeMDT216.png?resize=476%2C240" alt="Upgrade Deployment Share" width="476" height="240" data-recalc-dims="1">
<ol start="11">
<li>Verify that the information is correct and click Next to start the Upgrade</li>
</ol>
<img loading="lazy" src="https://i0.wp.com/luke.geek.nz/wp-content/uploads/2016/12/121316_0538_UpgradeMDT217.png?w=1500" alt="" data-recalc-dims="1" class="img_ev3q">
<ol start="12">
<li>This will start the upgrade of the Deployment Share</li>
</ol>
<img loading="lazy" src="https://i0.wp.com/luke.geek.nz/wp-content/uploads/2016/12/121316_0538_UpgradeMDT218.png?w=1500" alt="" data-recalc-dims="1" class="img_ev3q">
<ol start="13">
<li>
<p>Once the Upgrade of the Deployment Share has been completed – it is time to upgrade the Boot Image</p>
</li>
<li>
<p>Right click your Deployment Share again – and instead of Upgrade, there will be Update. Select Update Deployment Share</p>
</li>
</ol>
<img loading="lazy" src="https://i1.wp.com/luke.geek.nz/wp-content/uploads/2016/12/121316_0538_UpgradeMDT219.png?w=1500" alt="" data-recalc-dims="1" class="img_ev3q">
<ol start="15">
<li>You will be greeted by the Update Deployment Share Wizard – select completely regenerate the boot images and click Next</li>
</ol>
<img loading="lazy" class="alignnone img_ev3q" src="https://i1.wp.com/luke.geek.nz/wp-content/uploads/2016/12/121316_0538_UpgradeMDT220.png?resize=653%2C542" alt="Update Boot Image" width="653" height="542" data-recalc-dims="1">
<ol start="16">
<li>You will then be forwarded to a review page, verify the permissions are correct and click Next to start regenerating the boot images.</li>
</ol>
<img loading="lazy" src="https://i2.wp.com/luke.geek.nz/wp-content/uploads/2016/12/121316_0538_UpgradeMDT221.png?w=1500" alt="" data-recalc-dims="1" class="img_ev3q">
<ol start="17">
<li>Once completed you are finished. You have now hopefully successfully upgraded the ADK, MDT and Boot Images.</li>
</ol>
<img loading="lazy" src="https://i1.wp.com/luke.geek.nz/wp-content/uploads/2016/12/121316_0538_UpgradeMDT222.png?w=1500" alt="" data-recalc-dims="1" class="img_ev3q"></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/windows/">Windows</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/page/27/"><div class="pagination-nav__label">Newer Entries</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/page/29/"><div class="pagination-nav__label">Older Entries</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 luke.geek.nz. Powered by coffee, clouds and hamsters on wheels!</div></div></div></footer></div>
</body>
</html>