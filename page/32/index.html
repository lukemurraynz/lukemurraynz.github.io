<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Lukes Tech Blog - Unleashing the power of the cloud and other technologies! | luke.geek.nz</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://luke.geek.nz/img/social-card.png"><meta data-rh="true" name="twitter:image" content="https://luke.geek.nz/img/social-card.png"><meta data-rh="true" property="og:url" content="https://luke.geek.nz/page/32/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="Lukes Tech Blog - Unleashing the power of the cloud and other technologies! | luke.geek.nz"><meta data-rh="true" name="description" content="Embark on a tech journey with Luke, a Microsoft Azure MVP, as he delves into the cutting-edge realm of Microsoft and Azure Cloud technologies. Explore, learn, and stay ahead in the dynamic world of cloud computing!"><meta data-rh="true" property="og:description" content="Embark on a tech journey with Luke, a Microsoft Azure MVP, as he delves into the cutting-edge realm of Microsoft and Azure Cloud technologies. Explore, learn, and stay ahead in the dynamic world of cloud computing!"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://luke.geek.nz/page/32/"><link data-rh="true" rel="alternate" href="https://luke.geek.nz/page/32/" hreflang="en"><link data-rh="true" rel="alternate" href="https://luke.geek.nz/page/32/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://ZBH2T1WJQD-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"Blog","@id":"https://luke.geek.nz/page/32","mainEntityOfPage":"https://luke.geek.nz/page/32","headline":"Lukes Tech Blog - Unleashing the power of the cloud and other technologies!","description":"Embark on a tech journey with Luke, a Microsoft Azure MVP, as he delves into the cutting-edge realm of Microsoft and Azure Cloud technologies. Explore, learn, and stay ahead in the dynamic world of cloud computing!","blogPost":[{"@type":"BlogPosting","@id":"https://luke.geek.nz/2021/07/13/validate-that-your-azure-resources-are-deployed-per-the-well-architected-framework","mainEntityOfPage":"https://luke.geek.nz/2021/07/13/validate-that-your-azure-resources-are-deployed-per-the-well-architected-framework","url":"https://luke.geek.nz/2021/07/13/validate-that-your-azure-resources-are-deployed-per-the-well-architected-framework","headline":"Well-Architected Framework Azure infrastructure review with PSRule for Azure","name":"Well-Architected Framework Azure infrastructure review with PSRule for Azure","description":"Imagine if you could validate that your Azure Resources are deployed per the Well-Architected Framework (WAF).. just imagine!","datePublished":"2021-07-13T00:00:00.000Z","author":{"@type":"Person","name":"Luke Murray","description":"Author","url":"https://luke.geek.nz","image":"https://luke.geek.nz/img/logo.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://luke.geek.nz/2021/07/10/configure-azure-virtual-desktop-monitoring-insights","mainEntityOfPage":"https://luke.geek.nz/2021/07/10/configure-azure-virtual-desktop-monitoring-insights","url":"https://luke.geek.nz/2021/07/10/configure-azure-virtual-desktop-monitoring-insights","headline":"Configure Azure Virtual Desktop Monitoring Insights","name":"Configure Azure Virtual Desktop Monitoring Insights","description":"Microsoft has now added a built-in Monitoring workbook for Azure Virtual Desktop performance monitoring; this monitoring includes dashboards related (but not limited to):","datePublished":"2021-07-10T00:00:00.000Z","author":{"@type":"Person","name":"Luke Murray","description":"Author","url":"https://luke.geek.nz","image":"https://luke.geek.nz/img/logo.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://luke.geek.nz/2021/07/10/how-to-create-a-free-log-analytics-workspace","mainEntityOfPage":"https://luke.geek.nz/2021/07/10/how-to-create-a-free-log-analytics-workspace","url":"https://luke.geek.nz/2021/07/10/how-to-create-a-free-log-analytics-workspace","headline":"How to create a Free Azure Log Analytics Workspace using PowerShell","name":"How to create a Free Azure Log Analytics Workspace using PowerShell","description":"When you create a Log Analytics workspace using the Azure Portal, you only get the Pricing or 'Pay-as-you-go' tiers to select.","datePublished":"2021-07-10T00:00:00.000Z","author":{"@type":"Person","name":"Luke Murray","description":"Author","url":"https://luke.geek.nz","image":"https://luke.geek.nz/img/logo.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://luke.geek.nz/2021/07/10/how-to-set-a-log-analytics-data-cap","mainEntityOfPage":"https://luke.geek.nz/2021/07/10/how-to-set-a-log-analytics-data-cap","url":"https://luke.geek.nz/2021/07/10/how-to-set-a-log-analytics-data-cap","headline":"How to set a Log Analytics Daily Data Cap","name":"How to set a Log Analytics Daily Data Cap","description":"This is just an additional configuration that may help with sizing and pricing Log Analytics, you can set a 'Daily cap' for the amount of Data you ingest _per day_, to help restrict cost.","datePublished":"2021-07-10T00:00:00.000Z","author":{"@type":"Person","name":"Luke Murray","description":"Author","url":"https://luke.geek.nz","image":"https://luke.geek.nz/img/logo.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://luke.geek.nz/2021/07/06/create-custom-roles-for-microsoft-azure","mainEntityOfPage":"https://luke.geek.nz/2021/07/06/create-custom-roles-for-microsoft-azure","url":"https://luke.geek.nz/2021/07/06/create-custom-roles-for-microsoft-azure","headline":"Create Custom Roles for Microsoft Azure","name":"Create Custom Roles for Microsoft Azure","description":"Microsoft Azure uses Role's to define who can access what - Role-Based Access Control (RBAC).","datePublished":"2021-07-06T00:00:00.000Z","author":{"@type":"Person","name":"Luke Murray","description":"Author","url":"https://luke.geek.nz","image":"https://luke.geek.nz/img/logo.png"},"keywords":[]}]}</script><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="luke.geek.nz RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="luke.geek.nz Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="luke.geek.nz JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0QDLBY7NNN"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0QDLBY7NNN",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.a8967c60.css">
<script src="/assets/js/runtime~main.cc20f5f7.js" defer="defer"></script>
<script src="/assets/js/main.f7e284ac.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#D3D3D3" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">If you haven't already, make sure you sign up for my Weekly Azure updates Newsletter, straight to your inbox! <a target="_blank" rel="noopener noreferrer" href="https://newsletter.azurefeeds.com/join">Subscribe now!</a></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="luke.geek.nz" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="luke.geek.nz" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">luke.geek.nz</b></a><a class="navbar__item navbar__link" href="/Tags/">Tags</a><a class="navbar__item navbar__link" href="/Archive/">Blog</a><a class="navbar__item navbar__link" href="/about/">About</a></div><div class="navbar__items navbar__items--right"><a href="https://www.youtube.com/channel/UCUG3TKDTAZz4UXshGrjBBoQ" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="YouTube">
              <svg width="24" height="24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M23.498,6.186c-0.273-1.186-1.143-2.144-2.332-2.417C18.389,3.153,12,3.153,12,3.153s-6.389,0-9.166,0.616
                  c-1.19,0.273-2.06,1.23-2.332,2.417C0,8.07,0,12,0,12s0,3.93,0.502,5.814c0.272,1.187,1.142,2.062,2.332,2.335
                  C5.611,20.847,12,20.847,12,20.847s6.389,0,9.166-0.698c1.189-0.273,2.059-1.148,2.332-2.335C24,15.93,24,12,24,12
                  S24,8.07,23.498,6.186z M9.545,15.568V8.432l6.545,3.568L9.545,15.568z"/>
              </svg>
            </a><a href="https://aus.social/@lukemurray" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="Mastodon">
              <svg height="20" width="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" xml:space="preserve">
                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                <g id="SVGRepo_iconCarrier">
                  <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.510 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"></path>
                </g>
              </svg>
            </a><a href="https://bsky.app/profile/lukemurraynz.bsky.social" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="Bluesky">
              <svg class="octicon" xmlns="http://www.w3.org/2000/svg" role="img" viewBox="0 0 16 16" height="20" width="20" fill="currentColor">
                <title>Bluesky</title>
                <path d="M8 7.2c-.72-1.4-2.7-4.04-4.53-5.33C1.7.63 1.04.84.6 1.04.1 1.27 0 2.05 0 2.51c0 .46.25 3.77.42 4.32.54 1.82 2.47 2.45 4.25 2.25-2.6.38-4.92 1.33-1.88 4.71 3.33 3.46 4.57-.74 5.21-2.87.64 2.13 1.37 6.18 5.16 2.87 2.84-2.87.78-4.33-1.83-4.71 1.78.2 3.71-.43 4.25-2.25.17-.55.42-3.86.42-4.32 0-.46-.09-1.24-.6-1.47-.44-.2-1.11-.42-2.87.83A17.87 17.87 0 0 0 8 7.2Z"></path>
              </svg>
            </a><a href="https://twitter.com/lukemurraynz" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="X"><svg height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 8.586l4.293-4.293a1 1 0 011.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 011.414-1.414L10 8.586z" clip-rule="evenodd"/>
          </svg></a><a href="https://www.linkedin.com/in/ljmurray/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="LinkedIn"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"></path></svg></a><a href="https://luke.geek.nz/rss" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-rss-link" aria-label="RSS"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite" aria-pressed="true"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/business-critical-workloads/">Understanding Workload Criticality in the Cloud</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/github-codespaces-azure-devops-repo/">How to Use GitHub Codespaces with Azure DevOps Repositories</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/azure-landing-zone-accelerator/">Deploying Azure Landing Zones with the Terraform Accelerator</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/azure-developer-cli/">Getting Started with Azure Developer CLI (azd)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/azure-platform-release-process/">How Microsoft Releases Changes to Azure - Safe Deployment</a></li></ul></div></nav></aside><main class="col col--7"><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/2021/07/13/validate-that-your-azure-resources-are-deployed-per-the-well-architected-framework/">Well-Architected Framework Azure infrastructure review with PSRule for Azure</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-07-13T00:00:00.000Z">July 13, 2021</time> · <!-- -->6 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Luke Murray</span></a></div><small class="authorTitle_nd0D" title="Author">Author</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>Imagine if you could validate that your Azure Resources are deployed per the Well-Architected Framework (WAF).. just <strong>imagine</strong>!</p>
<p><strong>Of a way of validating your services are secure and deployed following the Azure Architecture framework, both before and after the resources have been created!</strong></p>
<p>Imagine no longer! There is a PowerShell module designed specifically for that purpose: <strong>PSRule for Azure</strong>.</p>
<p><img decoding="async" loading="lazy" alt="PSRule - Azure" src="/assets/images/windowsterminal_data_psrules-azure-632e4b91e286be9af069b1fe176eec84.png" title="PSRule - Azure" width="624" height="325" class="img_ev3q"></p>
<p>PSRule is a suite of rules to validate resources and infrastructure as code <em>(IaC)</em> using PSRule, and the Azure component uses the base PSRule module.</p>
<p>Features of <a href="https://azure.github.io/PSRule.Rules.Azure/" target="_blank" rel="noopener noreferrer" title="PSRule for Azure">PSRule for Azure</a>
include:</p>
<ul>
<li>Leverage over 200 pre-built rules across five WAF pillars:
<ul>
<li>Cost Optimization</li>
<li>Operational Excellence</li>
<li>Performance Efficiency</li>
<li>Reliability</li>
<li>Security</li>
</ul>
</li>
<li>Validate resources and infrastructure code pre or post-deployment using Azure DevOps or Github!</li>
<li>It runs on macOS, Linux, and Windows.</li>
</ul>
<p>With over 200 inbuilt rules <em>(and you can add your own),</em> there is a lot of resource types covered, such as <em>(but not limited to)</em>:</p>
<ul>
<li>Azure App Service</li>
<li>Azure Key vault</li>
<li>Azure Virtual Machine</li>
<li>Azure Storage</li>
<li>Azure Network</li>
<li>Azure Public IP</li>
</ul>
<p>Azure PSRules has been in development since 2019 and is under constant updates and fixes.</p>
<p>PSRule for Azure provides two methods for analyzing Azure resources:</p>
<ul>
<li>Pre-flight - Before resources are deployed from Azure Resource Manager templates.</li>
<li>In-flight - After resources are deployed to an Azure subscription.</li>
</ul>
<p>Pre-flight validation is used to scan ARM (Azure Resource Manager) templates before services are deployed and allow for quality gaps and better information in pull requests to improve and implement your infrastructure as code components.</p>
<p>The in-flight method can also be used in Azure DevOps for validation of Terraform resource deployments etc. Still, in this demo, I will run you through installing the Module and doing an export and scan from your PowerShell console!</p>
<p>We are going to install the PSRule.Azure <em>(based on the Well-Architected Framework &amp; Cloud Adoption Framework)</em>.</p>
<p>I recommend keeping the Modules <em>(and as such the in-built rules)</em> up-to-date and do scans at least every quarter or after a major deployment or project to help verify your resources are set up according to some best-practice rules. This does not replace Security Center and Azure Advisor; this is intended to be a supplement.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-psruleazure">Install PSRule.Azure<a href="#install-psruleazure" class="hash-link" aria-label="Direct link to Install PSRule.Azure" title="Direct link to Install PSRule.Azure">​</a></h3>
<ol>
<li>
<p>Open <strong>PowerShell</strong> console and <strong>run</strong> the following <strong>commands</strong>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#The main Module and base rules to validate Azure resources..</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Install-Module PSRule.Rules.Azure -Scope CurrentUser</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Install-Module PSRule" src="data:image/png;base64,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ERIBAABohEQAAAAaIREAAIBGSAQAAKAREgEAAGiERAAAABohEQAAgEZIBAAAoBESAQAAaIREAAAAGiERAACARkgEAACgERIBAABohEQAAAAaIREAAIBGSAQAAKAREgEAAGiERAAAABohEQAAgEZIBAAAoBESAQAAaIREAAAAGiERAACARkgEAACgERIBAABohEQAAAAaIREAAIBGSAQAAKAREgEAAGiERAAAABohEQAAgEZIBAAAoBESAQAAaIREAAAAGiERAACARkgEAACgERIBAABohEQAAAAaIREAAIBGSAQAAKAREgEAAGiERAAAABohEQAAgEZIBAAAoBESAQAAaIREAAAAGiERAACARkgEAACgERIBAABohEQAAAAaIREAAIBGSAQAAKAREgEAAGiERAAAABohEQAAgEZIBAAAoBESAQAAaIREAAAAGiERAACARkgEAACgERIBAABohEQAAAAaIREAAIBGSAQAAKAREgEAAGiERAAAABohEQAAgEZIBAAAoBESAQAAaIREAAAAGiERAACARkgEAACgERIBAABohEQAAAAaIREAAIBGSAQAAKAREgEAAGiERAAAABohEQAAgEZIBAAAoBESAQAAaIREAAAAGiERAACARkgEAACgERIBAABohEQAAAAaIREAAIBGSAQAAKAREgEAAGiERAAAABohEQAAgEZIBAAAoBESAQAAaIREAAAAGiERAACARkgEAACgERIBAABohEQAAAAaIREAAIBGSAQAAKAREgEAAGiERAAAABohEQAAgEZIBAAAoBESAQAAaIREAAAAGiERAACARkgEAACgERIBAABohEQAAAAaIREAAIBGSAQAAKAREgEAAGiERAAAABohEQAAgEZIBAAAoBESAQAAaIREAAAAGiERAACARkgEAACgERIBAABohEQAAAAaIREAAIBGSAQAAKAREgEAAGiERAAAABohEQAAgEZIBAAAoBESAQAAaIREAAAAGiERAACARkgEAACgERIBAABohEQAAAAaIREAAIBGSAQAAKAREgEAAGiERAAAABohEQAAgEZIBAAAoBESAQAAaIREAAAAGiERAACARkgEAACgERIBAABohEQAAAAaIREAAIBGSAQAAKAREgEAAGiERAAAABohEQAAgObEq1/96tkKAAAAjpdXvOIVw4nLL798thIAAIDj5bLLLhtOXHnllbOVAAAAHC+f/vSnhxOPPPLI8IY3vGG2AQAAAMfDBRdcMNx///1PhsS77rprOOecc2YbAgAAcPSdOnXqyZD4ne98Z6igeNFFF802BgAA4GjKFcQKiPfdd9+TVxIffvjh0UMPPTR85jOfGd773vcOL33pS2dXAAAAwOGWvHfJJZcMn/rUp8ZgeO+9947uv//+4f8CIrNRqbzoK4cAAAAASUVORK5CYII=" title="Install-Module PSRule" width="905" height="242" class="img_ev3q">
2. Press &#x27;<strong>Y</strong>&#x27; to <strong>accept PSGallery</strong> as a trusted repository; just a note, you can prevent the confirmation prompt when installing Modules from the PSGallery, by classifying it as a &#x27;Trusted Repository&#x27; by running the following. Just be wary that won&#x27;t get rechallenged:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">   Set-PSRepository -Name &#x27;PSGallery&#x27; -InstallationPolicy Trusted</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>3. You should now have the following modules installed:</p>
<ul>
<li>PSRule</li>
<li>PSRule.Rules.Azure</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="extract-azure-subscription-psrule-json-files">Extract Azure Subscription PSRule JSON files<a href="#extract-azure-subscription-psrule-json-files" class="hash-link" aria-label="Direct link to Extract Azure Subscription PSRule JSON files" title="Direct link to Extract Azure Subscription PSRule JSON files">​</a></h3>
<p>Now that PSRule has been installed, it&#x27;s time to log in to Azure and extract information regarding your Azure resources for analysis; these extracted files are JSON files containing information, such as your resource names, subscription ID, etc. resource groups in plain text.</p>
<p>As you can see from the screenshot below, we can target specific Subscriptions, Tenancies <em>(yes, as long as the account you have access to has access to the subscription, you can export those as well)</em>, Resource Groups and Tags.</p>
<p><img decoding="async" loading="lazy" alt="Export-AzRuleData" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATUAAAC4CAYAAACCRnu2AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABMHSURBVHhe7ZxdyGXXWcdHi/SiCL3QO70T8aq9SRFvpGgpjR9gLKSgBcFQQS+kN5agFD9REEbphdiL0A5lBCUtSJJBmJIJ6oUXOoYQHZikUQk202hM3hjv/NjO/5zzvOc56332es46Z+91znve3x9+nL0+9tr7nMz6sfZk9rr2bd/3+AAAcCogNQA4KZDaHHz2xeFv/ncY/mVY8uLdG8MHon6XmI/+9C8Nd772R2EbwCEZldqv3P+f80l5LJPz0b88G157/a+G7wraUr78+vDq8F/Dn/zOz8XtARd+gx2urTG2/92+MHzx3/9v92vqO757f/j0h4O2iUFqcKxUpXZsK4x9pLb4PmfvNZ2/+RvcGp7572H4+p//woV+NXaR2voaK8lte89IDWAXqa0mmps8C9lYefHo9a3h9/5MK6NgtTH6aGYT+qn1amVjzPU5F8/NeCiktx+O9eTq3n5o3abvWY5r97v5G2wKpxTsmHDHfseN657/lqXUHrL47rbCXIp1fa9j9SvK+xtp2wWkBsfKziu1xaTUxNCkO1sL7lxANmlW5eVE1eTzj4B+9bOSpZ+oEpGN+5BdV2o67+8W3yWQhmdDIMVvsHh8XQtxH6mVdetydH/+N/vC8NiT9tu5/wbWt7JSe/TJP17fQ/E9dwGpwbGy/d+pXZgstjooJsdiwvjV0HKiLiZtMOnWEzMRzkNGpWYi9fd73k/jvnd+j9kY/vqbv8HmCm93qdnvVrA4N5Pa6joXzlv1rT5+ltfdTmof+omXh3/9rbeHtx2v/Ox1pAZHyx5/p7aeJBuTcERqiz5zSa1GJLxQxBf/vmz9Gyy/q2/fV2rx9wx+A/97JqvFcaktx13fx6YodwGpwbGyo9QKUflVTCmIRbtNoHIy+Qm+pdRGVyIxOuf2xpjFBF/cXyyZjd9g8b3W975xL6sxNlZNK6LfUXUXV76i/A2Wv4+dX37/xTil1IoVpR/nfNziu+wCUoNjZfvHz/NJu5x4fjItJpuJa7Wy+It/Wp+/IYyV9KxtPeFzqdnktHMjiWyi/sEk1+RfyGH1XWw8YyWOUkgb39Pfy8P7+JTagvuJpGb1G9f0v62r3zx38/t//W//cflbnl+3ON8JcHnv6/ovf0PX311sSA2OlVGp7cxKahdXC3BKIDU4VpAa7ARSg2NleqnBlQCpwbGC1ADgpEBqAHBSIDUAOCmQGgCcFEgNAE4KpAZVnnvuOYBLBVKDKvpDMnW++defAbjA2dnZ3iA1SJlLatc+9TWAc5AadAOpQQ+QGnQDqUEPkBp0A6lBD5AadKOH1J744t1VyzJ/cOvVjfYaykd+9U7Y1kI5TpnsGmWfsgx1kBp0Y26pSWCK/wP+6oP3hlt//2CjbgxlLqlZ2aRrbREKUtudbaT22muvDXfu3BneeeedsF0gNUipSe3Hf/s/hx/7zXeHT/zGO6uazXz/z//z8L0/843huz95f1WzjJeaBFZOfpUVKyuRMHxsdWfHFglp13HKvvrU/Vp8X8vYfVg9xGRSk9Bu3rw53LhxY7h9+/ao2JAapNSkJqH91O8Pw8c//x+rms1IaB/89DB850/eW9UsY1IzoZR/wIXkYUJSIhmNtdkqr1xhKS3jWFlC0v1Ym+/jj7e9D7hITWomtOeff/78eExsSA1STGq3//RLw1NPPTVcv/6Hw1e++vyiTis0Se1jv/Zvi3IZrdDe//gwvP8T/7CqWWZbqW0jHH+8T19/bGUfqzdBWbYZOyrDJjWplRIzsb388ssX+iI1SPFSu379+obUtEKT1H708+8OP/jZbw4f+sXXNx45P/DYw5XKY8PwHR9/adHfYlITSjnZVVbG+viyP96nrz+OykJC8ys238cfb1OGTWpSe+GFFy6syiS2e/fubdQJpAYpJrUoWqE9+rvD8NFfH4ZHPjcMP/DLw/A9nxkWj5xaoUlo4n0fe3F1xjJeavb3Tv4PuMTh/w7KP4raSqkmEzu3fGxsHaeUkM4pHym3Pb8swyY1qbWA1CClJrUf/ty3whWa/g5Nj5xaoUlo3/4jm49sXmrCxGbxQhMmEEVSUUwQVrZzFKtTvEhax4kkZGk9vyzDJkgNulGT2q4ppTYlCvK4fCA16AZSgx4gNejGZZMaXE6QGnQDqUEPkBp0Yy6pAZTcvXt3b5AapMwhNUKiRJJqBalBClIjvRJJqhWkBilIjfRKJKlWkBqkIDXSK5GkWkFqkILUSK9EkmoFqUHK3FK7devWcO3atXNeeeWVVct4tu3XEo25Tcprb3seyRNJqhWkBilzSk1y2EVQc0ht2xzy2qeeSFKtIDVIqUlt151vLSa1KKU8fFnH2gZJn0KrPYuv97G6J5544rys40ceeeS8nI1vZWu3uvI+jbLej2nnk3UiSbWC1CClJrVdd771sYnuxaREUvDSMTnZ46vFH1vU1/pb1M+LpWX8sfvSOTamzjNhKrUxyTKRpFpBapBiUpty59somuSlBGpSG2vTGJHAfH9l1/HnaCPLRJJqBalBipeaViFT7Hw7FgnJVmz7CMJWf5ayXamN0buNLBNJqhWkBikmtSi77nw7Fi81f2yPa14Q9pinT7/Cs6jO+uvY+ltqkqmNXzsve/wcO48sE0mqFaQGKTWp7brzrUWTWpPb8I+NJjKr16dJwNf5esXqokdQXx+dt834Vm/yKtvtnKi+ViZIDTpRk9qpBuEcJpGkWkFqkILUSK9EkmoFqUHKVZQaOUwiSbWC1CAFqZFeiSTVClKDFKRGeiWSVCtIDVKQGumVSFKtIDVIQWqkVyJJtYLUIAWpkV6JJNUKUoMUpEZ6JZJUK0gNUpAa6ZVIUq0gNUiZU2r6R64lPf/Ra+/rkXoiSbWC1CClx0rtUHJBaseVSFKtIDVIqUlt351vLZFcVCf8i+kq60Vya7OXyhXtiBHVj51jZV9HDptIUq0gNUipSW2KnW8VicVLTSLzWxBZm/qZ5GwXjyi+vnaOjlmpHU8iSbWC1CDFpDbnzrelXFT2mOCiflb2WxX5+to5ZRs5bCJJtYLUIMVLTY9pc+x8WxOPz1g/CW1sQ8ba2GUbOWwiSbWC1CDFpBZlqp1vS7lIUNHfc40JSlIrHzHHxFVrI4dNJKlWkBqk1KS27863llIuOladYSn7+bL1ldzK+rFzrC//o+A4EkmqFaQGKTWpETJlIkm1gtQgBamRXokk1QpSgxSkRnolklQrSA1SkBrplUhSrSA1SEFqpFciSbWC1CAFqZFeiSTVClKDFKRGeiWSVCtIDVKQGumVSFKtIDVIQWqkVyJJtYLUIAWpkV6JJNUKUoOUuaWm15Q8tiPHZYleuSq/Q8/oevbeq0V1/tWwy5JIUq0gNUjpITWbgPYy+mXJMdyvru/3nFOQWvAHGcCoSW2KnW/LCVhKQmXhVyN6Ad3qfaxO1Ca5L+tYY5dbF1m9JaorZVKmNrZouUf/nf1q1srlNexc1dt5/sV9lXVvVm/H/vspdm5ZP0ciSbWC1CClJrUpdr7VhLEJqMnlJ6cmkk1gLxCdU0Z9bdLWJrniyzr2k13jlBM4ug/hrxElGnvXe7R70nkqW6yfv8dyLEt5nu5F/XSsc+3YEn3vORNJqhWkBikmtbl2vtUkMmziWnyb8BMs6usnnS/v2mZRnccE4KUkQVj7tmNv23fbNrsfX6d7VdmIzqsde+z3nyuRpFpBapDipaaJO/XOt34SaVL6iePbyphELGVfX961zRLVKVnfbOxt+27btvzvs/xdVKff0ot37LxtjnskklQrSA1STGpRptj51k8cfaps0YTUJB2L2u1crdysbzmZvSz1WZu40TXH7kN1/jpKbex97tHOK69ZXkNltatO49iKtva9x441TvS950okqVaQGqTUpDbFzrd+Eil+0qpe7YbFyrXHVT+mTWg7x7eXfRXfVxm7D0X369u8BFQeG7tsy+7R6ny9UpYjeYna9x471qfKxtyJJNUKUoOUmtRIn3jRnHIiSbWC1CAFqR0+SG17kBqkIDXSK5GkWkFqkILUSK9EkmoFqUEKUiO9EkmqFaQGKUiN9EokqVaQGqQgNdIrkaRaQWqQgtRIr0SSagWpQQpSI71ydna2N0gNUpAa6ZVIUq0gNUiZU2r+FRzjKvwjUxInklQrSA1SeqzUkBlRIkm1gtQgpSa1KXa+VUqp6YV2W7mVu0T4+vI8crkTSaoVpAYpNalNsfOtUpOT2izaacIkh9ROL5GkWkFqkGJSm2vnW6WUk9+Gx7eV/coyudyJJNUKUoMULzWtjqbe+VbxcpLQxjZBRGqnnUhSrSA1SDGpRZli51ullJptzlhueOh3Yi3byOVPJKlWkBqk1KQ2xc63SrQCE+VurfocayOXP5GkWkFqkFKT2iGjFZt/TCWXP5GkWkFqkHJMUrP/42mwSjutRJJqBalByrGu1MjpJZJUK0gNUpAa6ZVIUq0gNUhBaqRXIkm1gtQgBamRXokk1QpSgxSkRnolklQrSA1SkBrplUhSrSA1SEFqpFciSbWC1CAFqZFeiSTVClKDlLml5v8x7VT/oLYc04/rj8lxJZJUK0gNUnpIzSRjL6lPlUhgSO14E0mqFaQGKTWpTbHzbSkZk9rY7rf+VSlLVKeoHEnN9/djq6wX5e2d0vL8skymTSSpVpAapNSkNsXOt14UEkz0krr6WPyxJapTIgmprtzayKLjUnJIrV8iSbWC1CDFpDbXzrcShcdiwjFMJpKeSckS1Sn+PEtZ58u1NiUaj0yXSFKtIDVI8VLTKmbqnW8jUUhofsVW9rHHR5+oLhq7rPPlWpsSjUemSySpVpAapJjUokyx820kCkmtfEQs+0h6WV10Xk1UZZvG0/WVsfsg0yWSVCtIDVJqUpti59sxUaheSG6+j6+3RHWKP89S1vly2WYiE+V9kOkTSaoVpAYpNakRMmUiSbWC1CAFqZFeiSTVClKDFKRGeiWSVCtIDVKQGumVSFKtIDVIQWqkVyJJtYLUIAWpkV6JJNUKUoMUpEZ6JZJUK0gNUpAa6ZVIUq0gNUhBaqRXIkm1gtQgBamRXokk1QpSg5QeUtOrR9ErSL6OV5ROP5GkWkFqkNJDatphQ+9W+r3MFKR2tRJJqhWkBik1qU2x861i2wz57YYUpHa1EkmqFaQGKTWpTbHzrURlu2vo07b6UZDa1UokqVaQGqSY1Oba+daLTJ8mOAWpXa1EkmoFqUGKl9pcO9+WWHSM1K5OIkm1gtQgxaQWZd+db8uVmeJXbkjtaiWSVCtIDVJqUtt359vy79AULzqkdrUSSaoVpAYpNakRMmUiSbWC1CAFqZFeiSTVClKDFKRGeiWSVCtIDVKQGumVSFKtIDVIQWqkVyJJtYLUIAWpkV6JJNUKUoMUpEZ6JZJUK0gNUpAa6ZVIUq0gNUhBaqRXIkm1gtQgBamRXokk1QpSg5Q5pRa9JlW+DqV222dtl1elynNUtuj6KpebU5LDJJJUK0gNUuaUmn/PUzGBecksdwZZlqeW2i7jkfkSSaoVpAYpNantu/OthOJ3u5XgJDBfp2MTj62q9GnHFvUr661c1tmnUa4WyWESSaoVpAYpNalNsfOtl5bJzD5L6UlAtrKTiExQZXy9jv1qrNZGDptIUq0gNUgxqc21861WUEJyMWHpU9ISfjUWCcrKJjnD6qNzLGUbOWwiSbWC1CDFS20poGl3vpVUtBrT2PYYqE+JzeRmiQSlsvqUKzrrF51jKdvIYRNJqhWkBikmtSj77nxrkZC8lBSVvYCUSFAmtfKxFKldvkSSagWpQUpNavvufGvRKq2Umq3UfCJBeXkJnePrrWyPsTq2+H7k8Ikk1QpSg5Sa1AiZMpGkWkFqkILUSK9EkmoFqUEKUiO9EkmqFaQGKUiN9EokqVaQGqQgNdIrkaRaQWqQgtRIr0SSagWpQQpSI70SSaoVpAYpSI30SiSpVpAapCA10iuRpFpBapCC1EivRJJqBalBSg+p2fuaht+ZY5fUXo0ix5tIUq0gNUiZW2omtCmj8Xin8/IlklQrSA1SalLbd+dbRS+y1wQkQRm+n8paiVmbX5UZEqbV2bk61krOXqC3sj41hh3rk/RNJClx9+7dC3UPHjwY7t+/f6EeqUFKTWr77nwr0ZS7c/hILCYrCcr39eIpV3s6LgXopWZjKlZWu441lh2TvikFZdy4cWNDbG+++ebw9NNPDy+99NJGP4HUIMWkNsfOt5nUvIwUX567rexH5k8pKOPevXvnYnvjjTcWQnvmmWeGt95660JfpAYpXmpa0Uy9821NHtsKSJm6rexH5k8pKI+J7ebNm6NCE0gNUkxqUabY+VaiLFdr9niYPX5uIydll7ayH5k/kaQ8Etuzzz47KjSB1CClJrUpd76VRAwfXz8mI8WXp2gr+5H5E0mqFaQGKTWpETJlIkm1gtQgBamRXokk1QpSgxSkRnolklQrSA1SkBrplUhSrSA1SEFqpFciSbWC1CBFf0gALhNIDQBOiMeH/wenGvMJji1rjAAAAABJRU5ErkJggg==" title="Export-AzRuleData" width="309" height="184" class="img_ev3q"></p>
<p>Because I want to get the most data available across all resources, I will target everything with the &#x27;<em>-All</em>&#x27; parameter.</p>
<ol>
<li>
<p>First, we need to connect to the Azure subscription and then <strong>connect</strong> to the <strong>Azure</strong> subscription we have access to or are targeting by running the following:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Connect-AzAccount</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Get-AzSubscription  | ogv -PassThru | Set-AzContext</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Now that you have connected its time to export the Azure resource information, <strong>run</strong> the following <strong>PowerShell</strong> cmdlet, and <strong>point</strong> it towards an <strong>empty folder</strong>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Export-AzRuleData -OutputPath c:\temp\AzRuleData -All</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>If the <strong>folder doesn&#x27;t</strong> <strong>exist</strong>, <em>don&#x27;t worry</em> - the Export command will <strong>create</strong> it <strong>for you</strong>. Depending on how many resources and subscriptions you are extracting, this may take a few minutes.</p>
</li>
</ol>
<p>You should <strong>see</strong> the <strong>JSON files</strong> appearing if you open one of these. In addition, you should be able to see information about the resources it has extracted.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="run-psrule-across-your-json-files">Run PSRule across your JSON files<a href="#run-psrule-across-your-json-files" class="hash-link" aria-label="Direct link to Run PSRule across your JSON files" title="Direct link to Run PSRule across your JSON files">​</a></h3>
<p>Now that you have extracted the JSON files of your Azure resources, it&#x27;s now time to analyse them following Microsoft Cloud Adoption and Well Architectured framework and the rules builtin into PSRule.Azure!</p>
<p>You don&#x27;t need to be connected to Azure; for this analysis, have the PSRule modules installed and access the JSON files.</p>
<p>PSRule.Azure has a few <a href="https://azure.github.io/PSRule.Rules.Azure/en/baselines/Azure.All/" target="_blank" rel="noopener noreferrer" title=" PSRule for Azure - All Baselines">baselines</a>; these baselines contain the rules used to analyse your resources and range from Preview to newly released rules; again, we will target ALL rules, as we are after all recommendations.</p>
<ol>
<li>
<p>In <strong>PowerShell, run</strong> the following:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Assert-PSRule -Module &#x27;PSRule.Rules.Azure&#x27; -InputPath &#x27;C:\temp\AzRuleDataExport\*.json&#x27; -Baseline &#x27;Azure.All&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>This will trigger <strong>PSRules</strong> to <strong>scan</strong> your <strong>extracted JSON</strong> files with the <strong>ALL</strong> rules, and you will get <strong>output</strong> like below:</p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="Invoke-PSRules" src="/assets/images/windowsterminal_data_psrules-azure-632e4b91e286be9af069b1fe176eec84.png" title="Invoke-PSRules" width="624" height="325" class="img_ev3q"></p>
</li>
<li>
<p>Although it is good being able to see a high level, I prefer to look at it all at once in Excel, so run the following to <strong>export</strong> the rules to a <strong>CSV</strong>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Invoke-PSRule -Module &#x27;PSRule.Rules.Azure&#x27; -InputPath &#x27;C:\temp\AzRuleDataExport\*.json&#x27; -Baseline &#x27;Azure.All&#x27; | Export-csv C:\temp\AzRuleDataExport\Exported_Data.csv</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>You should now have a CSV file to review and look for common issues, concerns and work on improving your Azure infrastructure setup!</p>
</li>
</ol>
<p><img decoding="async" loading="lazy" alt="PS Rules Azure - Export CSV" src="/assets/images/export_azruledata_excel-9450a5fd0637a23b1369552391dc4a67.png" title="PS Rules Azure - Export CSV" width="2578" height="769" class="img_ev3q"></p>
<p><em>Note: The export contains the Subscription/Resource Names, so you can definitely see what resources can improve upon; however, I removed it from my screenshot.</em></p>
<p><strong>Congratulations</strong>! You now have more visibility and, hopefully, some useful recommendations for improving your Azure services!</p>
<p><em>If you want to get a good understanding of the type of data rules, check out my extracted CSV &#x27;</em><a href="http://luke.geek.nz/uploads/files/Exported_Data_PSRuleAzure.csv" target="_blank" rel="noopener noreferrer"><em>here</em></a><em>&#x27;.</em></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="additional-resources">Additional Resources<a href="#additional-resources" class="hash-link" aria-label="Direct link to Additional Resources" title="Direct link to Additional Resources">​</a></h3>
<ul>
<li>If you found PSRules.Azure interesting; how about getting any Failed rules? How about getting any failed rules pushed to Azure Monitor?</li>
</ul>
<p><a href="https://github.com/microsoft/PSRule.Monitor" target="_blank" rel="noopener noreferrer" title="PSRule to Azure Monitor">PSRule to Azure Monitor</a></p>
<ul>
<li>If you are interested in the CI (Continous Integration) options, check out the links below:</li>
</ul>
<p><a href="https://microsoft.github.io/PSRule/" target="_blank" rel="noopener noreferrer" title="PSRule">Azure DevOps Pipeline &amp; Github Actions</a></p>
<ul>
<li>Extend the PSRules to include Cloud Adoption Framework as well?</li>
</ul>
<p><a href="https://github.com/microsoft/PSRule.Rules.CAF" target="_blank" rel="noopener noreferrer" title="PSRule for Cloud Adoption Framework">PSRule for Cloud Adoption Framework</a></p>
<ul>
<li>And finally, creating Custom Rules for your organisation, including Tagging, Naming conventions etc.?</li>
</ul>
<p><a href="https://azure.github.io/PSRule.Rules.Azure/customization/" target="_blank" rel="noopener noreferrer" title="Organization specific rules">PSRule.Azure Custom Rules</a></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/2021/07/10/configure-azure-virtual-desktop-monitoring-insights/">Configure Azure Virtual Desktop Monitoring Insights</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-07-10T00:00:00.000Z">July 10, 2021</time> · <!-- -->5 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Luke Murray</span></a></div><small class="authorTitle_nd0D" title="Author">Author</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>Microsoft has now added a built-in Monitoring workbook for Azure Virtual Desktop performance monitoring; this monitoring includes dashboards related <em>(but not limited to)</em>:</p>
<ul>
<li>Session host diagnostics</li>
<li>Connection performance</li>
<li>Host performance</li>
<li>User login events</li>
<li>Remote Desktop client versions</li>
</ul>
<p>To configure, we first need to create a Log Analytics workspace that both the Host Pool and Workspace will connect to.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-log-analytics-workspace">Create a Log Analytics workspace<a href="#create-a-log-analytics-workspace" class="hash-link" aria-label="Direct link to Create a Log Analytics workspace" title="Direct link to Create a Log Analytics workspace">​</a></h3>
<p>You can use a Log Analytics workspace if it already exists; if not, we will have to create one.</p>
<ol>
<li>Log in to the <strong>Azure Portal</strong></li>
<li>Click on + <strong>Create a Resource</strong></li>
<li>Search for: <strong>Log Analytics workspace</strong></li>
<li>Click <strong>Create</strong></li>
<li><img decoding="async" loading="lazy" alt="Azure Portal - Log Analytics Marketplace" src="/assets/images/azportal_loganalyticsworkspace-1731c847286b3b7f27cfe4cd5b15db61.png" title="Azure Portal - Log Analytics Marketplace" width="991" height="500" class="img_ev3q"></li>
<li>Here we can <strong>select</strong> the <strong>Resource Group</strong>, <strong>Name</strong> and <strong>Location</strong> of the Log Analytics workspace we will create.</li>
<li>I am going to <strong>create</strong> a new <strong>Resource Group</strong> called: aad_mgmt</li>
<li>I click Create New and <strong>enter</strong> in the <strong>name</strong> of the <strong>Resource Group</strong></li>
<li>Under Instance Details, make sure you select a name that adheres to your naming governance.</li>
<li><em>Note: the name of your Log Analytics workspace is now scoped to the Resource Group, so you can have Log Analytics workspaces with the same name, as long as they are indifferent resource groups.</em></li>
<li><img decoding="async" loading="lazy" alt="Azure Portal - Create Log Analytics" src="/assets/images/azportal_createloganalyticsworkspace-de7ccc210cfbffca60f38cbf97d55e97.png" title="Azure Portal - Create Log Analytics" width="725" height="663" class="img_ev3q"></li>
<li>Click on: <strong>Next: Pricing Tier</strong></li>
<li><strong>Select</strong> the applicable <strong>pricing tier</strong>, I only have Pay-as-you-go (Per GB 2018), so I will select that.</li>
<li><em>Note: You can view the Pricing for Log Analytics on the</em> <a href="https://azure.microsoft.com/en-us/pricing/details/monitor/?WT.mc_id=AZ-MVP-5004796," target="_blank" rel="noopener noreferrer" title="Azure Pricing Calculator - Azure Monitor"><em>Pricing Calculator</em></a><em>:  look at the Pay-As-You rates.</em></li>
<li><img decoding="async" loading="lazy" alt="Azure Portal - Create Log Analytics" src="/assets/images/azportal_createloganalyticsworkspacepricing-82e82e4f329bb29622867177b614e4f7.png" title="Azure Portal - Create Log Analytics" width="743" height="349" class="img_ev3q"></li>
<li>Click <strong>Next: Tags</strong></li>
<li><strong>Enter</strong> in any <strong>applicable tags</strong>, such as Creator, Who it may get billed to, Project ID etc. that’s relevant and select <strong>Review + Create</strong></li>
<li><strong>Review</strong> the <strong>configuration</strong> and click <strong>Create</strong> to create your Log Analytics workspace! <em>(It should take less than a minute.</em>)</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-azure-virtual-desktop-insights">Configure Azure Virtual Desktop Insights<a href="#configure-azure-virtual-desktop-insights" class="hash-link" aria-label="Direct link to Configure Azure Virtual Desktop Insights" title="Direct link to Configure Azure Virtual Desktop Insights">​</a></h3>
<ol>
<li>
<p>Log in to the <strong>Azure Portal</strong></p>
</li>
<li>
<p><strong>Search</strong> for: <strong>Azure Virtual Desktop</strong></p>
</li>
<li>
<p>Click on <a href="https://portal.azure.com/#blade/Microsoft_Azure_WVD/WvdManagerMenuBlade/insights" target="_blank" rel="noopener noreferrer" title="Azure Virtual Desktop - Insights"><strong>Insights</strong></a></p>
</li>
<li>
<p>A Workbook blade should now greet you</p>
</li>
<li>
<p>This is where we will <strong>configure</strong> the Azure Virtual Desktop <strong>Insights</strong>. You can see on the lower right-hand side that we will be deploying Azure Monitor for &#x27;Windows Virtual Desktop v1.0.4&#x27; <em>(however, this will be managed by Microsoft, but it is handy to know the version in case of support later on).</em></p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="Azure Virtual Desktop - Insights" src="/assets/images/azportal_azurevirtualdesktop_insights-dfb15951312d5bd19cec3a739675b4e9.png" title="Azure Virtual Desktop - Insights" width="1700" height="672" class="img_ev3q"></p>
</li>
<li>
<p>Click on <strong>Open Configuration Workbook</strong></p>
</li>
<li>
<p>Here, <strong>select</strong> the Log Analytics <strong>workspace</strong> you created earlier <em>(or want to use)</em></p>
</li>
<li>
<p>Select <strong>Configure host pool</strong></p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="Azure Virtual Desktop - Insights" src="/assets/images/azportal_azurevirtualdesktopcheckconfiguration-f0789585b303fa6f001d9178b019d839.png" title="Azure Virtual Desktop - Insights" width="925" height="997" class="img_ev3q"></p>
</li>
<li>
<p>Click on <strong>Deploy</strong> <em>(make sure all your Session Hosta are started so that Azure can deploy and configure the Log Analytics agent on the Virtual Machines)</em></p>
</li>
<li>
<p>You can select View Template and Parameters if you want to confirm the host pool and workspace configured.</p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="Azure Virtual Desktop - Insights" src="/assets/images/azportal_azurevirtualdesktophostpooldeploy-12850b5994f383071022cfd6189a7543.png" title="Azure Virtual Desktop - Insights" width="408" height="309" class="img_ev3q"></p>
</li>
<li>
<p>While the Diagnostic host pool settings are being configured, click on <strong>Configure workspace.</strong></p>
</li>
<li>
<p>Click on: <strong>Deploy</strong></p>
</li>
<li>
<p>Once the Workspace and Host Pool deployments are done, click on <strong>Refresh.</strong></p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="Azure Virtual Desktop - Insights" src="/assets/images/azportal_azurevirtualdesktopcheckconfigrefresh-8a31df74f32458c5c1adfe8218f3426b.png" title="Azure Virtual Desktop - Insights" width="621" height="142" class="img_ev3q"></p>
</li>
<li>
<p><strong>Confirm</strong> that <strong>Enabled</strong> is: True</p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="Azure Virtual Desktop" src="/assets/images/azportal_azurevirtualdesktopcheckconfig-f6b7bf16a6e99d7367517c0ee4496bb0.png" width="1260" height="734" class="img_ev3q"></p>
</li>
<li>
<p>The journey is not over yet; now that the Host Pool and Workspace have been configured, we need to <strong>add</strong> the <strong>Session Hosts</strong> and configure the <strong>performance counters</strong> to the same workspace!</p>
</li>
<li>
<p>Click on: <strong>Session host data settings.</strong></p>
</li>
<li>
<p><strong>Select</strong> your Log Analytics <strong>workspace</strong></p>
</li>
<li>
<p>Select <strong>Add hosts to workspace</strong></p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="Azure Virtual Desktop" src="/assets/images/azportal_sessionhostdatasettings-a761143019816a6cc5e3d73bec9d1b1c.png" width="955" height="578" class="img_ev3q"></p>
</li>
<li>
<p>Confirm the Deployment and click <strong>Deploy</strong></p>
</li>
<li>
<p><strong>Wait until</strong> the <strong>deployment</strong> has <strong>succeeded,</strong> or you may get API errors, then select:</p>
</li>
<li>
<p>Navigate down and click <strong>Configure performance counters</strong></p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="Azure Virtual Desktop" src="/assets/images/azportal_performancecounterssettings-6cf5bc872a2bc3942fb88a172ea99dcd.png" width="1141" height="597" class="img_ev3q"></p>
</li>
<li>
<p>Click on <strong>Apply</strong> config.</p>
</li>
<li>
<p><strong>Wait until</strong> the <strong>deployment</strong> has <strong>succeeded,</strong> or you may get API errors, then select:</p>
</li>
<li>
<p>Navigate down and click on <strong>Configure events</strong></p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="Azure Virtual Desktop" src="/assets/images/azportal_eventlogssettings-673f0134884b13d12f45ee37eac9e2a2.png" width="1347" height="631" class="img_ev3q"></p>
</li>
<li>
<p>Click on <strong>Deploy</strong></p>
<p>Now click on: <strong>Refresh</strong>, and you should see &#x27;No missing performance counters&#x27;, &#x27;No missing events found&#x27;.</p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="Azure Virtual Desktop" src="/assets/images/azportal_performancecountersreview-ae75b48856a1e45f3e90086cfbab7187.png" width="1506" height="875" class="img_ev3q"></p>
</li>
<li>
<p><strong>You have now configured Azure Virtual Desktop Insights!</strong></p>
<p><em>It may take a few minutes to an hour to populate and collect the data for some of the events and counters.</em></p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="Azure Virtual Desktop" src="/assets/images/azportal_azurevirtualdesktopinsights-16a5d47b37970b66136cbd3e5f590764.png" width="1576" height="792" class="img_ev3q"></p>
<p><em>On the plus side, all the data is also in Log Analytics so that it can be queried, and you can set up Alert rules against it and get more visibility into your Azure Virtual Desktop environment and use.</em></p>
<p><img decoding="async" loading="lazy" alt="Azure Virtual Desktop" src="/assets/images/azportal_azurevirtualdesktoploganalytiicsquery-49377adee1c7434d0b3a37d4735c5d42.png" width="1694" height="990" class="img_ev3q"></p>
</li>
</ol></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/2021/07/10/how-to-create-a-free-log-analytics-workspace/">How to create a Free Azure Log Analytics Workspace using PowerShell</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-07-10T00:00:00.000Z">July 10, 2021</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Luke Murray</span></a></div><small class="authorTitle_nd0D" title="Author">Author</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>When you create a Log Analytics workspace using the Azure Portal, you only get the Pricing or &#x27;Pay-as-you-go&#x27; tiers to select.</p>
<p>You used to create a &#x27;Free&#x27; tier using the Azure Portal; however, since 2018; they removed it with a change in plans and it became a legacy offering.</p>
<p>However, using PowerShell, you can still create a Log Analytics Free SKU!</p>
<blockquote>
<p>The Free pricing tier is a <a href="https://learn.microsoft.com/en-us/azure/azure-monitor/logs/cost-logs?WT.mc_id=AZ-MVP-5004796#legacy-pricing-tiers" target="_blank" rel="noopener noreferrer">legacy pricing tier</a> that is available for trying Azure Log Analytics. It has a data cap of 500 MB/day and only 7 days of data retention, so it is intended only for testing and is not to be used for production deployments.</p>
</blockquote>
<p>You can change a Free Tier Log Analytics workspace to a Pay-as-you-go or commitment tier later.</p>
<p>You cannot change a Log Analytics workspace created on a higher tier back to Free, even using PowerShell, due to <a href="https://azure.microsoft.com/en-us/blog/introducing-a-new-way-to-purchase-azure-monitoring-services/?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer" title="Introducing a new way to purchase Azure monitoring services">adjustments</a> in 2018 around the Log Analytics billing and plans.</p>
<p><img decoding="async" loading="lazy" alt="Azure Log Analytics - Free" src="/assets/images/log_analytics_free-e00e30f4763f8c161fd71b3089786959.png" width="1403" height="246" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-free-tier-log-analytics-using-powershell">Create a &#x27;Free Tier&#x27; Log Analytics using PowerShell<a href="#create-a-free-tier-log-analytics-using-powershell" class="hash-link" aria-label="Direct link to Create a &#x27;Free Tier&#x27; Log Analytics using PowerShell" title="Direct link to Create a &#x27;Free Tier&#x27; Log Analytics using PowerShell">​</a></h2>
<p>Change the script&#x27;s variables below to suit your environment, connect to Azure and run the script to create your Log Analytics workspace.</p>
<p>Note: I tested this script on an MSDN subscription, which I&#x27;ve had for a few years and a recent one created a few months back <em>(2021)</em>, but there may be limitations on other subscription types that I haven&#x27;t tested <em>- see blurb below the script</em>.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#Connect to Azure</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Connect-AzAccount</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#Set Variables</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ResourceGroup = &#x27;aad_mgmt&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$Location = &#x27;australiaeast&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$LogAnalyticsName = &#x27;la-free&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$SKU = &#x27;Free&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#Creates Log Analytics Workspace</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">New-AzOperationalInsightsWorkspace -Location $Location -Name $LogAnalyticsName -Sku $SKU -ResourceGroupName $ResourceGroup</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>If you get an error: Error Message: Pricing tier doesn&#x27;t match the subscription&#x27;s billing model. Read <a href="http://aka.ms/PricingTierWarning" target="_blank" rel="noopener noreferrer" title="http://aka.ms/PricingTierWarning?WT.mc_id=AZ-MVP-5004796#moving-to-the-new-pricing-model">http://aka.ms/PricingTierWarning</a> for more details, unfortunately it means that your Subscription is under a different Billing model, and may have been created recently are you are unable to use the &#x27;Free&#x27; tier, instead you may have to create it using &#x27;standard&#x27; instead.</p>
</blockquote>
<p><img decoding="async" loading="lazy" alt="Azure Log Analytics - Free" src="/assets/images/log_analytics_free_tier-4d081be6f32051641bc832cade388f62.png" width="980" height="981" class="img_ev3q"></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/2021/07/10/how-to-set-a-log-analytics-data-cap/">How to set a Log Analytics Daily Data Cap</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-07-10T00:00:00.000Z">July 10, 2021</time> · <!-- -->One min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Luke Murray</span></a></div><small class="authorTitle_nd0D" title="Author">Author</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>This is just an additional configuration that may help with sizing and pricing Log Analytics, you can set a &#x27;Daily cap&#x27; for the amount of Data you ingest <strong><em>per day</em></strong>, to help restrict cost.</p>
<p>The downside of this is if you reach the cap, you will no longer collect any data, until the following day, meaning you may miss key events or issues.</p>
<p>This is something that I would recommend ONLY to do if you run into any financial constraints, giving you more time time to work through, of course, situation depending.</p>
<p>This is a pretty quick &#x27;How To&#x27; so let&#x27;s get straight into it:</p>
<ol>
<li>Log in to the <strong>Azure Portal</strong></li>
<li>Search for your Log Analytics Workspace</li>
<li>Select <strong>Usage and estimated costs</strong></li>
<li>Click on <strong>Daily Cap</strong></li>
<li><strong>Set</strong> your <strong>cap</strong> in <strong>GB</strong> <em>(I put 0.166 as my thinking was 5GB per free each month, so 166MB a day, should cap my Log Analytics workspace, although useful for this demo/lab, it&#x27;s not a number I would recommend for Production)</em></li>
<li>Click <strong>Ok</strong></li>
</ol>
<p><img decoding="async" loading="lazy" alt="Log Analytics - Set Daily Cap" src="/assets/images/azportal_loganalyticscap-16aab9a1084af0f510327b973ba34187.png" title="Log Analytics - Set Daily Cap" width="1689" height="634" class="img_ev3q"></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/2021/07/06/create-custom-roles-for-microsoft-azure/">Create Custom Roles for Microsoft Azure</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-07-06T00:00:00.000Z">July 6, 2021</time> · <!-- -->12 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Luke Murray</span></a></div><small class="authorTitle_nd0D" title="Author">Author</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>Microsoft Azure uses Role&#x27;s to define who can access what - Role-Based Access Control (<em>RBAC)</em>.</p>
<p>You may be familiar with some of the more common ones, such as:</p>
<ul>
<li>Owner</li>
<li>Contributor</li>
<li>Reader</li>
</ul>
<p>Behind the scenes, each role is a separate grouping of permissions that determine what level of permissions someone or something has in Azure; these permissions are usually in the form of:</p>
<ul>
<li>Read</li>
<li>Write</li>
<li>Delete</li>
<li>Action</li>
</ul>
<p>Each role can be assigned to a specific Resource, Subscription, Management Group or Resource Group through an &#x27;Assignment&#x27; <em>(you assign a role if you give someone Contributor rights to a Resource Group, for example)</em>.</p>
<p>These permissions can be manipulated and custom roles created.</p>
<blockquote>
<p>Why would you use custom roles you ask? As usual - it depends!</p>
</blockquote>
<p>Custom Roles can give people or objects JUST the right amount of permissions to do what they need to do, nothing more and nothing less, an example of this is maybe you are onboarding a support partner, if they are will only be supporting your Logic Apps, WebApps and Backups, you may not want them to be able to log support cases for your Azure resources; instead of attempting to mash several roles together that may give more or fewer rights than you need, you can create a custom role that specifically gives them what they need, you can then increase or decrease the permissions as needed, however, if a built-in role already exists for what you want. There is no need to reinvent the wheel, so use it!</p>
<p>I will run through a few things to help arm you understand and build your own Custom Roles, primarily using PowerShell.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-the-azure-powershell-modules">Install the Azure PowerShell Modules<a href="#install-the-azure-powershell-modules" class="hash-link" aria-label="Direct link to Install the Azure PowerShell Modules" title="Direct link to Install the Azure PowerShell Modules">​</a></h3>
<p>As a pre-requisite for the following, you need to install the Azure (Az) PowerShell Module. You can skip this section if you already have the PowerShell modules installed.</p>
<ol>
<li>
<p>Open <strong>Windows PowerShell</strong></p>
</li>
<li>
<p>Type <strong>in</strong>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Install-Module -Name Az -Scope CurrentUser -Repository PSGallery -Force</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>If you have issues <strong>installing</strong> the <strong>Azure PowerShell module</strong> - see the Microsoft documentation directly: Install the <a href="https://learn.microsoft.com/en-us/powershell/azure/install-az-ps?view=azps-7.5.0&amp;WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer" title="Install the Azure Az PowerShell module">Azure Az PowerShell module</a>.</p>
</li>
<li>
<p>Once you have the Azure PowerShell module installed, you can <strong>connect to</strong> your <strong>Azure</strong> subscription using the little snippet below:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#Prompts for Azure credentials </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Connect-AzAccount</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#Prompts Window allowing you to select which  Azure Subscription to connect to </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$subscriptionName = (Get-AzSubscription) | Out-GridView -Title &#x27;Select Azure Subscription&#x27; -PassThru | Set-AzContext -SubscriptionName $subscriptionName</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="export-built-in-azure-roles">Export Built-in Azure Roles<a href="#export-built-in-azure-roles" class="hash-link" aria-label="Direct link to Export Built-in Azure Roles" title="Direct link to Export Built-in Azure Roles">​</a></h3>
<p>One of the best ways to learn about how an Azure Role is put together is to look at the currently existing roles.</p>
<ol>
<li>
<p>The following PowerShell command will <strong>list</strong> all <strong>current</strong> Azure <strong>roles</strong>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Get-AzRoleDefinition</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>For a more human-readable view that <strong>lists</strong> the B<strong>uilt-in Azure roles and their descriptions,</strong> you can filter it by:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Get-AzRoleDefinition | Select-Object Name, Description</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>As you can see in the screenshot below, there are many various roles, from EventGrid Contributor to AgFood Platform Service and more! At the time of this article, there were 276 built-in roles.</p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="Azure Builtin Roles" src="/assets/images/az_roledefinitions-fff78907e8017f7dd46c24a57387e876.png" title="Azure Builtin Roles" width="1113" height="907" class="img_ev3q"></p>
</li>
<li>
<p>Now that we have successfully been able to pull a list of the existing roles, we will now <strong>export</strong> them as <strong>JSON</strong> files to take a proper look at them.</p>
</li>
<li>
<p>The PowerShell script below will create a few folders on your computer as a base to work from <em>(feel free to change the folders to suit your folder structure or access rights)</em>.</p>
<ul>
<li>c:\Temp</li>
<li>c:\Temp\AzureRoles</li>
<li>C:\Temp\AzureRoles\BuiltinExports\</li>
<li>C:\Temp\AzureRoles\CustomRoles</li>
</ul>
</li>
<li>
<p>Once the folders have been created, it will Get the Azure Role definitions and export them into JSON into the <strong>BuiltinExports folder</strong> to be reviewed.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">New-Item -ItemType Directory -Path c:\Temp -Force</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">New-Item -ItemType Directory -Path c:\Temp\AzureRoles -Force</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">New-Item -ItemType Directory -Path c:\Temp\AzureRoles\BuiltInExports -Force</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">New-Item -ItemType Directory -Path c:\Temp\AzureRoles\CustomRoles -Force</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$a = Get-AzRoleDefinition</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Foreach ($role in $a)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    $name = $role.Name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Get-AzRoleDefinition -Name ($role).Name | ConvertTo-Json | Out-File c:\Temp\AzureRoles\BuiltInExports\$name.json</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Once completed, you should now <strong>see</strong> the <strong>JSON files</strong> below:</p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="Azure Role - JSON files" src="/assets/images/az_exportroles-64761ffc82b21830748f99bbc45f2d9c.png" title="Azure Role - JSON files" width="803" height="356" class="img_ev3q"></p>
</li>
</ol>
<p><em>Although you can use Notepad, I recommend using</em> <a href="https://code.visualstudio.com/Download" target="_blank" rel="noopener noreferrer"><em>Visual Studio Code</em></a><em>to read these files. This is because Visual Studio Code will help with the syntax as well.</em></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="review-built-in-azure-roles">Review Built-in Azure Roles<a href="#review-built-in-azure-roles" class="hash-link" aria-label="Direct link to Review Built-in Azure Roles" title="Direct link to Review Built-in Azure Roles">​</a></h3>
<p>If you open one of the roles, I will open the Azure Digital Twins Data Owner role; however, it doesn&#x27;t matter.</p>
<p>You should see the following fields:</p>
<ul>
<li>Name</li>
<li>Id</li>
<li>IsCustom</li>
<li>Description</li>
<li>Actions</li>
<li>NotActions</li>
<li>DataActions</li>
<li>NotDataActions</li>
<li>AssignableScopes</li>
</ul>
<p>These fields make up your Role.</p>
<p><img decoding="async" loading="lazy" alt="Azure Role - JSON" src="/assets/images/az_rolereview_azdigitaltwinsdataowner-151b998cd27bc5f2f950093d17203c29.png" title="Azure Role - JSON" width="725" height="437" class="img_ev3q"></p>
<ul>
<li>
<p>The <strong>Name field</strong> is pretty self-explanatory - this is the name of the Azure Role and what you see in the Azure Portal, under Access control (IAM).</p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="Azure Portal - Role" src="data:image/png;base64,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" title="Azure Portal - Role" width="398" height="168" class="img_ev3q"></p>
</li>
<li>
<p>The same is true for the: <strong>Description</strong> <strong>field</strong>.</p>
<p><em>These are essential fields as they should tell the users what resource or resources the role is for and what type of access is granted.</em></p>
</li>
<li>
<p>The <strong>IsCustom field</strong> is used to determine if the Azure Role is a custom made policy or not; any user-created Role will be set to True, while any In-Built role will be False.</p>
</li>
<li>
<p>The <strong>Actions field</strong> is used to determine what management operations can be performed. However, the Azure Digital Twins role doesn&#x27;t have any (as it is mainly Data Action based) if we look at another Role such as the: Azure Kubernetes Service RBAC Admin role:</p>
<ul>
<li>&quot;&quot;Microsoft.Authorization/*/read&quot;,</li>
<li>&quot;Microsoft.Insights/alertRules/*&quot;,</li>
<li>&quot;Microsoft.Resources/deployments/write&quot;,</li>
</ul>
<p>You can see that it has the rights to Read the permissions, create and delete any Alert rules and update resources.</p>
</li>
<li>
<p>The <strong>NotActions field</strong> is used to exclude anything from the Allowed actions</p>
</li>
<li>
<p>The <strong>DataActions field</strong> allows you to determine what data operations can be performed. Usually, these are sub-resource tasks, where management or higher-level operations are performed in the Actions field, more specific resource actions are performed in the DataActions field.</p>
<p>The NotDataActions field is used to exclude anything from the Allowed actions in the DataActions</p>
</li>
</ul>
<p>To help get a feel of the differences with the Actions, here is a list of Actions and DataActions for the Azure Kubernetes Service RBAC Admin role:</p>
<ul>
<li><img decoding="async" loading="lazy" alt="Azure Custom Role - JSON" src="/assets/images/az_rolereview_azkuberservicerbacactions-07a6afc5bb072ae8da4a212b4cb59b06.png" title="Azure Custom Role - JSON" width="625" height="366" class="img_ev3q"></li>
<li>And finally, the <strong>AssignableScopes</strong> is used to specify where the role will be available for assignment, whether it can be assigned at a subscription or resource group or management group level. You will notice that most if not all built-in Azure Roles have an Assignable scope of &quot;/&quot; - this means that it can be assigned everywhere <em>(Subscriptions, Resource Groups, Management Groups etc.).</em></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="review-azure-provider-namespaces">Review Azure Provider Namespaces<a href="#review-azure-provider-namespaces" class="hash-link" aria-label="Direct link to Review Azure Provider Namespaces" title="Direct link to Review Azure Provider Namespaces">​</a></h3>
<p>You may have noticed that each Action has a provider. In the example of a Virtual Machine, the provider is Microsoft.Compute.</p>
<ol>
<li>
<p>To get a <strong>list</strong> of all <strong>current Providers,</strong> run the following command:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Get-AzProviderOperation | Select-Object ProviderNamespace -Unique</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>At the time of writing, there are 198 current Providers! So that&#x27;s 198 providers or overall buckets of resources that has permissions over.</p>
</li>
<li>
<p>We can <strong>drill</strong> into a <strong>provider</strong> a bit <strong>further</strong> to check out current Operations:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Get-AzProviderOperation -Name Microsoft.Compute/*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>This <strong>displays</strong> a <strong>list</strong> of <strong>all providers</strong> within the Microsoft.Compute namespace, such as (but definitely not limited to):</p>
<ol>
<li>Virtual machines</li>
<li>Virtual Machine Scale Sets</li>
<li>Locations</li>
<li>Disks</li>
<li>Cloud Services</li>
</ol>
</li>
<li>
<p>If we wanted to drill into the Virtual Machines <strong>providers</strong> a bit more, we could <strong>filter</strong> it like:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Get-AzProviderOperation -Name Microsoft.Compute/virtualMachines/*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Here we can finally see the available actions, and for example, the following Action will allow you to Read the VM sizes available to a Virtual Machine:</p>
</li>
</ol>
<ul>
<li>Operation: Microsoft.Compute/virtualMachines/vmSizes/read</li>
<li>operation name: Lists Available Virtual Machine Sizes</li>
<li>ProviderNamespace: Microsoft Compute</li>
<li>ResourceName: Virtual Machine Size</li>
<li>Description: Lists available sizes the virtual machine can be updated to</li>
<li>IsDataAction      : False</li>
</ul>
<ol>
<li>
<p>You can use the PowerShell script below to export all the Providers and their Operations to a CSV for review:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$Providers = Get-AzProviderOperation</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$results = @()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ForEach ($Provider in $Providers) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    $results += [pscustomobject]@{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &#x27;Provider NameSpace&#x27; = $Provider.ProviderNamespace</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Description          = $Provider.Description</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &#x27;Operation Name&#x27;     = $Provider.OperationName</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Operation            = $Provider.Operation</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ResourceName         = $Provider.ResourceName</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$results | Export-csv c:\temp\AzureRBACPermissions.csv -NoTypeInformation</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>Using the namespace, providers and actions, you should now be able to see the power behind Role-based access control and how granular you can get.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-a-custom-role-using-powershell">Add a Custom Role using PowerShell<a href="#add-a-custom-role-using-powershell" class="hash-link" aria-label="Direct link to Add a Custom Role using PowerShell" title="Direct link to Add a Custom Role using PowerShell">​</a></h3>
<p>Now that we understand how to navigate the Namespaces and Built-In Roles available in Microsoft Azure using PowerShell, now we will create one.</p>
<p>I have created a base template to help you start.</p>
<p>This base template has the following fields that the majority of most custom roles will use:</p>
<ul>
<li>Name</li>
<li>IsCustom</li>
<li>Description</li>
<li>Actions</li>
<li>AssignableScopes <em>(make sure you put in the <subscriptionid> of your Azure subscription, you are assigning the role to.)</subscriptionid></em></li>
</ul>
<ol>
<li><strong>Edit</strong> these <strong>fields</strong> <em>(apart from IsCustom, which you should leave as True)</em> as you need.</li>
</ol>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_Ktv7">CustomRoleTemplate.json</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;properties&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;roleName&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Custom Role - Template&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;IsCustom&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;description&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;This is a Template for creating Custom Roles.&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;assignableScopes&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/subscriptions/&lt;SubscriptionID&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;permissions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token property">&quot;actions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/register/action&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/checkNameAvailability/action&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/operationresults/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/operationsstatus/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/operations/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/services/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/services/problemClassifications/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/supportTickets/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/supportTickets/write&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Resources/subscriptions/resourceGroups/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Resources/subscriptions/resourcegroups/resources/read&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token property">&quot;notActions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token property">&quot;dataActions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token property">&quot;notDataActions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This Custom Role - Template allows you to read the name of all Resource Groups in a subscription and open a Microsoft Support case.</p>
<p>In my example, I am going to add a new role called:</p>
<ul>
<li>LukeGeek-WebApp Deployment-RW</li>
</ul>
<p>This role will allow users to Deploy and modify Azure WebApps, among other things!</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_Ktv7">LukeGeekWebDeployment-RW.json</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;properties&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;roleName&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Custom Role - Template&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;description&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;This is a Template for creating Custom Roles.&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         </span><span class="token property">&quot;IsCustom&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;assignableScopes&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/subscriptions/&lt;SubscriptionID&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;permissions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token property">&quot;actions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/register/action&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/checkNameAvailability/action&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/operationresults/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/operationsstatus/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/operations/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/services/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/services/problemClassifications/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/supportTickets/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Support/supportTickets/write&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Resources/subscriptions/resourceGroups/read&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Microsoft.Resources/subscriptions/resourcegroups/resources/read&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token property">&quot;notActions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token property">&quot;dataActions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token property">&quot;notDataActions&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol>
<li>
<p>To <strong>add</strong> the <strong>Custom Role</strong> to Azure, I will <strong>run</strong> the following <strong>PowerShell</strong> command:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">New-AzRoleDefinition -InputFile &quot;C:\\temp\\AzureRoles\\CustomRoles\\LukeGeek-WebApp Deployment-RW.json&quot; -Verbose</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p><strong>Your new Custom Role has now been uploaded to Azure and can be selected for an assignment.</strong></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-a-custom-role-using-the-azure-portal">Add a Custom Role using the Azure Portal<a href="#add-a-custom-role-using-the-azure-portal" class="hash-link" aria-label="Direct link to Add a Custom Role using the Azure Portal" title="Direct link to Add a Custom Role using the Azure Portal">​</a></h3>
<p>Now that we have been through and investigated the Azure roles and their providers and actions, instead of using PowerShell to look through and create manually, you can use the Azure Portal!</p>
<blockquote>
<p><em><em>Gasp!</em> Why didn&#x27;t you tell me earlier about this, Luke?</em></p>
<p><em>Well, fellow Azure administrator, I found it easier to look at PowerShell and JSON to explain how the Custom Roles were made, vs staring at the Azure Portal and to be honest, really just because! Like most things in IT there are multiple ways something can be done!</em></p>
</blockquote>
<ol>
<li>Log in to the <strong>Azure Portal</strong></li>
<li>Navigate to your <strong>Subscription</strong></li>
<li>Click on <strong>Access Control (IAM)</strong> on the left-hand side blade</li>
<li>Click on <strong>Add</strong></li>
<li>Click on <strong>Add Custom Role</strong></li>
<li>Type in the <strong>Role Name</strong>, for example, WebAdmin-RO</li>
<li>Type in a clear <strong>description</strong> so that you can remember what this role is used for in a year!</li>
<li>For Baseline permissions, select: <strong>Start from Scratch</strong></li>
<li>Click <strong>Next</strong></li>
<li>Click <strong>Add Permissions</strong></li>
<li>If you want, you can select: Download all permissions to review the providers and actions <em>(very similar to the Get-AzProviderOperation PowerShell command)</em>.<img decoding="async" loading="lazy" alt="Azure Portal - Create Custom Role" src="/assets/images/ad_role_addpermissions-0278703408d158c4db94a595c5fd2bde.png" title="Azure Portal - Create Custom Role" width="747" height="596" class="img_ev3q"></li>
<li>As you should <strong>see</strong>, all the <strong>Namespace providers</strong> are listed with the Actions/Permissions that you can do.</li>
<li>In my example, I am going to search for <strong>Microsoft Web Apps</strong></li>
<li><strong>Select</strong> all &#x27;<strong>Read</strong>&#x27; operations <em>(remember to look at Data Actions as well, there may be resource level actions you might want to allow or exclude)</em></li>
<li>Click <strong>Add</strong></li>
<li><img decoding="async" loading="lazy" alt="Azure Portal - Create Custom Role" src="/assets/images/ad_role_webpermissions-e018979c285f779b5e7e38270ed47f86.png" title="Azure Portal - Create Custom Role" width="1090" height="942" class="img_ev3q"></li>
<li>Review the permissions and click <strong>Next</strong></li>
<li><strong>Select</strong> your assignable <strong>scope</strong> <em>(where the Role will be allowed so that you can assign it)</em></li>
<li>Click <strong>Next</strong></li>
<li>You can <strong>review</strong> and download the JSON for backup later <em>(this is handy if you are going to Automate the creation of roles in the future and want a base to start from)</em></li>
<li>Click <strong>Next</strong></li>
<li>Click <strong>Create to create your Custom Role!</strong></li>
<li><img decoding="async" loading="lazy" alt="Azure Portal - Create Custom Role" src="/assets/images/ad_role_createcustomroleportal-d2a9ae3b4c8fd50d676e21ffebdae8c7.png" title="Azure Portal - Create Custom Role" width="1003" height="826" class="img_ev3q"></li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="assign-a-custom-role-using-the-azure-portal">Assign a Custom Role using the Azure Portal<a href="#assign-a-custom-role-using-the-azure-portal" class="hash-link" aria-label="Direct link to Assign a Custom Role using the Azure Portal" title="Direct link to Assign a Custom Role using the Azure Portal">​</a></h3>
<p>Now that you have created your Custom Role - it is time to assign it! So it is actually in use.</p>
<ol>
<li>Log in to the <strong>Azure Portal</strong></li>
<li>Navigate to your <strong>Subscription or Resource Group</strong> you want to delegate this role to</li>
<li>Click on <strong>Access Control (IAM)</strong></li>
<li>Click <strong>Add</strong></li>
<li>Click on <strong>Role Assignment</strong></li>
<li>Under the &#x27;Role&#x27; dropdown, <strong>select</strong> your Custom <strong>Role.</strong></li>
<li><img decoding="async" loading="lazy" alt="Azure Portal - Add Role Assignments" src="/assets/images/ad_roleassignmentportal-06b0eb5d3a8c93ca719e5e71dac491e2.png" title="Azure Portal - Add Role Assignments" width="354" height="958" class="img_ev3q"></li>
<li>Now you can <strong>select</strong> the <strong>Azure AD Group/User or Service Principal</strong> you want to <strong>assign</strong> the role to and click <strong>Save.</strong></li>
<li>Congratulations, <strong>you have now assigned your Custom role!</strong></li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="assign-a-custom-role-using-powershell">Assign a Custom Role using PowerShell<a href="#assign-a-custom-role-using-powershell" class="hash-link" aria-label="Direct link to Assign a Custom Role using PowerShell" title="Direct link to Assign a Custom Role using PowerShell">​</a></h3>
<p>You can assign Custom Role&#x27;s using PowerShell. To do this, you need a few things such as the Object ID, Assignable Scope IDs etc., instead of rehashing it, this Microsoft article does an excellent job of running through the process.</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/role-based-access-control/role-assignments-powershell?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer" title="Assign Azure roles using Azure PowerShell">Assign Azure roles using Azure PowerShell</a></li>
</ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/page/31/"><div class="pagination-nav__label">Newer entries</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/page/33/"><div class="pagination-nav__label">Older entries</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 luke.geek.nz. Powered by coffee, clouds and hamsters on wheels!</div></div></div></footer></div>
</body>
</html>