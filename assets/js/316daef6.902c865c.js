"use strict";(self.webpackChunklukemurraynz=self.webpackChunklukemurraynz||[]).push([[19259],{59991:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>r,toc:()=>u});var r=t(53658),s=t(74848),a=t(28453);const o={title:"Azure Storage Account SFTP errors",description:"As part of standing up and using an Azure Storage account as an SFTP service, I ran into a few issues. This blog post is merely intended to show my find...",authors:["Luke"],tags:["Azure"],date:"2021-12-27 00:00:00 +1300",toc:!0,header:{teaser:"images/iazure-marketplace-banner.png"},slug:"azure/azure-storage-account-sftp-errors"},i=void 0,l={authorsImageUrls:[void 0]},u=[{value:"PTY allocation request failed on channel 0",id:"pty-allocation-request-failed-on-channel-0",level:4},{value:"Home Directory is not accessible",id:"home-directory-is-not-accessible",level:4},{value:"Wrong username, authentication failed",id:"wrong-username-authentication-failed",level:4},{value:"Unable to find Azure Storage SSH Keys",id:"unable-to-find-azure-storage-ssh-keys",level:4}];function c(e){const n={a:"a",em:"em",h4:"h4",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"As part of standing up and using an Azure Storage account as an SFTP service, I ran into a few issues. This blog post is merely intended to show my findings in case others run into similar issues."}),"\n",(0,s.jsx)(n.h4,{id:"pty-allocation-request-failed-on-channel-0",children:"PTY allocation request failed on channel 0"}),"\n",(0,s.jsx)(n.p,{children:"Even though you appear to have connected successfully, you may see the following errors:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"PTY allocation request failed on channel 0"}),"\n",(0,s.jsx)(n.li,{children:"shell request failed on channel 0"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["You may laugh, but the solution for this was very simple, switch from SSH to ",(0,s.jsx)(n.strong,{children:"SFTP"}),"!"]}),"\n",(0,s.jsx)(n.p,{children:"If you were like me, I just flicked to SSH as a habit."}),"\n",(0,s.jsx)(n.h4,{id:"home-directory-is-not-accessible",children:"Home Directory is not accessible"}),"\n",(0,s.jsxs)(n.p,{children:["Make sure that the Home directory ",(0,s.jsx)(n.em,{children:"(Folder)"})," is created in your container, SFTP won't create this for you."]}),"\n",(0,s.jsx)(n.p,{children:"Also make sure that the Home directory for the user, references Container/Folder, like the below:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Azure Portal - Enable SFTP",src:t(48487).A+"",title:"Azure Portal - Enable SFTP",width:"565",height:"331"})}),"\n",(0,s.jsx)(n.h4,{id:"wrong-username-authentication-failed",children:"Wrong username, authentication failed"}),"\n",(0,s.jsx)(n.p,{children:"When attempting to connect to SFTP using a tool such as WinSCP, I got:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:'Using username "lukeftpuser".'}),"\n",(0,s.jsx)(n.li,{children:"Authentication failed."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The username is actually comprised of:"}),"\n",(0,s.jsx)(n.p,{children:"STORAGEACCOUNTNAME+FTPNAME, ie: sftpstorageacc1337.lukeftpuser"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"WinSCP Connection Azure SFTP",src:t(34270).A+"",title:"WinSCP Connection Azure SFTP",width:"1076",height:"693"})}),"\n",(0,s.jsx)(n.h4,{id:"unable-to-find-azure-storage-ssh-keys",children:"Unable to find Azure Storage SSH Keys"}),"\n",(0,s.jsxs)(n.p,{children:["This is not an error, but Azure Keyvault, does not currently support SSH keypairs, so once they are created by Azure, they are stored in a Microsoft.Compute.sshPublicKeys resource found here: ",(0,s.jsx)(n.a,{href:"https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FsshPublicKeys",title:"SSH Keys",children:"SSH Keys"})]})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},48487:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/AzurePortal_SFTPLocalUsercreate-c78a42d5f6be4b35f07b68f984890d4a.png"},34270:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/sftp_winscptest-d3c15f460193e1dc9aa4548582c06d19.png"},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>i});var r=t(96540);const s={},a=r.createContext(s);function o(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(a.Provider,{value:n},e.children)}},53658:e=>{e.exports=JSON.parse('{"permalink":"/azure/azure-storage-account-sftp-errors","source":"@site/blog/2021-12-27-azure-storage-account-sftp-errors.md","title":"Azure Storage Account SFTP errors","description":"As part of standing up and using an Azure Storage account as an SFTP service, I ran into a few issues. This blog post is merely intended to show my find...","date":"2021-12-27T00:00:00.000Z","tags":[{"inline":true,"label":"Azure","permalink":"/tags/azure"}],"readingTime":1.22,"hasTruncateMarker":false,"authors":[{"name":"Luke Murray","title":"Author","url":"https://luke.geek.nz","imageURL":"https://luke.geek.nz/img/logo.png","key":"Luke","page":null}],"frontMatter":{"title":"Azure Storage Account SFTP errors","description":"As part of standing up and using an Azure Storage account as an SFTP service, I ran into a few issues. This blog post is merely intended to show my find...","authors":["Luke"],"tags":["Azure"],"date":"2021-12-27 00:00:00 +1300","toc":true,"header":{"teaser":"images/iazure-marketplace-banner.png"},"slug":"azure/azure-storage-account-sftp-errors"},"unlisted":false,"prevItem":{"title":"Day in the Life of a Technical Lead","permalink":"/2021/12/29/day-in-the-life-of-a-tech-lead"},"nextItem":{"title":"SFTP in Microsoft Azure using Azure Blob Storage","permalink":"/azure/sftp-in-microsoft-azure-using-azure-blob-storage"}}')}}]);