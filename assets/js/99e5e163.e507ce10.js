"use strict";(self.webpackChunklukemurraynz=self.webpackChunklukemurraynz||[]).push([[33064],{25422:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>c});var t=r(38241),o=r(74848),s=r(28453);const i={date:"2022-06-06 00:00:00 +1200",title:"You don\u2019t have authorization to perform action 'Microsoft.Resources/deployments/validate/action'",authors:["Luke"],tags:["Azure"],toc:!1,header:{teaser:"images/iazure-marketplace-banner.png"},slug:"azure/you-don-t-have-authorization-to-perform-action-microsoft.resources-deployments-validate-action"},a=void 0,l={authorsImageUrls:[void 0]},c=[];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"You may be attempting to deploy an Azure Landing Zone, such as the Enterprise Scale Landing Zone and receive the following error:"}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsx)(n.p,{children:"You don\u2019t have authorization to perform action 'Microsoft.Resources/deployments/validate/action'."}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"This is because by default, even if you have Owner right on an Azure subscription, and are a Global Administer, you are unable to assign rights at the root '/' tenant level, to be able to create new Management Groups and move subscriptions between them."}),"\n",(0,o.jsxs)(n.p,{children:["However, users who have the Global Microsoft Entra ID role can elevate rights to do this.  There are a few steps to enabling this, including using ",(0,o.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/powershell/azure/what-is-azure-powershell?WT.mc_id=AZ-MVP-5004796",title:"Azure PowerShell",children:"Azure PowerShell"})," to assign rights."]}),"\n",(0,o.jsx)(n.p,{children:"With an account with Global Administrator rights, do the following:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Sign in to the ",(0,o.jsx)(n.strong,{children:"Azure Portal"})]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Open ",(0,o.jsx)(n.strong,{children:"Microsoft Entra ID"})]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Click ",(0,o.jsx)(n.strong,{children:"Properties"})]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Toggle the '",(0,o.jsx)(n.strong,{children:"Access management for Azure resources"}),"' to '",(0,o.jsx)(n.strong,{children:"Yes"}),"'"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Click ",(0,o.jsx)(n.strong,{children:"Save"})]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Open ",(0,o.jsx)(n.strong,{children:"PowerShell"})]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Run:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"Connect-AzAccount\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Login with your ",(0,o.jsx)(n.strong,{children:"account"}),", and make sure you are in the correct directory ",(0,o.jsx)(n.em,{children:"(if you aren't you can use Connect-Az Account - tenantid 'tenantidhere')"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Type"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"Get-AzADUser\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Copy"})," the ",(0,o.jsx)(n.strong,{children:"ID"})," of the user you are logged in as, and ",(0,o.jsx)(n.strong,{children:"run"})," the following ",(0,o.jsx)(n.em,{children:"(replace the ObjectId to match the ID of your user)"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"$user =  Get-AzADUser -ObjectId f53eaa59-0fc0-4103-b9cb-1650e3069da8\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Once the user ID has been stored in a variable, its finally time to assign the rights, ",(0,o.jsx)(n.strong,{children:"run"})," the following:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"New-AzRoleAssignment -Scope '/' -RoleDefinitionName 'Owner' -ObjectId $user.Id\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Give Microsoft Entra ID ",(0,o.jsx)(n.strong,{children:"10-15 minutes"})," to ",(0,o.jsx)(n.strong,{children:"replicate"})," the Azure AD changes, ",(0,o.jsx)(n.strong,{children:"log out"})," and ",(0,o.jsx)(n.strong,{children:"back in"})," and you should now be able to ",(0,o.jsx)(n.strong,{children:"deploy"})," the ",(0,o.jsx)(n.strong,{children:"Landing Zone"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Note: Remember to go back and change the toggle to 'Allow management of Azure resources' to 'No', or all Global Administrators of Microsoft Entra ID will be able to manage all Azure resources."})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Once the Landing Zone is deployed, you should also remove your role assignment at the root level by running:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"Remove-AzRoleAssignment -Scope '/' -RoleDefinitionName 'Owner' -ObjectId $user.Id\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>a});var t=r(96540);const o={},s=t.createContext(o);function i(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),t.createElement(s.Provider,{value:n},e.children)}},38241:e=>{e.exports=JSON.parse('{"permalink":"/azure/you-don-t-have-authorization-to-perform-action-microsoft.resources-deployments-validate-action","source":"@site/blog/2022-06-06-you-don-t-have-authorization-to-perform-action-microsoft.resources-deployments-validate-action.md","title":"You don\u2019t have authorization to perform action \'Microsoft.Resources/deployments/validate/action\'","description":"You may be attempting to deploy an Azure Landing Zone, such as the Enterprise Scale Landing Zone and receive the following error:","date":"2022-06-06T00:00:00.000Z","tags":[{"inline":true,"label":"Azure","permalink":"/tags/azure"}],"readingTime":1.75,"hasTruncateMarker":false,"authors":[{"name":"Luke Murray","title":"Author","url":"https://luke.geek.nz","imageURL":"https://luke.geek.nz/img/logo.png","key":"Luke","page":null}],"frontMatter":{"date":"2022-06-06 00:00:00 +1200","title":"You don\u2019t have authorization to perform action \'Microsoft.Resources/deployments/validate/action\'","authors":["Luke"],"tags":["Azure"],"toc":false,"header":{"teaser":"images/iazure-marketplace-banner.png"},"slug":"azure/you-don-t-have-authorization-to-perform-action-microsoft.resources-deployments-validate-action"},"unlisted":false,"prevItem":{"title":"Microsoft Azure Portal - Recent Resources","permalink":"/2022/06/12/microsoft-azure-portal-recent-resources"},"nextItem":{"title":"Turn on a Azure Virtual Machine using Azure Automation","permalink":"/azure/turn-on-a-azure-virtual-machine-using-azure-automation"}}')}}]);