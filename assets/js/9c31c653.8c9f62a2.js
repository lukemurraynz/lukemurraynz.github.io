"use strict";(self.webpackChunklukemurraynz=self.webpackChunklukemurraynz||[]).push([[4836],{15489:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>r,toc:()=>c});var r=t(27823),i=t(74848),o=t(28453);const s={title:"Create a Public Holidays API using Microsoft Azure",authors:["Luke"],tags:["Azure"],date:"2022-08-09 00:00:00 +1300",toc:!0,header:{teaser:"/uploads/azureportal_storagebrowser_api_table.png"}},a=void 0,l={authorsImageUrls:[void 0]},c=[{value:"Overview",id:"overview",level:3},{value:"Pre-requisites",id:"pre-requisites",level:4},{value:"Deployment",id:"deployment",level:3},{value:"Create Resource Group",id:"create-resource-group",level:4},{value:"Create Storage Account",id:"create-storage-account",level:4},{value:"Import Public Holiday data",id:"import-public-holiday-data",level:4},{value:"Create Azure Storage Account Table",id:"create-azure-storage-account-table",level:5},{value:"Import Public Holiday Data into Table",id:"import-public-holiday-data-into-table",level:5},{value:"Create API",id:"create-api",level:4},{value:"Create Azure Function",id:"create-azure-function",level:5},{value:"Configure Environment Variables",id:"configure-environment-variables",level:5},{value:"Configure Managed Identity",id:"configure-managed-identity",level:5},{value:"Configure Requirements",id:"configure-requirements",level:5},{value:"Create Function PublicHolidays",id:"create-function-publicholidays",level:5},{value:"Test Function - PublicHolidays",id:"test-function---publicholidays",level:5},{value:"Configure Azure API Management",id:"configure-azure-api-management",level:5}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h3:"h3",h4:"h4",h5:"h5",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["Using a previous ",(0,i.jsx)(n.a,{href:"https://luke.geek.nz/azure/turn-on-a-azure-virtual-machine-using-azure-automation/",title:"Turn on a Azure Virtual Machine using Azure Automation",children:"blog post"})," I did on using a third-party API ",(0,i.jsx)(n.em,{children:"(Application Programming Interface)"})," to start a Virtual Machine when it wasn't a Public Holiday, I had a thought on what could be an option if I wanted an API only accessible on an internal network or if I wanted to include custom Holidays such as Star Wars day or company holidays? Could I create and query my API using Microsoft Azure services? You can!"]}),"\n",(0,i.jsx)(n.h3,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Today we will create a base Public Holidays API using several Microsoft Azure serverless services, such as Azure Function, Azure Storage Account and API Management."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"Note: As this is a demonstration, I will be using a"})," ",(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/azure-functions/functions-scale?WT.mc_id=AZ-MVP-5004796",title:"Azure Functions hosting options",children:(0,i.jsx)(n.em,{children:"Consumption-based Azure Function"})})," ",(0,i.jsx)(n.em,{children:"and Azure storage account, and although it is a good place to start - depending on your requirements, you may be better off with Azure Function Premium Plan to avoid cold-start times, and if you need a high amount of requests and writes (GET and POSTs) and resiliency, then replace the Storage account table with a"})," ",(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/cosmos-db/introduction?WT.mc_id=AZ-MVP-5004796",title:"Azure Cosmos DB",children:(0,i.jsx)(n.em,{children:"Cosmos DB"})}),(0,i.jsx)(n.em,{children:"."})]}),"\n",(0,i.jsx)(n.p,{children:"The solution will be made up of the following:"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Azure Service"}),(0,i.jsx)(n.th,{children:"Name"}),(0,i.jsx)(n.th,{children:"Plan"}),(0,i.jsx)(n.th,{children:"Note"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Application Insights"}),(0,i.jsx)(n.td,{children:"ai-nzPublicHolidays-prd-ae"}),(0,i.jsx)(n.td,{}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Azure API Management"}),(0,i.jsx)(n.td,{children:"apims-publicholidays-prd-ae"}),(0,i.jsx)(n.td,{children:"Developer (No SLA)"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Azure Function"}),(0,i.jsx)(n.td,{children:"func-nzpublicHolidays-prd-ae"}),(0,i.jsx)(n.td,{children:"Function App - Consumption"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Azure Storage Account"}),(0,i.jsx)(n.td,{children:"funcnzpublicholidaystgac"}),(0,i.jsx)(n.td,{children:"StorageV2 (general purpose v2) - Locally-redundant storage (LRS)"}),(0,i.jsx)(n.td,{children:"Contains 'PublicHolidays' table"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Azure Storage Account"}),(0,i.jsx)(n.td,{children:"rgnzpublicholidayspb4ed"}),(0,i.jsx)(n.td,{children:"Storage (general purpose v1)  - Locally-redundant storage (LRS)"}),(0,i.jsx)(n.td,{children:"Contains Azure Functions App Files"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Resource Group"}),(0,i.jsx)(n.td,{children:"rg-publicholidays-prd-ae"}),(0,i.jsx)(n.td,{}),(0,i.jsx)(n.td,{children:"Resource Group - containing above resources."})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Azure Resource Group - Diagram",src:t(48374).A+"",title:"Azure Resource Group - Diagram",width:"2805",height:"300"})}),"\n",(0,i.jsx)(n.h4,{id:"pre-requisites",children:"Pre-requisites"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["An Azure subscription ",(0,i.jsx)(n.em,{children:"(with at least Contributor rights to a Resource Group)"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Azure PowerShell modules ",(0,i.jsx)(n.em,{children:"("}),(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/powershell/module/az.accounts/?view=azps-8.2.0&WT.mc_id=AZ-MVP-5004796",title:"Az.Accounts",children:(0,i.jsx)(n.em,{children:"Az.Accounts"})}),(0,i.jsx)(n.em,{children:","})," ",(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/powershell/module/az.storage/?view=azps-8.2.0&WT.mc_id=AZ-MVP-5004796",title:"Az.Storage",children:(0,i.jsx)(n.em,{children:"Az.Storage"})})," ",(0,i.jsx)(n.em,{children:"&"})," ",(0,i.jsx)(n.a,{href:"https://www.powershellgallery.com/packages/AzTable/",title:"AzTable",children:(0,i.jsx)(n.em,{children:"AzTables"})}),(0,i.jsx)(n.em,{children:")"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Note: AzTables is not part of the standard Az PowerShell module set and is a separate module you will need to install (Install-Module AzTables)."})}),"\n",(0,i.jsxs)(n.p,{children:["We will use a mix of the Azure Portal and PowerShell to deploy this solution from start to finish; you can find the source data and code directly in the GitHub repository here: ",(0,i.jsx)(n.a,{href:"https://github.com/lukemurraynz/PublicHoliday-API",title:"PublicHoliday-API",children:"lukemurraynz/PublicHoliday-API"})," for reference ",(0,i.jsx)(n.em,{children:"(feel free to fork, raise pull requests etc.)."})," In this guide, I will try not to assume preexisting knowledge ",(0,i.jsx)(n.em,{children:"(other than general Azure and PowerShell knowledge)"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"deployment",children:"Deployment"}),"\n",(0,i.jsx)(n.p,{children:"The deployment steps will be separated into different sections to help simplify implementation."}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["First, make sure you adjust the names of your resources and locations to suit your naming conventions and regional locations ",(0,i.jsx)(n.em,{children:"(such as Australia East or West Europe)"}),'. Your deployments may fail if a name is already in use. See "',(0,i.jsx)(n.a,{href:"https://luke.geek.nz/azure/microsoft-azure-naming-conventions/",title:"Microsoft Azure Naming Conventions ",children:"Microsoft Azure Naming Conventions"}),'" for more about Naming conventions.']}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"create-resource-group",children:"Create Resource Group"}),"\n",(0,i.jsx)(n.p,{children:"The Resource Group will contain all resources related to the API that we will deploy today."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"However, I recommend you consider what resources might be shared outside of this API - such as API Management, and put them in a separate Shared or Common Resource Group, to keep the li.e.ecycle of your resources together (ie API resources all in one place, so if it gets decommissioned, it is as easy a deleting the Resource Group)."})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Log in to the ",(0,i.jsx)(n.a,{href:"https://portal.azure.com/#home",title:"Microsoft Azure Portal",children:(0,i.jsx)(n.strong,{children:"Microsoft Azure Portal"})})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Click on the burger and click"})," ",(0,i.jsx)(n.a,{href:"https://portal.azure.com/#view/HubsExtension/BrowseResourceGroups",title:"Resource Groups",children:(0,i.jsx)(n.strong,{children:"Resource groups"})})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"+ Create"})]}),"\n",(0,i.jsxs)(n.li,{children:["Select your ",(0,i.jsx)(n.strong,{children:"Subscription"})]}),"\n",(0,i.jsxs)(n.li,{children:["Type in a name for your ",(0,i.jsx)(n.strong,{children:"Resource Group"})," ",(0,i.jsx)(n.em,{children:"(like 'rg-publicholidays-prd-ae')"})]}),"\n",(0,i.jsxs)(n.li,{children:["Select your ",(0,i.jsx)(n.strong,{children:"Region"})," and click ",(0,i.jsx)(n.strong,{children:"Next: Tags"})]}),"\n",(0,i.jsxs)(n.li,{children:["Enter in applicable ",(0,i.jsx)(n.strong,{children:"tags"})," ",(0,i.jsx)(n.em,{children:"(i.e. Application: Public Holidays API)"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Next: Review + create"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Create"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Create a resource group",src:t(11221).A+"",title:"Create a resource group",width:"736",height:"374"})}),"\n",(0,i.jsx)(n.p,{children:"If you prefer PowerShell, you can deploy a new Resource Group with the below:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"New-AzResourceGroup -Name 'rg-publicholidays-prd-ae' -Location 'Australia East' -Tag @{Application=\"Public Holidays API\"}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"create-storage-account",children:"Create Storage Account"}),"\n",(0,i.jsx)(n.p,{children:"Now that the Resource Group has been created, it's time to import our Storage Account - which will hold our Table of data around Public Holidays."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Log in to the ",(0,i.jsx)(n.a,{href:"https://portal.azure.com/#home",title:"Microsoft Azure Portal",children:(0,i.jsx)(n.strong,{children:"Microsoft Azure Portal"})})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Click on the burger and click"})," ",(0,i.jsx)(n.a,{href:"https://portal.azure.com/#view/HubsExtension/BrowseResource/resourceType/Microsoft.Storage%2FStorageAccounts",title:"Storage accounts",children:(0,i.jsx)(n.strong,{children:"Storage Accounts"})})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"+ Create"})]}),"\n",(0,i.jsxs)(n.li,{children:["Select the ",(0,i.jsx)(n.strong,{children:"Subscription"})," and ",(0,i.jsx)(n.strong,{children:"Resource Group"})," you created earlier"]}),"\n",(0,i.jsxs)(n.li,{children:["Enter in a ",(0,i.jsx)(n.strong,{children:"Name"})," for your ",(0,i.jsx)(n.strong,{children:"Storage Account"})," (",(0,i.jsx)(n.em,{children:"like 'funcnzpublicholidaystgac')"})]}),"\n",(0,i.jsxs)(n.li,{children:["Select your ",(0,i.jsx)(n.strong,{children:"Region"})," ",(0,i.jsx)(n.em,{children:"(i.e. Australia East)"})]}),"\n",(0,i.jsxs)(n.li,{children:["For ",(0,i.jsx)(n.strong,{children:"Performance"}),", I am going to select: ",(0,i.jsx)(n.strong,{children:"Standard"})]}),"\n",(0,i.jsxs)(n.li,{children:["For ",(0,i.jsx)(n.strong,{children:"Redundancy"}),", as this is a demo, I will select ",(0,i.jsx)(n.strong,{children:"Locally-redundant storage (LRS). However, if"})," you plan on running this in production, you may consider ZRS for zone redundancy."]}),"\n",(0,i.jsxs)(n.li,{children:["If you plan on locking down the Storage Account to your Virtual Network or specific IP addresses, continue to the Networking Tab; we can accept the defaults and click: ",(0,i.jsx)(n.strong,{children:"Review"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Create"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"If you prefer PowerShell, you can deploy a new Storage account with the below:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"New-AzStorageAccount -ResourceGroupName 'rg-publicholidays-prd-ae' -Name 'funcnzpublicholidaystgac' -Location 'Australia East' -SkuName 'Standard_LRS' -Kind StorageV2\n"})}),"\n",(0,i.jsx)(n.h4,{id:"import-public-holiday-data",children:"Import Public Holiday data"}),"\n",(0,i.jsx)(n.h5,{id:"create-azure-storage-account-table",children:"Create Azure Storage Account Table"}),"\n",(0,i.jsx)(n.p,{children:"Now that we have the Storage account that will hold our Public Holiday time to import the data."}),"\n",(0,i.jsx)(n.p,{children:"Most of this task will be done with PowerShell, but first, we need to create the Table that will hold our Public Holidays."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Log in to the ",(0,i.jsx)(n.a,{href:"https://portal.azure.com/#home",title:"Microsoft Azure Portal",children:(0,i.jsx)(n.strong,{children:"Microsoft Azure Portal"})})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Click on the burger and click"})," ",(0,i.jsx)(n.a,{href:"https://portal.azure.com/#view/HubsExtension/BrowseResource/resourceType/Microsoft.Storage%2FStorageAccounts",title:"Storage accounts",children:(0,i.jsx)(n.strong,{children:"Storage Accounts"})})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Navigate"})," to your created ",(0,i.jsx)(n.strong,{children:"Storage"})," account"]}),"\n",(0,i.jsxs)(n.li,{children:["In the Navigation blade, click ",(0,i.jsx)(n.strong,{children:"Tables"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"+ Table"})]}),"\n",(0,i.jsxs)(n.li,{children:["For a Table Name, I will go with ",(0,i.jsx)(n.strong,{children:"PublicHolidays"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Ok"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Create Azure Storage Account Table",src:t(14150).A+"",title:"Create Azure Storage Account Table",width:"753",height:"521"})}),"\n",(0,i.jsx)(n.p,{children:"You can use PowerShell to create the Table below:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"$storageAccount = Get-AzStorageAccount -ResourceGroupName 'rg-publicholidays-prd-ae' -Name 'funcnzpublicholidaystgac'\n$storageContext = $storageAccount.Context\nNew-AzStorageTable -Name 'PublicHolidays' -Context $storageContext\n"})}),"\n",(0,i.jsx)(n.h5,{id:"import-public-holiday-data-into-table",children:"Import Public Holiday Data into Table"}),"\n",(0,i.jsx)(n.p,{children:"Now that we have the Azure storage account and PublicHolidays table, it's time to import the data."}),"\n",(0,i.jsx)(n.p,{children:"If you want to do this manually, the Azure Table will have the following columns:"}),"\n",(0,i.jsx)(n.p,{children:"| Date | Country | Type | Name | Day | Year | Comments |"}),"\n",(0,i.jsxs)(n.p,{children:["We could enter the data manually, but I will leverage the Nager API to download and parse a CSV file for a few countries. You can find the source data and code directly in the GitHub repository here: ",(0,i.jsx)(n.a,{href:"https://github.com/lukemurraynz/PublicHoliday-API",title:"PublicHoliday-API",children:"lukemurraynz/PublicHoliday-API"})," for reference."]}),"\n",(0,i.jsx)(n.p,{children:"To do this, we will need PowerShell, so assuming you have logged into PowerShell and set the context to your Azure subscription, let us continue."}),"\n",(0,i.jsxs)(n.p,{children:["I have created a CSV ",(0,i.jsx)(n.em,{children:"(Comma-separated values)"})," file with a list of countries ",(0,i.jsx)(n.em,{children:"(i.e. US, NZ, AU)"})," called 'SourceTimeDate.CSV', but you can adjust this to suit your requirements and place it in a folder on my C:\\ drive called: Temp\\API."]}),"\n",(0,i.jsxs)(n.p,{children:["Open ",(0,i.jsx)(n.strong,{children:"PowerShell"})," and ",(0,i.jsx)(n.strong,{children:"run"})," the following:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'$Folder = \'C:\\Temp\\API\\\'\n$Csv = Import-csv "$Folder\\DateTimeSource\\SourceTimeDate.csv"\n$CurrentYear = (Get-Date).Year\n\n   ForEach ($Country in $Csv)\n  {\n$CountryCode = $Country.Country\nInvoke-WebRequest -Uri "https://date.nager.at/PublicHoliday/Country/$CountryCode/$CurrentYear/CSV" -OutFile "$FolderAPI\\DateTimeSource\\Country$CountryCode$CurrentYear.csv" \n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["These cmdlets will download a bunch of CSV files into the API folder, with the Public Holidays for each Country for this year, and then you can adjust the $CurrentYear variable for future years ",(0,i.jsx)(n.em,{children:"(i.e. 2025)"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Once you have all the CSV files for your Public Holidays and before we import the data into the Azure storage table, now is the time to create a new Custom Holidays CSV; you can easily use an existing one to create a new CSV containing your company's public holidays or other days that may be missing from the standard list, make sure it matches the correct format and save it into the same folder."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Custom Public Holidays API",src:t(94813).A+"",title:"Custom Public Holidays API",width:"723",height:"159"})}),"\n",(0,i.jsx)(n.p,{children:"Now that you have all your CSV files containing the Public Holidays in your Country or countries, it's time to import them into the Azure Table. First, we import the data using a PowerShell session logged into Azure."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'# Imports Public Holiday into Azure Storage table\n# Requires AzTable Module (not part of the normal Az cmdlets)\nImport-Module AzTable\n\n#Imports data from CSV files into $GLobalHolidays variable\n$Folder = \'C:\\Temp\\API\\\'\n\n$GlobalHolidays = Get-ChildItem "$Folder\\DateTimeSource\\*.csv" | Foreach-Object {\n  $basename = $_.BaseName\n  import-csv $_ \n}\n\n#Connect-AzAccount\n#Connects to Azure Storage Account\n$storageAccountName = \'funcnzpublicholidaystgac\'\n$resourceGroupName = \'rg-publicHolidays-prd-ae\'\n$tableName = \'PublicHolidays\'\n$storageAccount = Get-AzStorageAccount -ResourceGroupName $resourceGroupName -Name $storageAccountName\n$storageContext = $storageAccount.Context\n$cloudTable = (Get-AzStorageTable -Name $tableName -Context $storageContext).CloudTable\n\n  \n#Imports CSV data into Azure Table\n$counter = 0\nForEach ($Holiday in $GlobalHolidays)\n\n{\n  $Date = [DateTime]($Holiday.Date)\n  $Dayofweek = $Date.DayOfWeek | Out-String\n  $Year = $Date.Year\n  $HolidayDate = Get-Date $Date -format "dd-MM-yyyy"\n\n Add-AzTableRow `\n  -table $cloudTable `\n  -partitionKey \'1\' `\n  -rowKey ((++$counter)) -property @{"Date"=$HolidayDate;"Country"=$Holiday.CountryCode;"Type"=$Holiday.Type;"Name"=$Holiday.LocalName;"Day"=$Dayofweek;"Year"=$Year;"Comments"=$Holiday.Counties}\n\n}\n\n\n#Validate the data in the Storage table\nGet-AzTableRow -table $cloudTable\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Import CSV to Azure Storage Account",src:t(7116).A+"",title:"Import CSV to Azure Storage Account",width:"1203",height:"361"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Validate Azure Storage Account Table",src:t(41946).A+"",title:"Validate Azure Storage Account Table",width:"1203",height:"361"})}),"\n",(0,i.jsxs)(n.p,{children:["Now the Public Holidays are imported into the Azure storage account table with additional information, such as the Day it falls, and the Date format has been changed to suit the NZ format ",(0,i.jsx)(n.em,{children:"(DD-MM-YYYY)"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"If we log in to the Azure Portal, navigate to the Storage account and under Storage Browser, we can now see our Table is full of Public Holidays."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(35381).A+"",width:"2109",height:"965"})}),"\n",(0,i.jsx)(n.h4,{id:"create-api",children:"Create API"}),"\n",(0,i.jsx)(n.p,{children:"That we have our Table with Public Holiday data, it's time to create our Azure Function to act as the API that will talk to the azure storage account!"}),"\n",(0,i.jsx)(n.h5,{id:"create-azure-function",children:"Create Azure Function"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Log in to the ",(0,i.jsx)(n.a,{href:"https://portal.azure.com/#home",title:"Microsoft Azure Portal",children:(0,i.jsx)(n.strong,{children:"Microsoft Azure Portal"})})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Click on the burger and click"})," ",(0,i.jsx)(n.a,{href:"https://portal.azure.com/#view/HubsExtension/BrowseResourceGroups",title:"Resource groups",children:(0,i.jsx)(n.strong,{children:"Resource groups"})})]}),"\n",(0,i.jsxs)(n.li,{children:["Navigate to your ",(0,i.jsx)(n.strong,{children:"resource group"})," and click ",(0,i.jsx)(n.strong,{children:"+ Create"})]}),"\n",(0,i.jsxs)(n.li,{children:["Search for: ",(0,i.jsx)(n.strong,{children:"Function"})]}),"\n",(0,i.jsxs)(n.li,{children:["Select ",(0,i.jsx)(n.strong,{children:"Function App"}),", and click ",(0,i.jsx)(n.strong,{children:"Create"})]}),"\n",(0,i.jsxs)(n.li,{children:["Enter your ",(0,i.jsx)(n.strong,{children:"Function App Name"})," ",(0,i.jsx)(n.em,{children:"(i.e. 'func-nzpublicHolidays-prd-ae')"})]}),"\n",(0,i.jsxs)(n.li,{children:["For Runtime Stack, select ",(0,i.jsx)(n.strong,{children:"PowerShell Core"})]}),"\n",(0,i.jsxs)(n.li,{children:["Select the latest version (at this time, it's ",(0,i.jsx)(n.strong,{children:"7.2"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:["Select your ",(0,i.jsx)(n.strong,{children:"Region"})]}),"\n",(0,i.jsxs)(n.li,{children:["Select ",(0,i.jsx)(n.strong,{children:"Windows"})]}),"\n",(0,i.jsxs)(n.li,{children:["Set your ",(0,i.jsx)(n.strong,{children:"Plan"})," ",(0,i.jsx)(n.em,{children:"(in my example, its Consumption (Serverless))"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Review + Create"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Create"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Azure Function - Create",src:t(18975).A+"",title:"Azure Function - Create",width:"738",height:"782"})}),"\n",(0,i.jsx)(n.h5,{id:"configure-environment-variables",children:"Configure Environment Variables"}),"\n",(0,i.jsx)(n.p,{children:"Now that the Function App has been created before creating the GetPublicHoliday function, we need to add a few environment variables that the Function will use; these variables will contain the ResourceGroup and Storage account name."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Navigate"})," to your ",(0,i.jsx)(n.strong,{children:"Azure Function"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Configuration"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"+ New application setting"})]}),"\n",(0,i.jsxs)(n.li,{children:["Under the name, add: ",(0,i.jsx)(n.strong,{children:"PublicHolidayRESOURCEGROUPNAME"})]}),"\n",(0,i.jsx)(n.li,{children:"For value, type in the name of your resource group."}),"\n",(0,i.jsxs)(n.li,{children:["Add a second application setting named: ",(0,i.jsx)(n.strong,{children:"PublicHolidaySTORAGEACCNAME"})]}),"\n",(0,i.jsx)(n.li,{children:"For value, type in the name of your storage account that contains the Public Holiday table."}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Save"})," ",(0,i.jsx)(n.em,{children:"(to save the variables)"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Azure Function - Variables",src:t(74746).A+"",title:"Azure Function - Variables",width:"1318",height:"672"})}),"\n",(0,i.jsx)(n.h5,{id:"configure-managed-identity",children:"Configure Managed Identity"}),"\n",(0,i.jsx)(n.p,{children:"Next, we need to give the Function App the ability to read the Azure storage account. To do this, we need to configure a System assigned managed identity."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Navigate"})," to your ",(0,i.jsx)(n.strong,{children:"Azure Function"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Identity"})]}),"\n",(0,i.jsxs)(n.li,{children:["Under the System assigned heading, toggle the status to ",(0,i.jsx)(n.strong,{children:"On"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Save"})]}),"\n",(0,i.jsxs)(n.li,{children:["Select ",(0,i.jsx)(n.strong,{children:"Yes"}),", to enable the System assigned managed identity"]}),"\n",(0,i.jsxs)(n.li,{children:["Under Permissions, click ",(0,i.jsx)(n.strong,{children:"Azure role assignments"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"+ Add role assignment"})]}),"\n",(0,i.jsxs)(n.li,{children:["For Scope, select ",(0,i.jsx)(n.strong,{children:"Storage"})]}),"\n",(0,i.jsx)(n.li,{children:"Select your Subscription and storage account containing your Public Holiday data"}),"\n",(0,i.jsxs)(n.li,{children:["For role, select ",(0,i.jsx)(n.strong,{children:"Contributor"})," ",(0,i.jsx)(n.em,{children:"(Storage Table Data Reader is not enough)."})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Save"})]}),"\n"]}),"\n",(0,i.jsx)(n.h5,{id:"configure-requirements",children:"Configure Requirements"}),"\n",(0,i.jsx)(n.p,{children:"The Azure function app will rely on a few PowerShell Modules; for the FunctionApp to load them, we need to add them to the requirements.psd1 file."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Navigate"})," to your ",(0,i.jsx)(n.strong,{children:"Azure Function"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Click ",(0,i.jsx)(n.strong,{children:"App files"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Change the dropdown to ",(0,i.jsx)(n.strong,{children:"requirements.psd1"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["In the hash array, comment out the #Az module line ",(0,i.jsx)(n.em,{children:"(as this will load the entire Az Module set, which will cause an increased delay in the startup as those extra modules aren't needed)"}),", and add the following:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# This file enables modules to be automatically managed by the Functions service.\n# See https://aka.ms/functionsmanageddependency for additional information.\n#\n@{\n    # For latest supported version, go to 'https://www.powershellgallery.com/packages/Az'. \n    # To use the Az module in your function app, please uncomment the line below.\n    #'Az' = '8.*'\n    'Az.Accounts'  = '2.*'\n    'Az.Storage'   = '4.*'\n    'Az.Resources' = '2.*'\n    'AzTable'      = '2.*'\n\n}\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Click ",(0,i.jsx)(n.strong,{children:"Save"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h5,{id:"create-function-publicholidays",children:"Create Function PublicHolidays"}),"\n",(0,i.jsx)(n.p,{children:"Now that the Function App has been configured, it is time to create our Function."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Navigate"})," to your ",(0,i.jsx)(n.strong,{children:"Azure Function"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Functions"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"+ Create"})]}),"\n",(0,i.jsxs)(n.li,{children:["Change Development environment to ",(0,i.jsx)(n.strong,{children:"Develop in Portal"})]}),"\n",(0,i.jsxs)(n.li,{children:["Select Template, an ",(0,i.jsx)(n.strong,{children:"HTTP trigger"})]}),"\n",(0,i.jsxs)(n.li,{children:["For the New Function name, I will go with ",(0,i.jsx)(n.strong,{children:"GetPublicHoliday"})]}),"\n",(0,i.jsxs)(n.li,{children:["Change Authorization level to ",(0,i.jsx)(n.strong,{children:"Anonymous"})," ",(0,i.jsx)(n.em,{children:"(if you aren't going to implement API Management, select Function and look at whitelisting your IP only, we will be locking it down to API Management later)"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Create"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Create Azure Function App",src:t(85760).A+"",title:"Create Azure Function App",width:"840",height:"829"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Click ",(0,i.jsx)(n.strong,{children:"Code + Test"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Copy the following Code into the run.ps1 file, this code is core to the Function that will read the HTTP request and bring back a PowerShell object with the Public Holiday information as part of a GET request:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'<# The code above does the following, explained in English:\n1. Read the query parameters from the request.\n2. Read the body of the request.\n3. Write to the Azure Functions log stream.\n4. Interact with query parameters or the body of the request.\n5. Associate values to output bindings by calling \'Push-OutputBinding\'. \nhttps://luke.geek.nz/ #>\n\nusing namespace System.Net\n\n# Input bindings are passed in via param block.\nparam([Parameter(Mandatory = $true)]$Request, [Parameter(Mandatory = $true)]$TriggerMetadata)\n\n# Write to the Azure Functions log stream.\nWrite-Host \'GetPublicHoliday function processed a request.\'\n\n\n# Interact with query parameters or the body of the request.\n$date = $Request.Query.Date\n$country = $Request.Query.CountryCode\n\n$resourceGroupName = $env:PublicHolidayRESOURCEGROUPNAME\n$storageAccountName = $env:PublicHolidaySTORAGEACCNAME\n$tableName = \'PublicHolidays\'\n\n$ClientIP = $Request.Headers."x-forwarded-for".Split(":")[0]\n     \ntry {   \n    \n  $storageAccount = Get-AzStorageAccount -ResourceGroupName $resourceGroupName -Name $storageAccountName\n  $storageContext = $storageAccount.Context\n  $cloudTable = (Get-AzStorageTable -Name $tableName -Context $storageContext).CloudTable\n  Import-Module AzTable   \n      \n  $Tables = Get-AzTableRow -table $cloudTable \n\n\n  ForEach ($table in $Tables)\n  {\n\n\n    [string]$Filter1 = [Microsoft.Azure.Cosmos.Table.TableQuery]::GenerateFilterCondition("Country", [Microsoft.Azure.Cosmos.Table.QueryComparisons]::Equal, $country)\n    [string]$Filter2 = [Microsoft.Azure.Cosmos.Table.TableQuery]::GenerateFilterCondition("Date", [Microsoft.Azure.Cosmos.Table.QueryComparisons]::Equal, $date)\n    [string]$finalFilter = [Microsoft.Azure.Cosmos.Table.TableQuery]::CombineFilters($Filter1, "and", $Filter2)     \n    $object = Get-AzTableRow -table $cloudTable -CustomFilter $finalFilter\n   \n   \n    $body = @()\n     \n    $System = New-Object -TypeName PSObject\n    Add-Member -InputObject $System -MemberType NoteProperty -Name CountryCode -Value   $object.Country\n    Add-Member -InputObject $System -MemberType NoteProperty -Name HolidayDate -Value   $object.Date\n    Add-Member -InputObject $System -MemberType NoteProperty -Name HolidayYear -Value   $object.Year\n    Add-Member -InputObject $System -MemberType NoteProperty -Name HolidayName -Value   $object.Name\n    Add-Member -InputObject $System -MemberType NoteProperty -Name HolidayType -Value   $object.Type\n    Add-Member -InputObject $System -MemberType NoteProperty -Name Comments -Value      $object.Comments\n    Add-Member -InputObject $System -MemberType NoteProperty -Name RequestedIP -Value   $ClientIP\n\n    $body += $System\n    $System = New-Object -TypeName PSObject\n     \n    $status = [Net.HttpStatusCode]::OK\n\n  }\n  \n\n}\ncatch {\n  $body = "Failure connecting to table for state data, $_"\n  $status = [Net.HttpStatusCode]::BadRequest\n}\n#$body =  $TriggerMetadata\n\n\n# Associate values to output bindings by calling Push-OutputBinding\'\nPush-OutputBinding -Name Response -Value ([HttpResponseContext]@{\n    StatusCode = $status\n    Body       = $body\n  }\n)\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Click ",(0,i.jsx)(n.strong,{children:"Save"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h5,{id:"test-function---publicholidays",children:"Test Function - PublicHolidays"}),"\n",(0,i.jsx)(n.p,{children:"Before proceeding with the next step, it's time to test the function."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Navigate"})," to your ",(0,i.jsx)(n.strong,{children:"Azure Function"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Functions"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"GetPublicHoliday"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Code + Test"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Test/Run"})]}),"\n",(0,i.jsxs)(n.li,{children:["Change HTTP method to ",(0,i.jsx)(n.strong,{children:"Get"})]}),"\n",(0,i.jsx)(n.li,{children:"Under Query, add Country value and Date value."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Note: Make sure the date and country formats match what is in the Azure storage account."}),"\n",(0,i.jsx)(n.p,{children:"You can also Invoke the function app directly with PowerShell, with the Date and Country as Parameters at the end:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'Invoke-RestMethod -URI "https://func-nzpublicholidays-prd-ae.azurewebsites.net/api/GetPublicHoliday?Date=25-12-2023&CountryCode=NZ"\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Test Public Holiday API",src:t(28146).A+"",title:"Test Public Holiday API",width:"1203",height:"361"})}),"\n",(0,i.jsx)(n.p,{children:"Congratulations! You have now created a Public Holiday API that you can call for automation! You can lock down the Function App to only certain IPs or proceed to configure Azure API Management."}),"\n",(0,i.jsx)(n.h5,{id:"configure-azure-api-management",children:"Configure Azure API Management"}),"\n",(0,i.jsxs)(n.p,{children:["Now that the Function App responds to requests, we can expose the HTTP endpoint through ",(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/azure-functions/functions-openapi-definition?WT.mc_id=AZ-MVP-5004796",title:"Expose serverless APIs from HTTP endpoints using Azure API Management",children:"Azure API Management"}),". Azure API Management will give greater flexibility and security over API endpoints, particularly when dealing with more than one API. Azure API Management also offers inbuilt shared cache functionality and integration into ",(0,i.jsx)(n.a,{href:"https://azure.microsoft.com/en-us/services/cache/?WT.mc_id=AZ-MVP-5004796",title:" Azure Cache for Redis\xae2",children:"Azure Cache for Redis"}),"."]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Log in to the ",(0,i.jsx)(n.a,{href:"https://portal.azure.com/#home",title:"Microsoft Azure Portal",children:(0,i.jsx)(n.strong,{children:"Microsoft Azure Portal"})})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Navigate"})," to your ",(0,i.jsx)(n.strong,{children:"Azure Function"})]}),"\n",(0,i.jsxs)(n.li,{children:["On the Navigation blade, select ",(0,i.jsx)(n.strong,{children:"API Management"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Create New"})]}),"\n",(0,i.jsxs)(n.li,{children:["Select your subscription, ",(0,i.jsx)(n.strong,{children:"Region"}),", and organisation ",(0,i.jsx)(n.strong,{children:"name"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Select a ",(0,i.jsx)(n.a,{href:"https://azure.microsoft.com/en-us/pricing/details/api-management/?WT.mc_id=AZ-MVP-5004796",title:" API Management pricing",children:(0,i.jsx)(n.strong,{children:"Pricing Tier"})})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Review + Create"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Create"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Create Azure API Management",src:t(30015).A+"",width:"802",height:"790"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Wait for 10 minutes to half an hour for provisioning to take place, and Azure API Management will be in an activating state."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Once API Management has been provisioned, you can ",(0,i.jsx)(n.strong,{children:"copy"})," the ",(0,i.jsx)(n.strong,{children:"Virtual IP (VIP)"})," addresses of API Management and ",(0,i.jsx)(n.strong,{children:"restrict"})," your ",(0,i.jsx)(n.strong,{children:"function"})," app to ",(0,i.jsx)(n.strong,{children:"only"})," allow ",(0,i.jsx)(n.strong,{children:"inbound"})," access from that ",(0,i.jsx)(n.strong,{children:"IP"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Once you have done that, add the GetPublicHoliday function app into Azure API Management, add the paths to add a version, and then, using the subscription key, you run the following command to pull data."}),"\n",(0,i.jsxs)(n.p,{children:['Invoke-RestMethod -uri "',(0,i.jsx)(n.a,{href:"https://apims-nzpublicholidays-prd-ae.azure-api.net/v1/GetPublicHoliday?Date=4/05/2022&CountryCode=NZ&Ocp-Apim-Subscription-Key=$KEY",children:"https://apims-nzpublicholidays-prd-ae.azure-api.net/v1/GetPublicHoliday?Date=4/05/2022&CountryCode=NZ&Ocp-Apim-Subscription-Key=$KEY"}),'"']}),"\n"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},48374:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/api_resourcegroupazviz-6b750e49b76e6fbbc15caf8db97c3dac.png"},30015:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/azureportal_createapimanagement-7cd983b8676b0d28c16984ab9db47cdc.png"},18975:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/azureportal_createazfunctionapiwin-ef7a4566a3c9cf027bafa17f95362cdb.png"},85760:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/azureportal_createfunctionpublicholidays-2673e41f9b6d67f4d37da55b13f9de6c.png"},14150:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/azureportal_createpublicholidaystable-17900c7b03aa308022d2d7418c793f5a.png"},11221:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/azureportal_creatergapi-e4b9ec363fbcf561a94e95c818b36b5e.png"},74746:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/azureportal_funcapp_api_variables-1cd7cf230579d1c83511b45531fa3f14.png"},35381:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/azureportal_storagebrowser_api_table-4ed54d2629d3d74f3d5221901f6bd6d9.png"},94813:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/customholidays_api-e3feccfea6b230e5b5caea2b070d43e5.png"},7116:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/import-csvtoazuretables-8d10f55cd0b8a8e8297b959aa7ae3cd5.gif"},41946:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/import-csvtoazuretablesvalidate-0615d15e07b7cab4343607aa29e118e6.gif"},28146:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/testpublicholidayapi-3b124ddd861072dc80c53f1fee4ffb52.gif"},28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>a});var r=t(96540);const i={},o=r.createContext(i);function s(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(o.Provider,{value:n},e.children)}},27823:e=>{e.exports=JSON.parse('{"permalink":"/2022/08/09/create-a-public-holidays-api-using-microsoft-azure","source":"@site/blog/2022-08-09-create-a-public-holidays-api-using-microsoft-azure.md","title":"Create a Public Holidays API using Microsoft Azure","description":"Using a previous blog post I did on using a third-party API (Application Programming Interface) to start a Virtual Machine when it wasn\'t a Public Holiday, I had a thought on what could be an option if I wanted an API only accessible on an internal network or if I wanted to include custom Holidays such as Star Wars day or company holidays? Could I create and query my API using Microsoft Azure services? You can!","date":"2022-08-09T00:00:00.000Z","tags":[{"inline":true,"label":"Azure","permalink":"/tags/azure"}],"readingTime":14.375,"hasTruncateMarker":false,"authors":[{"name":"Luke Murray","title":"Author","url":"https://luke.geek.nz","imageURL":"https://luke.geek.nz/img/logo.png","key":"Luke","page":null}],"frontMatter":{"title":"Create a Public Holidays API using Microsoft Azure","authors":["Luke"],"tags":["Azure"],"date":"2022-08-09 00:00:00 +1300","toc":true,"header":{"teaser":"/uploads/azureportal_storagebrowser_api_table.png"}},"unlisted":false,"prevItem":{"title":"Connect to Azure SQL Database in a Jupyter Notebook using Python","permalink":"/2022/08/17/connect-to-azure-sql-database-in-a-jupyter-notebook-using-python"},"nextItem":{"title":"Microsoft Azure - ZonalAllocationFailed","permalink":"/azure/microsoft-azure-zonalallocationfailed"}}')}}]);