"use strict";(self.webpackChunklukemurraynz=self.webpackChunklukemurraynz||[]).push([[23669],{92429:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>a,metadata:()=>i,toc:()=>l});var r=o(74848),n=o(28453);const a={date:"2021-03-26 00:00:00 +1300",title:"Failed to delete the private endpoint. Error: Call to Microsoft.Storage/storageAccounts failed",authors:["Luke"],tags:["Azure"],toc:!1},s=void 0,i={permalink:"/2021/03/26/failed-to-delete-the-private-endpoint.error-call-to-microsoft.storage-storageaccounts-failed",source:"@site/blog/2021-03-26-failed-to-delete-the-private-endpoint.error-call-to-microsoft.storage-storageaccounts-failed.md",title:"Failed to delete the private endpoint. Error: Call to Microsoft.Storage/storageAccounts failed",description:"Issue Description",date:"2021-03-26T00:00:00.000Z",tags:[{inline:!0,label:"Azure",permalink:"/tags/azure"}],readingTime:.735,hasTruncateMarker:!1,authors:[{name:"Luke Murray",title:"Author",url:"https://luke.geek.nz",imageURL:"https://luke.geek.nz/img/logo.png",key:"Luke",page:null}],frontMatter:{date:"2021-03-26 00:00:00 +1300",title:"Failed to delete the private endpoint. Error: Call to Microsoft.Storage/storageAccounts failed",authors:["Luke"],tags:["Azure"],toc:!1},unlisted:!1,prevItem:{title:"Allow Azure DevOps Microsoft Hosted Agent to communicate with Azure KeyVault",permalink:"/2021/03/26/allow-azure-devops-microsoft-hosted-agent-to-communicate-with-azure-keyvault"},nextItem:{title:"The Cloud Frame of Mind",permalink:"/2021/03/26/the-cloud-frame-of-mind"}},c={authorsImageUrls:[void 0]},l=[{value:"Issue Description",id:"issue-description",level:2},{value:"Root Cause",id:"root-cause",level:2},{value:"Resolution",id:"resolution",level:2},{value:"More info",id:"more-info",level:2}];function u(e){const t={a:"a",h2:"h2",li:"li",p:"p",ul:"ul",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"issue-description",children:"Issue Description"}),"\n",(0,r.jsx)(t.p,{children:"Failed to delete the private endpoint. Error: Call to Microsoft.Storage/storageAccounts failed"}),"\n",(0,r.jsx)(t.h2,{id:"root-cause",children:"Root Cause"}),"\n",(0,r.jsx)(t.p,{children:"Azure Backup locks the storage account when you configure protection for any file share in the corresponding account. This provides protection against accidental deletion of a storage account with backed-up file shares."}),"\n",(0,r.jsx)(t.h2,{id:"resolution",children:"Resolution"}),"\n",(0,r.jsx)(t.p,{children:"In my case, the Storage account I was attempting to remove the Private Endpoint from was an Azure File Sync storage account, that had Azure File Shares that were getting Backuped Up."}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Found and removed the lock on the storage account"}),"\n",(0,r.jsx)(t.li,{children:"Then successfully delete the private endpoint"}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"more-info",children:"More info"}),"\n",(0,r.jsx)(t.p,{children:"Generally, it is recommended that keep the lock taken on the storage account by Azure Backup. If you delete the lock, your storage account will be prone to accidental deletion and if it's deleted, you'll lose your snapshots or backups."}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/azure/backup/backup-afs?WT.mc_id=AZ-MVP-5004796#best-practices",title:"https://learn.microsoft.com/en-us/azure/backup/backup-afs?WT.mc_id=AZ-MVP-5004796#best-practices",children:"https://learn.microsoft.com/en-us/azure/backup/backup-afs#best-practices"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/lock-resources",title:"https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/lock-resources?tabs=json&WT.mc_id=AZ-MVP-5004796",children:"https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/lock-resources"})})]})}function d(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},28453:(e,t,o)=>{o.d(t,{R:()=>s,x:()=>i});var r=o(96540);const n={},a=r.createContext(n);function s(e){const t=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:s(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);