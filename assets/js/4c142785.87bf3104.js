"use strict";(self.webpackChunklukemurraynz=self.webpackChunklukemurraynz||[]).push([[63239],{6425:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>m,frontMatter:()=>r,metadata:()=>i,toc:()=>l});var s=o(74848),n=o(28453);const r={title:"Open multiple Microsoft Teams instances using PowerShell",authors:["Luke"],toc:!1,tags:["PowerShell"],description:"Open multiple Microsoft Team instances, for access to multiple accounts with PowerShell",header:{teaser:"/images/posts/MS_Teams_logo_ws.png"},date:"2023-05-03 00:00:00 +1300"},a=void 0,i={permalink:"/2023/05/03/Open-multiple-Microsoft-Teams-instances-using-PowerShell",source:"@site/blog/2023-05-03-Open-multiple-Microsoft-Teams-instances-using-PowerShell.md",title:"Open multiple Microsoft Teams instances using PowerShell",description:"Open multiple Microsoft Team instances, for access to multiple accounts with PowerShell",date:"2023-05-03T00:00:00.000Z",tags:[{label:"PowerShell",permalink:"/tags/power-shell"}],readingTime:1.155,hasTruncateMarker:!1,authors:[{name:"Luke Murray",title:"Author",url:"https://luke.geek.nz",imageURL:"https://luke.geek.nz/img/logo.png",key:"Luke"}],frontMatter:{title:"Open multiple Microsoft Teams instances using PowerShell",authors:["Luke"],toc:!1,tags:["PowerShell"],description:"Open multiple Microsoft Team instances, for access to multiple accounts with PowerShell",header:{teaser:"/images/posts/MS_Teams_logo_ws.png"},date:"2023-05-03 00:00:00 +1300"},unlisted:!1,prevItem:{title:"Web Content Not Found on Azure Storage Account",permalink:"/azure/Web-Content-Not-Found-error-on-Azure-Storage-Account-static-website"},nextItem:{title:"Failed to persist Terraform state using an Azure Blob Storage account",permalink:"/azure/failed-to-persist-terraform-state-using-an-azure-blob-storage-account"}},c={authorsImageUrls:[void 0]},l=[];function u(e){const t={a:"a",code:"code",em:"em",p:"p",pre:"pre",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"There may be circumstances, you need to open up multiple Microsoft Team instances, a reason for this - maybe to chat and join meetings across multiple accounts."}),"\n",(0,s.jsxs)(t.p,{children:["Microsoft are working on a version of ",(0,s.jsx)(t.a,{href:"https://techcommunity.microsoft.com/t5/microsoft-teams-public-preview/bd-p/MicrosoftTeamsPublicPreview?WT.mc_id=AZ-MVP-5004796",title:"Microsoft Teams Public Preview",children:"Microsoft Teams"})," that supports multiple-accounts, but until thats released - you can use a PowerShell script to open up another version of Microsoft Teams in another profile ",(0,s.jsx)(t.em,{children:"(or multiple, if you update the profilename)"}),"."]}),"\n",(0,s.jsx)(t.p,{children:"This script also works within your LocalAppData, so you don't need local administrator rights to run."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-powershell",children:'# Uses the file name as the profile name\n$MSTEAMS_PROFILE = \'CustomProfile\'\n\nWrite-Host "- Using profile \'$MSTEAMS_PROFILE\'"\n\n# Set the custom profile path\n$USERPROFILE = Join-Path $env:LOCALAPPDATA "Microsoft\\Teams\\CustomProfiles\\$MSTEAMS_PROFILE"\n\n# Set the old user profile\n$OLD_USERPROFILE = $env:USERPROFILE\n\n# Launch MS Teams with the custom profile\nWrite-Host "- Launching MS Teams with profile \'$MSTEAMS_PROFILE\'"\nSet-Location "$OLD_USERPROFILE\\AppData\\Local\\Microsoft\\Teams"\n\n$teamsProcessStartInfo = New-Object System.Diagnostics.ProcessStartInfo\n$teamsProcessStartInfo.FileName = "$OLD_USERPROFILE\\AppData\\Local\\Microsoft\\Teams\\Update.exe"\n$teamsProcessStartInfo.Arguments = "--processStart ""Teams.exe"""\n$teamsProcessStartInfo.WorkingDirectory = "$OLD_USERPROFILE\\AppData\\Local\\Microsoft\\Teams"\n$teamsProcessStartInfo.EnvironmentVariables["USERPROFILE"] = $USERPROFILE\n$teamsProcessStartInfo.UseShellExecute = $false\n\n[System.Diagnostics.Process]::Start($teamsProcessStartInfo) | Out-Null\n\n# Set the user profile back to the old user profile\n$env:USERPROFILE = $OLD_USERPROFILE\n\n'})}),"\n",(0,s.jsx)(t.p,{children:"When the script is ran, a new profile will be created for Microsoft Teams, and then opened. You can then use that second Microsoft Teams instance, to connect to another account or tenancy."}),"\n",(0,s.jsxs)(t.p,{children:["To make it easier, you could also look at turning this script into an ",(0,s.jsx)(t.a,{href:"https://github.com/MScholtes/PS2EXE",title:"PS2EXE",children:"executable"}),"."]})]})}function m(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},28453:(e,t,o)=>{o.d(t,{R:()=>a,x:()=>i});var s=o(96540);const n={},r=s.createContext(n);function a(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);