"use strict";(self.webpackChunklukemurraynz=self.webpackChunklukemurraynz||[]).push([[81554],{79255:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>d,toc:()=>a});var t=n(74848),r=n(28453);const s={title:"New Zealand North Latency Testing and Results",metaDescription:"An in-depth analysis of latency within the New Zealand North Azure region, including various scenarios and performance metrics.",date:new Date("2024-11-10T05:48:55.999Z"),tags:["Azure"],categories:["Azure"],authors:["Luke"],slug:"azure/nz-north-latency-testing",keywords:["azure","nznorth","latency","performance","availability zones","virtual networks","azure firewall"],description:"An in-depth analysis of latency within the New Zealand North Azure region, including various scenarios and performance metrics."},l=void 0,d={permalink:"/azure/nz-north-latency-testing",source:"@site/blog/2024-11-10-nznorth-az-latency/index.mdx",title:"New Zealand North Latency Testing and Results",description:"An in-depth analysis of latency within the New Zealand North Azure region, including various scenarios and performance metrics.",date:"2024-11-10T05:48:55.999Z",tags:[{inline:!0,label:"Azure",permalink:"/tags/azure"}],readingTime:21.72,hasTruncateMarker:!0,authors:[{name:"Luke Murray",title:"Author",url:"https://luke.geek.nz",imageURL:"https://luke.geek.nz/img/logo.png",key:"Luke",page:null}],frontMatter:{title:"New Zealand North Latency Testing and Results",metaDescription:"An in-depth analysis of latency within the New Zealand North Azure region, including various scenarios and performance metrics.",date:"2024-11-10T05:48:55.999Z",tags:["Azure"],categories:["Azure"],authors:["Luke"],slug:"azure/nz-north-latency-testing",keywords:["azure","nznorth","latency","performance","availability zones","virtual networks","azure firewall"],description:"An in-depth analysis of latency within the New Zealand North Azure region, including various scenarios and performance metrics."},unlisted:!1,nextItem:{title:"Enhancing GitHub Copilot with Custom Instructions",permalink:"/azure/enhancing-github-copilot-with-custom-instructions"}},c={authorsImageUrls:[void 0]},a=[{value:"\ud83d\udd0d Overview",id:"-overview",level:2},{value:"\ud83d\udcc9 Latency Testing",id:"-latency-testing",level:2},{value:"\ud83c\udfe2 Scenario 1 - Same Virtual Network, same availability zone, same proximty placement group",id:"-scenario-1---same-virtual-network-same-availability-zone-same-proximty-placement-group",level:2},{value:"\ud83c\udf10 Scenario 2 - Same Virtual Network, same availability zone, virtual machine NOT in proximity placement group",id:"-scenario-2---same-virtual-network-same-availability-zone-virtual-machine-not-in-proximity-placement-group",level:2},{value:"\ud83d\udd17 Scenario 3 - Same Virtual Network, across availability zones",id:"-scenario-3---same-virtual-network-across-availability-zones",level:2},{value:"\ud83d\udda7  Scenario 4 - Multiple Virtual Networks (peered), same availability zone",id:"--scenario-4---multiple-virtual-networks-peered-same-availability-zone",level:2},{value:"\ud83d\udda7 Scenario 5 - Multiple Virtual Networks (peered), across availability zones",id:"-scenario-5---multiple-virtual-networks-peered-across-availability-zones",level:2},{value:"\ud83d\udee1\ufe0f Scenario 6 - Multiple Virtual Networks connected in a Hub &amp; Spoke topology and Routing via Azure Firewall",id:"\ufe0f-scenario-6---multiple-virtual-networks-connected-in-a-hub--spoke-topology-and-routing-via-azure-firewall",level:2},{value:"\ud83d\udcdd Summary",id:"-summary",level:2}];function o(e){const i={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",img:"img",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.p,{children:["New Zealand has a new ",(0,t.jsx)(i.em,{children:"(and only)"})," Azure Cloud region: ",(0,t.jsx)(i.a,{href:"https://news.microsoft.com/aotearoa-datacenter?WT.mc_id=AZ-MVP-5004796",children:"New Zealand North"}),". It's not every day that we get to explore a new region! This article will examine the latency within the New Zealand North region and between its Availability Zones."]}),"\n",(0,t.jsx)(i.h2,{id:"-overview",children:"\ud83d\udd0d Overview"}),"\n",(0,t.jsxs)(i.p,{children:["New Zealand North region follows the newer, now standard, 3 + 0 model, with 3 ",(0,t.jsx)(i.a,{href:"https://learn.microsoft.com/azure/reliability/availability-zones-overview?tabs=azure-cli&WT.mc_id=AZ-MVP-5004796",children:"availability zones"})," (three separate datacenters that make up a region) but with ",(0,t.jsx)(i.a,{href:"https://learn.microsoft.com/azure/reliability/cross-region-replication-azure?WT.mc_id=AZ-MVP-5004796#regions-with-availability-zones-and-no-region-pair",children:"no specified region pair"})," ",(0,t.jsx)(i.em,{children:"(e.g., locally or in Australia)"}),". This means that Microsoft needs to assume which other region you may want to use as a failover. You can choose any region you want (e.g., object replication on an Azure storage account can be any region). Most of us in New Zealand will likely choose New Zealand North as the primary and Australia East as the secondary, where applicable. These three availability zones already provide more resiliency out of the box than most New Zealand organizations had before."]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{alt:"New Zealand North - Azure Avaliability Zones",src:n(81769).A+"",width:"4000",height:"2250"})}),"\n",(0,t.jsx)(i.admonition,{type:"warning",children:(0,t.jsx)(i.p,{children:"At the time of this article, New Zealand North is not officially Generally Available (indicative timelines December). However, finding I can deploy to this region now on my own subscriptions, I couldn't resist the opportunity to test the latency within the region. This article is intended as an indicative of what you can expect from New Zealand North, but I recommend running your own tests within your own environment if required. #geekingout"})}),"\n",(0,t.jsxs)(i.p,{children:["Let's look at the lower end of our resiliency tier. We can see Azure Service Bus\tstarts at an SLA of 99.9% (Y: 8h 45m 36s  M: 43m 12s  W: 10m 4s), and the higher SLA services such as Azure Virtual Machines and API Gateway can give up to 99.99% (Y: 52m 35s  M: 4m 23s  W: 1m 1s) ",(0,t.jsxs)(i.em,{children:["(how your solution and what services you use, impact your Composite SLA and Service Level Agreements so make sure you architect accordingly and review the ",(0,t.jsx)(i.a,{href:"https://www.microsoft.com/licensing/docs/view/Service-Level-Agreements-SLA-for-Online-Services?WT.mc_id=AZ-MVP-5004796",children:"Microsoft SLA documentation"}),")"]}),"."]}),"\n",(0,t.jsx)(i.admonition,{type:"info",children:(0,t.jsx)(i.p,{children:"Availability zones are close enough to have low-latency connections to other availability zones. A high-performance network connects them with a round-trip latency of less than 2ms. However, availability zones are far enough apart to reduce the likelihood that more than one will be affected by local outages or weather. Availability zones have independent power, cooling, and networking infrastructure. They're designed so that if one zone experiences an outage, then regional services, capacity, and high availability are supported by the remaining zones. They help your data stay synchronized and accessible when things go wrong."})}),"\n",(0,t.jsx)(i.admonition,{type:"tip",children:(0,t.jsxs)(i.p,{children:["If you are interested in more information about Availability Zones and the differences between Physical + Logical zones, make sure you have read a previous blog article of mine: ",(0,t.jsx)(i.a,{href:"https://luke.geek.nz/azure/azure-availability-zone-peering/",children:"Azure Availability Zone Peering"}),". In essence, you need to be aware that Avalibility Zone 1 ",(0,t.jsx)(i.em,{children:"(physical and logical avalibility zones can be different)"}),", does not always equal Availability Zone 1, especially if you have workloads spread across multiple subscriptions. For today, all my testing is done in a single subscription."]})}),"\n",(0,t.jsx)(i.h2,{id:"-latency-testing",children:"\ud83d\udcc9 Latency Testing"}),"\n",(0,t.jsx)(i.p,{children:"But this is not a resiliency discussion; it is latency, so let's look at the latency of what New Zealand North is giving us."}),"\n",(0,t.jsx)(i.admonition,{type:"warning",children:(0,t.jsxs)(i.p,{children:["Keep in mind that these tests are simply a point in time, and my open environment may not necessarily reflect your own Azure environment. At the time of these tests, the New Zealand North Region ",(0,t.jsx)(i.a,{href:"https://datacenters.microsoft.com/globe/explore?WT.mc_id=AZ-MVP-5004796",children:"isn't officially generally available"}),". This article is intended as an indicator of what you can expect from New Zealand North, but I recommend running your own tests within your own environment if required."]})}),"\n",(0,t.jsxs)(i.p,{children:["The latency from New Zealand to New Zealand North is around 15ms ",(0,t.jsx)(i.em,{children:"(from Hamilton)"}),", which is a great improvement from the 32-50ms to Australia East ",(0,t.jsx)(i.em,{children:"(from Hamilton)"}),", and the 190-230ms to the US ",(0,t.jsx)(i.em,{children:"(from Hamilton)"}),"."]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{alt:"New Zealand North - Azure Latency",src:n(91635).A+"",width:"1558",height:"901"})}),"\n",(0,t.jsx)(i.admonition,{type:"info",children:(0,t.jsxs)(i.p,{children:["The test above was done from Hamilton ",(0,t.jsxs)(i.em,{children:["(using the ",(0,t.jsx)(i.a,{href:"https://www.azurespeed.com/Azure/Latency?WT.mc_id=AZ-MVP-5004796",children:"Azure Speed Test"}),")"]}),",. The latency is to the internet, so it is not the same as the latency between the Azure region and your on-premises ",(0,t.jsx)(i.em,{children:"(or another cloud)"})," environment. Still, it is a good indicator of the latency you can expect from your users to your Azure resources. Your browser sends HTTPS requests to Azure blob files in each region. The median latency is calculated by measuring the time between the request and the response. The latency is measured in milliseconds (ms). The lower the latency, the better."]})}),"\n",(0,t.jsxs)(i.p,{children:["Because this is a standard Availability Zone ",(0,t.jsx)(i.em,{children:"(3+0)"})," region, Microsoft has certain commitments they have around latency within their own network and to the internet. They have a ",(0,t.jsx)(i.a,{href:"https://learn.microsoft.com/en-us/azure/reliability/availability-zones-overview?tabs=azure-cli&WT.mc_id=AZ-MVP-5004796",children:"guidelines"})," of 2ms ",(0,t.jsx)(i.em,{children:"(between zones)"})," and 10ms ",(0,t.jsx)(i.em,{children:"(to the internet - don't quote me on the SLA to the internet, its inferred by reading the SLA document, but I can't confirm at this stage)"}),", but remember that is just the network latency, and not the application latency ",(0,t.jsx)(i.em,{children:"(which is what you should be more concerned about)"}),". It's worth noting on SLA _(Service Level Agreements)_that Microsoft does it per service vs per datacenter or rack."]}),"\n",(0,t.jsxs)(i.p,{children:["So, let us prove that with the New Zealand North region, we can communicate between all regions in 2ms or under. For the purposes of this article, I will be using a Single subscription to do my testing ",(0,t.jsx)(i.em,{children:"(so I know that each zone will be separate)"}),". I will be using a ",(0,t.jsx)(i.a,{href:"https://learn.microsoft.com/azure/virtual-network/virtual-networks-overview?WT.mc_id=AZ-MVP-5004796",children:"Azure Virtual Network"})," ",(0,t.jsx)(i.em,{children:"(VNet)"})," in the New Zealand North region, a VNET ",(0,t.jsx)(i.em,{children:"(logical Virtual Network)"})," is zone-redundant out of the box."]}),"\n",(0,t.jsxs)(i.p,{children:["Then I will be using a Windows Server 2022 ",(0,t.jsx)(i.a,{href:"https://learn.microsoft.com/azure/virtual-machines/windows/overview?WT.mc_id=AZ-MVP-5004796",children:"Azure Virtual Machine"})," ",(0,t.jsx)(i.em,{children:"(VM)"})," in each zone, and I will be using ",(0,t.jsx)(i.a,{href:"https://learn.microsoft.com/en-us/azure/virtual-network/virtual-network-test-latency?tabs=windows&WT.mc_id=AZ-MVP-5004796#test-vms-with-latte-or-sockperf",children:"latte"})," to do my testing from each Virtual Machine."]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["Each Test machine is ",(0,t.jsx)(i.a,{href:"https://learn.microsoft.com/azure/virtual-network/accelerated-networking-overview?tabs=redhat&WT.mc_id=AZ-MVP-5004796",children:"Accelerated Networking"})," enabled."]}),"\n",(0,t.jsx)(i.li,{children:"The size of each Virtual Machine is a: Windows Server 2022 Datacenter: Azure Edition - x64 Gen2 - Standard_D4s_v3 - 4 vCPUs, 16 GB memory, 127GB OS disk."}),"\n",(0,t.jsxs)(i.li,{children:["Network Security Groups as left as default ",(0,t.jsx)(i.em,{children:"(at the VM NIC)"})," and VirtualNetwork allow."]}),"\n",(0,t.jsxs)(i.li,{children:["The version of ",(0,t.jsx)(i.a,{href:"https://github.com/microsoft/latte/",children:"latte"}),", I am using is v1.0.0."]}),"\n"]}),"\n",(0,t.jsxs)(i.admonition,{type:"info",children:[(0,t.jsx)(i.p,{children:"Many  common network latency test tools, such as Ping, don't measure TCP or UDP traffic. Tools like Ping use Internet Control Message Protocol (ICMP), which applications don't use. ICMP traffic can be treated differently from application traffic and doesn't directly affect application performance. ICMP test results don't directly apply to TCP and UDP workloads."}),(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.a,{href:"https://github.com/microsoft/latte",children:"Latte"})," (for Windows) and ",(0,t.jsx)(i.a,{href:"https://github.com/mellanox/sockperf",children:"SockPerf"})," (for Linux) measure only TCP or UDP payload delivery times. These tools use the following approach to measure network latency between two physical or virtual computers:"]}),(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Create a two-way communication channel between the computers by designating one as the sender and one as a receiver."}),"\n",(0,t.jsx)(i.li,{children:"Send and receive packets in both directions and measure the round-trip time (RTT)."}),"\n"]}),(0,t.jsxs)(i.p,{children:["Refer: ",(0,t.jsx)(i.a,{href:"https://learn.microsoft.com/en-us/azure/virtual-network/virtual-network-test-latency?tabs=windows&WT.mc_id=AZ-MVP-5004796",children:"Test network latency between Azure VMs"})]})]}),"\n",(0,t.jsxs)(i.p,{children:["The latte command I will be using is: ",(0,t.jsx)(i.code,{children:"latte -c -a 10.0.1.5:80 -i 60000"}),"."]}),"\n",(0,t.jsx)(i.admonition,{type:"note",children:(0,t.jsx)(i.p,{children:"Even though at the time of this article, Windows Server 2025 has been generally avaliable for about a week. I have decided to use 2022, as it is a common and mature version of Windows Server in use today."})}),"\n",(0,t.jsxs)(i.p,{children:["Inspired by ",(0,t.jsx)(i.a,{href:"https://www.linkedin.com/in/nicoladelfino",children:"Nicola Delfino"})," post on ",(0,t.jsx)(i.a,{href:"https://nicolgit.github.io/azure-measuring-latency-across-availability-zones-in-we/",children:"Measuring latency between Azure Availability Zones and the impact of an NVA in between V2"})," I will run through multiple scenarios for the New Zealand North Azure Region:"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["Same v-net, same availability zone, same ",(0,t.jsx)(i.a,{href:"https://learn.microsoft.com/azure/virtual-machines/co-location?WT.mc_id=AZ-MVP-5004796",children:"proximty placement"})," group"]}),"\n",(0,t.jsx)(i.li,{children:"Same v-net, across availability zones"}),"\n",(0,t.jsx)(i.li,{children:"multiple v-nets (in peering), same availability zone"}),"\n",(0,t.jsx)(i.li,{children:"multiple v-nets (in peering) across availability zones"}),"\n",(0,t.jsx)(i.li,{children:"multiple v-nets connected in a Hub & Spoke topology and Routing via Azure Firewall"}),"\n"]}),"\n",(0,t.jsxs)(i.h2,{id:"-scenario-1---same-virtual-network-same-availability-zone-same-proximty-placement-group",children:["\ud83c\udfe2 Scenario 1 - Same Virtual Network, same availability zone, same ",(0,t.jsx)(i.a,{href:"https://learn.microsoft.com/azure/virtual-machines/co-location?WT.mc_id=AZ-MVP-5004796",children:"proximty placement"})," group"]}),"\n",(0,t.jsxs)(i.p,{children:["In this scenario, we will have a single VNET, with a single subnet, and two virtual machines in the same availability zone, and the same ",(0,t.jsx)(i.a,{href:"https://learn.microsoft.com/azure/virtual-machines/co-location?WT.mc_id=AZ-MVP-5004796",children:"proximty placement"})," group."]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{alt:"Same VNET, same availability zone, same proximity placement group",src:n(41855).A+"",width:"3320",height:"1200"})}),"\n",(0,t.jsx)(i.p,{children:"In this example, we have VM1 talking to VM2."}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.strong,{children:"VM1 (Sender - 10.0.1.4) - VM2 (Receiver - 10.0.1.5)"})}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"Metric"}),(0,t.jsx)(i.th,{children:"Value"}),(0,t.jsx)(i.th,{children:"Notes"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Protocol"})}),(0,t.jsx)(i.td,{children:"TCP"}),(0,t.jsx)(i.td,{children:"Connection-oriented, reliable"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Send Method"})}),(0,t.jsx)(i.td,{children:"Blocking"}),(0,t.jsx)(i.td,{children:"Waits for completion"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Receive Method"})}),(0,t.jsx)(i.td,{children:"Blocking"}),(0,t.jsx)(i.td,{children:"Waits for completion"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SO_SNDBUF"})}),(0,t.jsx)(i.td,{children:"Default"}),(0,t.jsx)(i.td,{children:"Default socket send buffer size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SO_RCVBUF"})}),(0,t.jsx)(i.td,{children:"Default"}),(0,t.jsx)(i.td,{children:"Default socket receive buffer size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Msg Size (byte)"})}),(0,t.jsx)(i.td,{children:"4"}),(0,t.jsx)(i.td,{children:"Small message payload size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Iterations"})}),(0,t.jsx)(i.td,{children:"60,000"}),(0,t.jsx)(i.td,{children:"Number of send/receive cycles"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Latency (usec)"})}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"72.75"})}),(0,t.jsx)(i.td,{children:"Average time per message"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"CPU (%)"})}),(0,t.jsx)(i.td,{children:"6.5"}),(0,t.jsx)(i.td,{children:"CPU utilization during test"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"CtxSwitch/sec"})}),(0,t.jsx)(i.td,{children:"27,874 (2.03/iteration)"}),(0,t.jsx)(i.td,{children:"Context switches per second"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SysCall/sec"})}),(0,t.jsx)(i.td,{children:"28,590 (2.08/iteration)"}),(0,t.jsx)(i.td,{children:"System calls per second"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Interrupt/sec"})}),(0,t.jsx)(i.td,{children:"58,447 (4.25/iteration)"}),(0,t.jsx)(i.td,{children:"Hardware interrupts per second"})]})]})]}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Latency(usec): 72.75"})," \u2013 The average latency per message is 72.75 microseconds. This is the time it takes for a message to be sent and received back, which is relatively low and suggests a reasonably fast response time for small message sizes."]}),"\n",(0,t.jsx)(i.h2,{id:"-scenario-2---same-virtual-network-same-availability-zone-virtual-machine-not-in-proximity-placement-group",children:"\ud83c\udf10 Scenario 2 - Same Virtual Network, same availability zone, virtual machine NOT in proximity placement group"}),"\n",(0,t.jsx)(i.p,{children:"In this scenario, we will have a single VNET, with a single subnet, and two virtual machines in the same availability zone, but not in the same proximty placement group."}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{alt:"Same VNET, same availability zone, VM NOT in proximity placement group",src:n(31978).A+"",width:"3363",height:"1213"})}),"\n",(0,t.jsx)(i.p,{children:"We will be talking from VM1 to VM3."}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.strong,{children:"VM1 (Sender) - VM3 (Receiver)"})}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"Metric"}),(0,t.jsx)(i.th,{children:"Value"}),(0,t.jsx)(i.th,{children:"Notes"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Protocol"})}),(0,t.jsx)(i.td,{children:"TCP"}),(0,t.jsx)(i.td,{children:"Connection-oriented, reliable"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Send Method"})}),(0,t.jsx)(i.td,{children:"Blocking"}),(0,t.jsx)(i.td,{children:"Waits for completion"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Receive Method"})}),(0,t.jsx)(i.td,{children:"Blocking"}),(0,t.jsx)(i.td,{children:"Waits for completion"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SO_SNDBUF"})}),(0,t.jsx)(i.td,{children:"Default"}),(0,t.jsx)(i.td,{children:"Default socket send buffer size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SO_RCVBUF"})}),(0,t.jsx)(i.td,{children:"Default"}),(0,t.jsx)(i.td,{children:"Default socket receive buffer size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Msg Size (byte)"})}),(0,t.jsx)(i.td,{children:"4"}),(0,t.jsx)(i.td,{children:"Small message payload size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Iterations"})}),(0,t.jsx)(i.td,{children:"60,000"}),(0,t.jsx)(i.td,{children:"Number of send/receive cycles"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Latency (usec)"})}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"55.97"})}),(0,t.jsx)(i.td,{children:"Average time per message"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"CPU (%)"})}),(0,t.jsx)(i.td,{children:"14.9"}),(0,t.jsx)(i.td,{children:"CPU utilization during test"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"CtxSwitch/sec"})}),(0,t.jsx)(i.td,{children:"36,652 (2.05/iteration)"}),(0,t.jsx)(i.td,{children:"Context switches per second"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SysCall/sec"})}),(0,t.jsx)(i.td,{children:"39,293 (2.20/iteration)"}),(0,t.jsx)(i.td,{children:"System calls per second"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Interrupt/sec"})}),(0,t.jsx)(i.td,{children:"68,617 (3.84/iteration)"}),(0,t.jsx)(i.td,{children:"Hardware interrupts per second"})]})]})]}),"\n",(0,t.jsxs)(i.p,{children:["The table lists the latency and system performance between ",(0,t.jsx)(i.strong,{children:"VM1 (Sender)"})," and ",(0,t.jsx)(i.strong,{children:"VM3 (Receiver)"}),". The average latency per message is ",(0,t.jsx)(i.strong,{children:"55.97 microseconds"}),", which is interesting and slightly lower than the previous scenario, and not what I expected, however, could be luck of the draw - something worth noting that without a proximity placement group, the next time I would deallocate this Virtual Machine, it could be spun up in a separate place within the zone."]}),"\n",(0,t.jsx)(i.h2,{id:"-scenario-3---same-virtual-network-across-availability-zones",children:"\ud83d\udd17 Scenario 3 - Same Virtual Network, across availability zones"}),"\n",(0,t.jsx)(i.p,{children:"In this scenario, we will have a single VNET with a single subnet and two virtual machines in different availability zones."}),"\n",(0,t.jsxs)(i.p,{children:["We keep the same VM1 ",(0,t.jsx)(i.em,{children:"(in Zone 1)"}),", but we will be talking to VM4 and VM5 (which are in different availability zones). VM4 is in Zone 2 and VM5 is in Zone 3."]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{alt:"Same VNET, across availability zones",src:n(41628).A+"",width:"4000",height:"2250"})}),"\n",(0,t.jsxs)(i.p,{children:["First lets look at VM1 (Avaliability 1) talking to VM4 ",(0,t.jsx)(i.em,{children:"(Avalibility Zone 2)"}),"."]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.strong,{children:"VM1 (Sender) - VM4 (Receiver)"})}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"Metric"}),(0,t.jsx)(i.th,{children:"Value"}),(0,t.jsx)(i.th,{children:"Notes"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Protocol"})}),(0,t.jsx)(i.td,{children:"TCP"}),(0,t.jsx)(i.td,{children:"Connection-oriented, reliable"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Send Method"})}),(0,t.jsx)(i.td,{children:"Blocking"}),(0,t.jsx)(i.td,{children:"Waits for completion"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Receive Method"})}),(0,t.jsx)(i.td,{children:"Blocking"}),(0,t.jsx)(i.td,{children:"Waits for completion"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SO_SNDBUF"})}),(0,t.jsx)(i.td,{children:"Default"}),(0,t.jsx)(i.td,{children:"Default socket send buffer size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SO_RCVBUF"})}),(0,t.jsx)(i.td,{children:"Default"}),(0,t.jsx)(i.td,{children:"Default socket receive buffer size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Msg Size (byte)"})}),(0,t.jsx)(i.td,{children:"4"}),(0,t.jsx)(i.td,{children:"Small message payload size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Iterations"})}),(0,t.jsx)(i.td,{children:"60,000"}),(0,t.jsx)(i.td,{children:"Number of send/receive cycles"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Latency (usec)"})}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"559.67"})}),(0,t.jsx)(i.td,{children:"Average time per message"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"CPU (%)"})}),(0,t.jsx)(i.td,{children:"1.5"}),(0,t.jsx)(i.td,{children:"CPU utilization during test"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"CtxSwitch/sec"})}),(0,t.jsx)(i.td,{children:"3,742 (2.09/iteration)"}),(0,t.jsx)(i.td,{children:"Context switches per second"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SysCall/sec"})}),(0,t.jsx)(i.td,{children:"4,529 (2.53/iteration)"}),(0,t.jsx)(i.td,{children:"System calls per second"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Interrupt/sec"})}),(0,t.jsx)(i.td,{children:"8,801 (4.93/iteration)"}),(0,t.jsx)(i.td,{children:"Hardware interrupts per second"})]})]})]}),"\n",(0,t.jsxs)(i.p,{children:["The table summarizes the latency and system performance between ",(0,t.jsx)(i.strong,{children:"VM1 (Sender)"})," and ",(0,t.jsx)(i.strong,{children:"VM4 (Receiver)"}),". The average latency per message is ",(0,t.jsx)(i.strong,{children:"559.67 microseconds"}),", significantly higher than in the previous scenarios. This is expected as the two virtual machines are in different availability zones."]}),"\n",(0,t.jsxs)(i.p,{children:["Next lets look at VM1 (Avaliability 1) talking to VM5 ",(0,t.jsx)(i.em,{children:"(Avalibility Zone 3)"}),"."]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.strong,{children:"VM1 (Sender) - VM5 (Receiver)"})}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"Metric"}),(0,t.jsx)(i.th,{children:"Value"}),(0,t.jsx)(i.th,{children:"Notes"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Protocol"})}),(0,t.jsx)(i.td,{children:"TCP"}),(0,t.jsx)(i.td,{children:"Connection-oriented, reliable"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Send Method"})}),(0,t.jsx)(i.td,{children:"Blocking"}),(0,t.jsx)(i.td,{children:"Waits for completion"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Receive Method"})}),(0,t.jsx)(i.td,{children:"Blocking"}),(0,t.jsx)(i.td,{children:"Waits for completion"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SO_SNDBUF"})}),(0,t.jsx)(i.td,{children:"Default"}),(0,t.jsx)(i.td,{children:"Default socket send buffer size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SO_RCVBUF"})}),(0,t.jsx)(i.td,{children:"Default"}),(0,t.jsx)(i.td,{children:"Default socket receive buffer size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Msg Size (byte)"})}),(0,t.jsx)(i.td,{children:"4"}),(0,t.jsx)(i.td,{children:"Small message payload size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Iterations"})}),(0,t.jsx)(i.td,{children:"60,000"}),(0,t.jsx)(i.td,{children:"Number of send/receive cycles"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Latency (usec)"})}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"559.25"})}),(0,t.jsx)(i.td,{children:"Average time per message"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"CPU (%)"})}),(0,t.jsx)(i.td,{children:"0.9"}),(0,t.jsx)(i.td,{children:"CPU utilization during test"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"CtxSwitch/sec"})}),(0,t.jsx)(i.td,{children:"3,868 (2.16/iteration)"}),(0,t.jsx)(i.td,{children:"Context switches per second"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SysCall/sec"})}),(0,t.jsx)(i.td,{children:"4,464 (2.50/iteration)"}),(0,t.jsx)(i.td,{children:"System calls per second"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Interrupt/sec"})}),(0,t.jsx)(i.td,{children:"7,721 (4.32/iteration)"}),(0,t.jsx)(i.td,{children:"Hardware interrupts per second"})]})]})]}),"\n",(0,t.jsxs)(i.p,{children:["This table summarizes the latency and system performance between ",(0,t.jsx)(i.strong,{children:"VM1 (Sender)"})," and ",(0,t.jsx)(i.strong,{children:"VM5 (Receiver)"}),". The average latency per message is ",(0,t.jsx)(i.strong,{children:"559.25 microseconds"}),", which is similar to the previous scenario. This is expected as the two virtual machines are in different availability zones."]}),"\n",(0,t.jsxs)(i.p,{children:["Finally, lets look at VM4 ",(0,t.jsx)(i.em,{children:"(Avaliability Zone 2)"})," talking to VM5 ",(0,t.jsx)(i.em,{children:"(Avalibility Zone 3)"}),"."]}),"\n",(0,t.jsx)(i.p,{children:"VM4 (Sender) - VM5 (Receiver)"}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"Metric"}),(0,t.jsx)(i.th,{children:"Value"}),(0,t.jsx)(i.th,{children:"Notes"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Protocol"})}),(0,t.jsx)(i.td,{children:"TCP"}),(0,t.jsx)(i.td,{children:"Connection-oriented, reliable"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Send Method"})}),(0,t.jsx)(i.td,{children:"Blocking"}),(0,t.jsx)(i.td,{children:"Waits for completion"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Receive Method"})}),(0,t.jsx)(i.td,{children:"Blocking"}),(0,t.jsx)(i.td,{children:"Waits for completion"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SO_SNDBUF"})}),(0,t.jsx)(i.td,{children:"Default"}),(0,t.jsx)(i.td,{children:"Default socket send buffer size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SO_RCVBUF"})}),(0,t.jsx)(i.td,{children:"Default"}),(0,t.jsx)(i.td,{children:"Default socket receive buffer size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Msg Size (byte)"})}),(0,t.jsx)(i.td,{children:"4"}),(0,t.jsx)(i.td,{children:"Small message payload size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Iterations"})}),(0,t.jsx)(i.td,{children:"60,000"}),(0,t.jsx)(i.td,{children:"Number of send/receive cycles"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Latency (usec)"})}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"494.23"})}),(0,t.jsx)(i.td,{children:"Average time per message"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"CPU (%)"})}),(0,t.jsx)(i.td,{children:"3.6"}),(0,t.jsx)(i.td,{children:"CPU utilization during test"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"CtxSwitch/sec"})}),(0,t.jsx)(i.td,{children:"5,218 (2.58/iteration)"}),(0,t.jsx)(i.td,{children:"Context switches per second"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SysCall/sec"})}),(0,t.jsx)(i.td,{children:"13,445 (6.65/iteration)"}),(0,t.jsx)(i.td,{children:"System calls per second"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Interrupt/sec"})}),(0,t.jsx)(i.td,{children:"9,212 (4.55/iteration)"}),(0,t.jsx)(i.td,{children:"Hardware interrupts per second"})]})]})]}),"\n",(0,t.jsxs)(i.p,{children:["This table summarizes the latency and system performance between ",(0,t.jsx)(i.strong,{children:"VM4 (Sender)"})," and ",(0,t.jsx)(i.strong,{children:"VM5 (Receiver)"}),". The average latency per message is ",(0,t.jsx)(i.strong,{children:"494.23 microseconds"}),", which is slightly lower than the previous scenarios. This is expected as the two virtual machines are in different availability zones."]}),"\n",(0,t.jsx)(i.p,{children:"Even though the latency is higher than the previous scenarios, it is still relatively low and suggests a reasonably fast response time for small message sizes."}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"VM1 to VM4: 559.67 microseconds"}),"\n",(0,t.jsx)(i.li,{children:"VM1 to VM5: 559.25 microseconds"}),"\n",(0,t.jsx)(i.li,{children:"VM4 to VM5: 494.23 microseconds"}),"\n"]}),"\n",(0,t.jsxs)(i.p,{children:["All of these latency values are ",(0,t.jsx)(i.strong,{children:"well below 1 millisecond"}),", indicating ",(0,t.jsx)(i.strong,{children:"sub-millisecond latency"})," between the VMs, in different zones within the same Virtual Network and subnet."]}),"\n",(0,t.jsx)(i.h2,{id:"--scenario-4---multiple-virtual-networks-peered-same-availability-zone",children:"\ud83d\udda7  Scenario 4 - Multiple Virtual Networks (peered), same availability zone"}),"\n",(0,t.jsx)(i.p,{children:"In this scenario, we will have two virtual networks, each with a single subnet, and two virtual machines in the same availability zone."}),"\n",(0,t.jsxs)(i.p,{children:["We will have VM1 ",(0,t.jsx)(i.em,{children:"(10.0.1.4)"})," in our Spoke1 network, talking to VM2 ",(0,t.jsx)(i.em,{children:"(10.0.2.4)"}),", in our spoke2 network, each VM is in Availability Zone 1 and the two Virtual Networks are peered through a Hub Virtual Network, with user-defined routes, so they can talk to each other. I made use of ",(0,t.jsx)(i.a,{href:"https://learn.microsoft.com/azure/virtual-network-manager/overview?WT.mc_id=AZ-MVP-5004796",children:"Azure Virtual Network Manager"}),", and a Mesh configuration to deploy the peering and user defined routes between the Virtual Networks."]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{alt:"Multiple VNETs (peered), same availability zone",src:n(12942).A+"",width:"4000",height:"2250"})}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.strong,{children:"VM1 (Sender) - VM2 (Receiver) through VNet Peering"})}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"Metric"}),(0,t.jsx)(i.th,{children:"Value"}),(0,t.jsx)(i.th,{children:"Notes"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Protocol"})}),(0,t.jsx)(i.td,{children:"TCP"}),(0,t.jsx)(i.td,{children:"Connection-oriented, reliable"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Send Method"})}),(0,t.jsx)(i.td,{children:"Blocking"}),(0,t.jsx)(i.td,{children:"Waits for completion"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Receive Method"})}),(0,t.jsx)(i.td,{children:"Blocking"}),(0,t.jsx)(i.td,{children:"Waits for completion"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SO_SNDBUF"})}),(0,t.jsx)(i.td,{children:"Default"}),(0,t.jsx)(i.td,{children:"Default socket send buffer size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SO_RCVBUF"})}),(0,t.jsx)(i.td,{children:"Default"}),(0,t.jsx)(i.td,{children:"Default socket receive buffer size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Msg Size (byte)"})}),(0,t.jsx)(i.td,{children:"4"}),(0,t.jsx)(i.td,{children:"Small message payload size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Iterations"})}),(0,t.jsx)(i.td,{children:"60,000"}),(0,t.jsx)(i.td,{children:"Number of send/receive cycles"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Latency (usec)"})}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"67.81"})}),(0,t.jsx)(i.td,{children:"Average time per message"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"CPU (%)"})}),(0,t.jsx)(i.td,{children:"7.7"}),(0,t.jsx)(i.td,{children:"CPU utilization during test"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"CtxSwitch/sec"})}),(0,t.jsx)(i.td,{children:"30,010 (2.04/iteration)"}),(0,t.jsx)(i.td,{children:"Context switches per second"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SysCall/sec"})}),(0,t.jsx)(i.td,{children:"31,328 (2.12/iteration)"}),(0,t.jsx)(i.td,{children:"System calls per second"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Interrupt/sec"})}),(0,t.jsx)(i.td,{children:"66,269 (4.49/iteration)"}),(0,t.jsx)(i.td,{children:"Hardware interrupts per second"})]})]})]}),"\n",(0,t.jsxs)(i.p,{children:["This table summarizes the latency and system performance between ",(0,t.jsx)(i.strong,{children:"VM1 (Sender)"})," and ",(0,t.jsx)(i.strong,{children:"VM2 (Receiver)"})," through VNet peering. The latency of 67.81 microseconds is still well under 1 millisecond for a Virtual Machine talking over a Virtual Network peering within the same Availability Zone."]}),"\n",(0,t.jsx)(i.h2,{id:"-scenario-5---multiple-virtual-networks-peered-across-availability-zones",children:"\ud83d\udda7 Scenario 5 - Multiple Virtual Networks (peered), across availability zones"}),"\n",(0,t.jsx)(i.p,{children:"In this scenario, we will have two virtual networks, each with a single subnet, and two virtual machines in different availability zones."}),"\n",(0,t.jsxs)(i.p,{children:["We will use the good old trusty VM1 again, and this time we will be talking to VM3 ",(0,t.jsx)(i.em,{children:"(Avaliability Zone 2)"})," and VM4 ",(0,t.jsx)(i.em,{children:"(Avaliability Zone 3)"}),", each in their own Virtual Network, and peered through a Hub Virtual Network, with user defined routes, so they can talk to each other."]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{alt:"Multiple VNETs (peered), across availability zones",src:n(74123).A+"",width:"4000",height:"2250"})}),"\n",(0,t.jsxs)(i.p,{children:["Here are the performance results for ",(0,t.jsx)(i.strong,{children:"VM1 (Sender) to VM3 (Receiver) through VNet peering"}),". VM1 is in ",(0,t.jsx)(i.strong,{children:"Availability Zone 1"})," and VM3 is in ",(0,t.jsx)(i.strong,{children:"Availability Zone 2"}),".:"]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.strong,{children:"VM1 (Sender) - VM3 (Receiver) in Availability Zone 2 through VNet Peering"})}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"Metric"}),(0,t.jsx)(i.th,{children:"Value"}),(0,t.jsx)(i.th,{children:"Notes"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Protocol"})}),(0,t.jsx)(i.td,{children:"TCP"}),(0,t.jsx)(i.td,{children:"Connection-oriented, reliable"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Send Method"})}),(0,t.jsx)(i.td,{children:"Blocking"}),(0,t.jsx)(i.td,{children:"Waits for completion"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Receive Method"})}),(0,t.jsx)(i.td,{children:"Blocking"}),(0,t.jsx)(i.td,{children:"Waits for completion"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SO_SNDBUF"})}),(0,t.jsx)(i.td,{children:"Default"}),(0,t.jsx)(i.td,{children:"Default socket send buffer size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SO_RCVBUF"})}),(0,t.jsx)(i.td,{children:"Default"}),(0,t.jsx)(i.td,{children:"Default socket receive buffer size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Msg Size (byte)"})}),(0,t.jsx)(i.td,{children:"4"}),(0,t.jsx)(i.td,{children:"Small message payload size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Iterations"})}),(0,t.jsx)(i.td,{children:"60,000"}),(0,t.jsx)(i.td,{children:"Number of send/receive cycles"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Latency (usec)"})}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"542.39"})}),(0,t.jsx)(i.td,{children:"Average time per message"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"CPU (%)"})}),(0,t.jsx)(i.td,{children:"1.9"}),(0,t.jsx)(i.td,{children:"CPU utilization during test"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"CtxSwitch/sec"})}),(0,t.jsx)(i.td,{children:"3,933 (2.13/iteration)"}),(0,t.jsx)(i.td,{children:"Context switches per second"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SysCall/sec"})}),(0,t.jsx)(i.td,{children:"5,043 (2.74/iteration)"}),(0,t.jsx)(i.td,{children:"System calls per second"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Interrupt/sec"})}),(0,t.jsx)(i.td,{children:"8,293 (4.50/iteration)"}),(0,t.jsx)(i.td,{children:"Hardware interrupts per second"})]})]})]}),"\n",(0,t.jsxs)(i.p,{children:["This table summarizes the latency and system performance between ",(0,t.jsx)(i.strong,{children:"VM1 (Sender)"})," and ",(0,t.jsx)(i.strong,{children:"VM3 (Receiver)"})," through VNet peering. The latency of 542.39 microseconds is still under 1 millisecond, between zones over a peered Virtual Network."]}),"\n",(0,t.jsxs)(i.p,{children:["Now, we need to test VM1 ",(0,t.jsx)(i.em,{children:"(Avaliability Zone 1)"})," by talking to VM4 ",(0,t.jsx)(i.em,{children:"(Avaliability Zone 3)"})," through VNet peering."]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.strong,{children:"VM1 (Sender) - VM4 (Receiver) in Availability Zone 3 through VNet Peering"})}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"Metric"}),(0,t.jsx)(i.th,{children:"Value"}),(0,t.jsx)(i.th,{children:"Notes"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Protocol"})}),(0,t.jsx)(i.td,{children:"TCP"}),(0,t.jsx)(i.td,{children:"Connection-oriented, reliable"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Send Method"})}),(0,t.jsx)(i.td,{children:"Blocking"}),(0,t.jsx)(i.td,{children:"Waits for completion"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Receive Method"})}),(0,t.jsx)(i.td,{children:"Blocking"}),(0,t.jsx)(i.td,{children:"Waits for completion"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SO_SNDBUF"})}),(0,t.jsx)(i.td,{children:"Default"}),(0,t.jsx)(i.td,{children:"Default socket send buffer size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SO_RCVBUF"})}),(0,t.jsx)(i.td,{children:"Default"}),(0,t.jsx)(i.td,{children:"Default socket receive buffer size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Msg Size (byte)"})}),(0,t.jsx)(i.td,{children:"4"}),(0,t.jsx)(i.td,{children:"Small message payload size"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Iterations"})}),(0,t.jsx)(i.td,{children:"60,000"}),(0,t.jsx)(i.td,{children:"Number of send/receive cycles"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Latency (usec)"})}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"311.53"})}),(0,t.jsx)(i.td,{children:"Average time per message"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"CPU (%)"})}),(0,t.jsx)(i.td,{children:"13.4"}),(0,t.jsx)(i.td,{children:"CPU utilization during test"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"CtxSwitch/sec"})}),(0,t.jsx)(i.td,{children:"9,721 (3.03/iteration)"}),(0,t.jsx)(i.td,{children:"Context switches per second"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SysCall/sec"})}),(0,t.jsx)(i.td,{children:"37,752 (11.76/iteration)"}),(0,t.jsx)(i.td,{children:"System calls per second"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Interrupt/sec"})}),(0,t.jsx)(i.td,{children:"13,496 (4.20/iteration)"}),(0,t.jsx)(i.td,{children:"Hardware interrupts per second"})]})]})]}),"\n",(0,t.jsxs)(i.p,{children:["This table summarizes the latency and system performance between ",(0,t.jsx)(i.strong,{children:"VM1 (Sender)"})," and ",(0,t.jsx)(i.strong,{children:"VM4 (Receiver)"})," in ",(0,t.jsx)(i.strong,{children:"Availability Zone 3"})," through ",(0,t.jsx)(i.strong,{children:"VNet peering"}),". The latency of 311.53 microseconds is still under 1 millisecond."]}),"\n",(0,t.jsx)(i.p,{children:"So far, we have seen that the latency between Virtual Machines in different availability zones over a peered Virtual Network is still under 1 millisecond. This is a great result and shows that Azure's network infrastructure is capable of providing low-latency communication between Virtual Machines in different availability zones."}),"\n",(0,t.jsx)(i.h2,{id:"\ufe0f-scenario-6---multiple-virtual-networks-connected-in-a-hub--spoke-topology-and-routing-via-azure-firewall",children:"\ud83d\udee1\ufe0f Scenario 6 - Multiple Virtual Networks connected in a Hub & Spoke topology and Routing via Azure Firewall"}),"\n",(0,t.jsx)(i.p,{children:"In this scenario, we will have three virtual networks, each with a single subnet, and three virtual machines in different availability zones, connecting to each other through a Hub Virtual Network, with user defined routes, and routing through an Azure Firewall."}),"\n",(0,t.jsx)(i.admonition,{type:"tip",children:(0,t.jsx)(i.p,{children:"If you are going through this in a Lab environment, make sure you have the necessary dependencies, such as the lattle executable setup on Virtual Machines or can share between them. As soon as the Firewall is in the mix, the default rules will block the traffic, so you will need to make sure you have the necessary rules in place to allow the traffic through."})}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{alt:"Multiple VNETs connected in a Hub &amp; Spoke topology and Routing via Azure Firewall",src:n(38368).A+"",width:"4000",height:"2250"})}),"\n",(0,t.jsxs)(i.p,{children:["The Azure Firewall configuration is a Standard SKU, with a Firewall policy and zone-redundant ",(0,t.jsx)(i.em,{children:"(across all 3 zones)"}),"."]}),"\n",(0,t.jsx)(i.p,{children:"We will start with VM1 in Avalibility Zone 1, talking to VM2 in Avalibility Zone 2 via the Azure Firewall and hub and spoke network."}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"VM 1 (Sender)"})," to ",(0,t.jsx)(i.strong,{children:"VM 2 (Receiver) -  Availability Zone 2 through Hub and Spoke Peering with Azure Firewall"})]}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"Metric"}),(0,t.jsx)(i.th,{children:"Value"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Protocol"})}),(0,t.jsx)(i.td,{children:"TCP"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SendMethod"})}),(0,t.jsx)(i.td,{children:"Blocking"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"ReceiveMethod"})}),(0,t.jsx)(i.td,{children:"Blocking"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SO_SNDBUF"})}),(0,t.jsx)(i.td,{children:"Default"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SO_RCVBUF"})}),(0,t.jsx)(i.td,{children:"Default"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"MsgSize (bytes)"})}),(0,t.jsx)(i.td,{children:"4"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Iterations"})}),(0,t.jsx)(i.td,{children:"60000"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Latency (usec)"})}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"1017.12"})})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"CPU (%)"})}),(0,t.jsx)(i.td,{children:"1.1"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"CtxSwitch/sec"})}),(0,t.jsx)(i.td,{children:"2692 (2.74/iteration)"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SysCall/sec"})}),(0,t.jsx)(i.td,{children:"5563 (5.66/iteration)"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Interrupt/sec"})}),(0,t.jsx)(i.td,{children:"4380 (4.45/iteration)"})]})]})]}),"\n",(0,t.jsxs)(i.p,{children:["This is the longest time we have seen so far, but still boarding on 1 millisecond, we can see how processing through the Azure Firewall and Hub and Spoke adds additional latency ",(0,t.jsx)(i.em,{children:"(as we would expect)"}),"  are routing through an Azure Firewall."]}),"\n",(0,t.jsx)(i.p,{children:"Next, we will look at VM1 in Avalibility Zone 1, talk to VM3 in Avalibility Zone 3 and spoke 3 via the Azure Firewall and hub and spoke network."}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"VM 1 (Sender)"})," to ",(0,t.jsx)(i.strong,{children:"VM 3 (Receiver)"})," -  Availability Zone 3 through Hub and Spoke Peering with Azure Firewall"]}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"Metric"}),(0,t.jsx)(i.th,{children:"Value"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Protocol"})}),(0,t.jsx)(i.td,{children:"TCP"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SendMethod"})}),(0,t.jsx)(i.td,{children:"Blocking"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"ReceiveMethod"})}),(0,t.jsx)(i.td,{children:"Blocking"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SO_SNDBUF"})}),(0,t.jsx)(i.td,{children:"Default"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SO_RCVBUF"})}),(0,t.jsx)(i.td,{children:"Default"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"MsgSize (bytes)"})}),(0,t.jsx)(i.td,{children:"4"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Iterations"})}),(0,t.jsx)(i.td,{children:"60000"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Latency (usec)"})}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"963.17"})})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"CPU (%)"})}),(0,t.jsx)(i.td,{children:"0.8"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"CtxSwitch/sec"})}),(0,t.jsx)(i.td,{children:"2450 (2.36/iteration)"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SysCall/sec"})}),(0,t.jsx)(i.td,{children:"4344 (4.18/iteration)"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Interrupt/sec"})}),(0,t.jsx)(i.td,{children:"4486 (4.32/iteration)"})]})]})]}),"\n",(0,t.jsxs)(i.p,{children:["This is a slightly lower latency than the previous scenario, but still underneath 1 millisecond, we can see how processing through the Azure Firewall and Hub and Spoke adds additional latency ",(0,t.jsx)(i.em,{children:"(as we would expect)"}),"  are routing through an Azure Firewall."]}),"\n",(0,t.jsx)(i.p,{children:"Finally, we will look at VM2 in Avalibility Zone 2, talk to VM3 in Avalibility Zone 3, and spoke 3 via the Azure Firewall and hub and spoke network."}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"Metric"}),(0,t.jsx)(i.th,{children:"Value"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Protocol"})}),(0,t.jsx)(i.td,{children:"TCP"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SendMethod"})}),(0,t.jsx)(i.td,{children:"Blocking"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"ReceiveMethod"})}),(0,t.jsx)(i.td,{children:"Blocking"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SO_SNDBUF"})}),(0,t.jsx)(i.td,{children:"Default"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SO_RCVBUF"})}),(0,t.jsx)(i.td,{children:"Default"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"MsgSize (bytes)"})}),(0,t.jsx)(i.td,{children:"4"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Iterations"})}),(0,t.jsx)(i.td,{children:"60000"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Latency (usec)"})}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"963.47"})})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"CPU (%)"})}),(0,t.jsx)(i.td,{children:"1.0"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"CtxSwitch/sec"})}),(0,t.jsx)(i.td,{children:"2933 (2.83/iteration)"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"SysCall/sec"})}),(0,t.jsx)(i.td,{children:"4756 (4.58/iteration)"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Interrupt/sec"})}),(0,t.jsx)(i.td,{children:"4556 (4.39/iteration)"})]})]})]}),"\n",(0,t.jsxs)(i.p,{children:["This is a slightly lower latency than the previous scenario, but still underneath 1 millisecond, we can see how processing through the Azure Firewall and Hub and Spoke adds additional latency ",(0,t.jsx)(i.em,{children:"(as we would expect)"}),"  are routing through an Azure Firewall."]}),"\n",(0,t.jsx)(i.h2,{id:"-summary",children:"\ud83d\udcdd Summary"}),"\n",(0,t.jsx)(i.p,{children:"The speed for inter-compute communication between the same and different Availability Zones for NZ North is very impressive. The latency between Virtual Machines in the same availability zone is well under 1 millisecond. The latency between Virtual Machines in different availability zones over a peered Virtual Network is still under 1 millisecond. Even with Azure Firewall and a Hub and Spoke network, the latency is still around 1 millisecond. This is a great result and shows that Azure's network infrastructure is capable of providing low-latency communication between Virtual Machines in different availability zones."}),"\n",(0,t.jsx)(i.p,{children:"Summary of my findings today, ordered by shortest to longest latency:"}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"Scenario"}),(0,t.jsx)(i.th,{children:"Latency (\xb5s)"}),(0,t.jsx)(i.th,{children:"Description"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Scenario 2"}),(0,t.jsx)(i.td,{children:"55.97"}),(0,t.jsx)(i.td,{children:"Same VNET, same availability zone, VM NOT in proximity placement group"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Scenario 4"}),(0,t.jsx)(i.td,{children:"67.81"}),(0,t.jsx)(i.td,{children:"Multiple VNETs (peered), same availability zone"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Scenario 1"}),(0,t.jsx)(i.td,{children:"72.75"}),(0,t.jsx)(i.td,{children:"Same VNET, same availability zone, same proximity placement group"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Scenario 5 (VM1 to VM4)"}),(0,t.jsx)(i.td,{children:"311.53"}),(0,t.jsx)(i.td,{children:"Multiple VNETs (peered), across availability zones (VM1 to VM4)"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Scenario 3 (VM4 to VM5)"}),(0,t.jsx)(i.td,{children:"494.23"}),(0,t.jsx)(i.td,{children:"Same VNET, across availability zones (VM4 to VM5)"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Scenario 5 (VM1 to VM3)"}),(0,t.jsx)(i.td,{children:"542.39"}),(0,t.jsx)(i.td,{children:"Multiple VNETs (peered), across availability zones (VM1 to VM3)"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Scenario 3 (VM1 to VM5)"}),(0,t.jsx)(i.td,{children:"559.25"}),(0,t.jsx)(i.td,{children:"Same VNET, across availability zones (VM1 to VM5)"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Scenario 3 (VM1 to VM4)"}),(0,t.jsx)(i.td,{children:"559.67"}),(0,t.jsx)(i.td,{children:"Same VNET, across availability zones (VM1 to VM4)"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Scenario 6 (VM1 to VM3)"}),(0,t.jsx)(i.td,{children:"963.17"}),(0,t.jsx)(i.td,{children:"Multiple VNETs, Hub & Spoke, Azure Firewall (VM1 to VM3)"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Scenario 6 (VM2 to VM3)"}),(0,t.jsx)(i.td,{children:"963.47"}),(0,t.jsx)(i.td,{children:"Multiple VNETs, Hub & Spoke, Azure Firewall (VM2 to VM3)"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"Scenario 6 (VM1 to VM2)"}),(0,t.jsx)(i.td,{children:"1017.12"}),(0,t.jsx)(i.td,{children:"Multiple VNETs, Hub & Spoke, Azure Firewall (VM1 to VM2)"})]})]})]}),"\n",(0,t.jsx)(i.p,{children:"Based on this testing, the New Zealand North region appears to have very low latency when compared with other Azure regions. This is great news for New Zealand organizations that are looking to move their workloads to the cloud. The low latency will help to ensure that their applications are responsive and performant."})]})}function h(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},91635:(e,i,n)=>{n.d(i,{A:()=>t});const t=n.p+"assets/images/AzureSpeed_NewZealandNorthInternetLatency-b0964f20aafd1363563197a925f46176.jpg"},41628:(e,i,n)=>{n.d(i,{A:()=>t});const t=n.p+"assets/images/NZN_LatencyTest_AvaliabilityGroups-992b42046a0afedd99a4a38b434f6a91.JPG"},38368:(e,i,n)=>{n.d(i,{A:()=>t});const t=n.p+"assets/images/NZN_LatencyTest_HubSpoke-96ffb5373593e3971e51882e63178466.JPG"},31978:(e,i,n)=>{n.d(i,{A:()=>t});const t=n.p+"assets/images/NZN_LatencyTest_NoProximityGroup-6a5909de82483f2eaf182671dc8d3059.JPG"},41855:(e,i,n)=>{n.d(i,{A:()=>t});const t=n.p+"assets/images/NZN_LatencyTest_ProximityGroup-6d011f086e68dbeee14a254970c3f343.JPG"},12942:(e,i,n)=>{n.d(i,{A:()=>t});const t=n.p+"assets/images/NZN_LatencyTest_VNetPeering-d43beb2882da418f9bec145833d89517.JPG"},74123:(e,i,n)=>{n.d(i,{A:()=>t});const t=n.p+"assets/images/NZN_LatencyTest_VNetPeering_AvaliabilityZones-fe0087480090af245d585ca2bc7fb15c.JPG"},81769:(e,i,n)=>{n.d(i,{A:()=>t});const t=n.p+"assets/images/Regions_AvaliabilityZones-e4f192fc2962f1d9336f6d6c91fad1ff.jpg"},28453:(e,i,n)=>{n.d(i,{R:()=>l,x:()=>d});var t=n(96540);const r={},s=t.createContext(r);function l(e){const i=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function d(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),t.createElement(s.Provider,{value:i},e.children)}}}]);