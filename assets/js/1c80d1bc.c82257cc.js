"use strict";(self.webpackChunklukemurraynz=self.webpackChunklukemurraynz||[]).push([[9079],{58329:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>u,contentTitle:()=>a,default:()=>h,frontMatter:()=>n,metadata:()=>s,toc:()=>c});var o=r(85893),i=r(11151);const n={title:"Authorization Permission Mismatch error with Azure Storage",metaDescription:"Learn how to fix the authorization permission mismatch error when copying files to an Azure Storage account in Azure DevOps pipeline.",description:'Resolve the "AuthorizationPermissionMismatch" error when copying files to Azure Storage in Azure DevOps pipeline.',date:new Date("2024-05-06T08:23:54.576Z"),tags:["Azure"],categories:["Azure"],authors:["Luke"],slug:"azure/authorization-permission-mismatch-error-azure-storage",keywords:["Azure","Authorization Permission Mismatch","Azure Storage","Azure DevOps pipeline","DevOps"]},a=void 0,s={permalink:"/azure/authorization-permission-mismatch-error-azure-storage",source:"@site/blog/2024-05-06-authorizationpermissionmismatchstorage/index.mdx",title:"Authorization Permission Mismatch error with Azure Storage",description:'Resolve the "AuthorizationPermissionMismatch" error when copying files to Azure Storage in Azure DevOps pipeline.',date:"2024-05-06T08:23:54.576Z",tags:[{label:"Azure",permalink:"/tags/azure"}],readingTime:.745,hasTruncateMarker:!0,authors:[{name:"Luke Murray",title:"Author",url:"https://luke.geek.nz",imageURL:"https://luke.geek.nz/img/logo.png",key:"Luke"}],frontMatter:{title:"Authorization Permission Mismatch error with Azure Storage",metaDescription:"Learn how to fix the authorization permission mismatch error when copying files to an Azure Storage account in Azure DevOps pipeline.",description:'Resolve the "AuthorizationPermissionMismatch" error when copying files to Azure Storage in Azure DevOps pipeline.',date:"2024-05-06T08:23:54.576Z",tags:["Azure"],categories:["Azure"],authors:["Luke"],slug:"azure/authorization-permission-mismatch-error-azure-storage",keywords:["Azure","Authorization Permission Mismatch","Azure Storage","Azure DevOps pipeline","DevOps"]},unlisted:!1,prevItem:{title:"Deploying Large Language Models on AKS with Kaito",permalink:"/azure/run-local-llm-aks"},nextItem:{title:"Federated Credentials to AKS Managed Identity",permalink:"/azure/federated-credentials-aks"}},u={authorsImageUrls:[void 0]},c=[];function l(e){const t={a:"a",admonition:"admonition",blockquote:"blockquote",p:"p",strong:"strong",...(0,i.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.p,{children:"When attempting to copy files in an Azure DevOps pipeline to an Azure Storage account, I received the following error:"}),"\n",(0,o.jsx)(t.admonition,{type:"warning",children:(0,o.jsxs)(t.p,{children:["##[error]Upload to container: 'StorageContainer' in storage account: 'ContosoStorageAccount' with blob prefix: '736' failed with error: 'AzCopy.exe exited with non-zero exit code while uploading files to blob storage.' For more info please refer to ",(0,o.jsx)(t.a,{href:"https://aka.ms/azurefilecopyreadme",children:"https://aka.ms/azurefilecopyreadme"}),"."]})}),"\n",(0,o.jsx)(t.p,{children:"After reviewing the Azure DevOps raw pipeline logs I noticed the following:"}),"\n",(0,o.jsx)(t.admonition,{type:"warning",children:(0,o.jsx)(t.p,{children:"2024-05-06T06:25:34.1051117Z --------------------------------------------------------------------------------\n2024-05-06T06:25:34.1052461Z RESPONSE 403: 403 This request is not authorized to perform this operation using this permission.\n2024-05-06T06:25:34.1053291Z ERROR CODE: AuthorizationPermissionMismatch\n2024-05-06T06:25:34.1055333Z --------------------------------------------------------------------------------"})}),"\n",(0,o.jsxs)(t.blockquote,{children:["\n",(0,o.jsx)(t.p,{children:"The fix was to make sure that the Service Principal that Azure DevOps is using to read/write to the Azure Storage account has the correct permissions to the Data plane *not just the Management plane."}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:["In my case, I needed to assign the  ",(0,o.jsxs)(t.strong,{children:[(0,o.jsx)(t.a,{href:"https://learn.microsoft.com/azure/role-based-access-control/built-in-roles?WT.mc_id=AZ-MVP-5004796#storage",children:"Storage Blob Data Contributor"})," role to the Service Principal"]}),"."]})]})}function h(e={}){const{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},11151:(e,t,r)=>{r.d(t,{Z:()=>s,a:()=>a});var o=r(67294);const i={},n=o.createContext(i);function a(e){const t=o.useContext(n);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),o.createElement(n.Provider,{value:t},e.children)}}}]);