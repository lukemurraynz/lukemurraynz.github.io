"use strict";(self.webpackChunklukemurraynz=self.webpackChunklukemurraynz||[]).push([[64260],{13626:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>p});var i=n(41272),a=n(74848),o=n(28453);const r={title:"IMS Payroll not opening as a published application in Azure Virtual Desktop",authors:["Luke"],tags:["Azure"],date:"2022-08-23 00:00:00 +1300",toc:!1,header:{teaser:"/uploads/imspayroll_avdpublishedapp.png"},slug:"azure/ims-payroll-not-opening-as-a-published-application-in-azure-virtual-desktop"},s=void 0,l={authorsImageUrls:[void 0]},p=[];function u(e){const t={a:"a",code:"code",em:"em",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.a,{href:"https://azure.microsoft.com/en-us/services/virtual-desktop/?WT.mc_id=AZ-MVP-5004796",title:" Azure Virtual Desktop",children:"Azure Virtual Desktop"})," allows you to access an entire desktop or a published application with shortcuts and an appearance like it was running locally; depending on the requirements; I prefer published applications where possible to keep the user experience on the endpoint device and keep the cost down."]}),"\n",(0,a.jsxs)(t.p,{children:["One of the applications I published for a customer is ",(0,a.jsx)(t.a,{href:"https://www.myob.com/nz/enterprise/ims-payroll",title:" MYOB IMS Payroll ",children:"MYOB IMS Payroll"}),"."]}),"\n",(0,a.jsx)(t.p,{children:"IMS Payroll worked well as a published application for months until one day; it didn't seem to open for the user, whether as a published application or in the Full Desktop."}),"\n",(0,a.jsxs)(t.p,{children:["The symptoms were that once the user clicked on the icon, it would appear to open ",(0,a.jsx)(t.em,{children:"(visible on the Taskbar)"}),", but there was no window, and when you hovered over the preview thumbnail, it was blank. The cursor also appeared to be active with a circle, indicating it was trying to open."]}),"\n",(0,a.jsx)(t.p,{children:"Even if you don't have IMS Payroll, you may experience applications with a similar experience, and hopefully, this article will help point you in the right direction."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Azure Virtual Desktop - Published Application",src:n(38707).A+"",width:"489",height:"264"})}),"\n",(0,a.jsx)(t.p,{children:"One noticeable difference we found in our testing - was that it opened for us and other users using different accounts."}),"\n",(0,a.jsx)(t.p,{children:"After some discovery, we discovered that the user had gone to another branch office site and used a different monitor setup, and IMS Payroll was out of drawing range. Usually, windows would be able to snap this back into view; however, after comparing the registry keys for our user vs the user who had the issue, we discovered that IMS Payroll sets the location in the user registry."}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["Registry Key location: ",(0,a.jsx)(t.strong,{children:"\\HKEY_CURRENT_USER\\IMS Payroll Partner\\Layout"})]}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"In our case, the settings were as follows:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:'Windows Registry Editor Version 5.00\n\n[HKEY_CURRENT_USER\\IMS Payroll Partner\\Layout]\n"Left"="684"\n"Top"="310"\n"Height"="713"\n"Width"="1127"\n"StatusBar"="1"\n"ActiveHelp"="0"\n"EmployeePage"="0"\n"PayrollPage"="5"\n"CompanyPage"="1"\n"SkipWelcome"="1"\n"SkinName"="lfUltraFlat"\n"LastPage"="6"\n'})}),"\n",(0,a.jsx)(t.p,{children:"For the users who couldn't see IMS Payroll, their settings looked more like this:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:'Windows Registry Editor Version 5.00\n\n[HKEY_CURRENT_USER\\IMS Payroll Partner\\Layout]\n"Left"="-1444"\n"Top"="310"\n"Height"="713"\n"Width"="1127"\n"StatusBar"="1"\n"ActiveHelp"="0"\n"EmployeePage"="0"\n"PayrollPage"="5"\n"CompanyPage"="1"\n"SkipWelcome"="1"\n"SkinName"="lfUltraFlat"\n"LastPage"="6"\n'})}),"\n",(0,a.jsx)(t.p,{children:"The difference was that the Left entry had moved the Window too far, left out of view, so it could not be seen by the user when opening as a published app or on a Desktop."}),"\n",(0,a.jsxs)(t.p,{children:["After the ",(0,a.jsx)(t.strong,{children:"Left entry was changed from -1444 to 684"}),". IMS became visible again as a published application and on the Full Desktop."]}),"\n",(0,a.jsx)(t.p,{children:"Due to the hard-coded user registry entries, this specific issue would have occurred regardless of Azure Virtual Desktop, running in a Terminal Services environment, or even locally, when working with different monitor setups."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.em,{children:"Note: Some applications may have configuration files stored in the user's AppData folders instead of the registry; if in doubt, raise a support ticket with the application vendor."})})]})}function d(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(u,{...e})}):u(e)}},38707:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/imspayroll_avdpublishedapp-63496f9c0d1e4f993fd23f1c36a76ad4.png"},28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>s});var i=n(96540);const a={},o=i.createContext(a);function r(e){const t=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(o.Provider,{value:t},e.children)}},41272:e=>{e.exports=JSON.parse('{"permalink":"/azure/ims-payroll-not-opening-as-a-published-application-in-azure-virtual-desktop","source":"@site/blog/2022-08-23-ims-payroll-not-opening-as-a-published-application-in-azure-virtual-desktop.md","title":"IMS Payroll not opening as a published application in Azure Virtual Desktop","description":"Azure Virtual Desktop allows you to access an entire desktop or a published application with shortcuts and an appearance like it was running locally; depending on the requirements; I prefer published applications where possible to keep the user experience on the endpoint device and keep the cost down.","date":"2022-08-23T00:00:00.000Z","tags":[{"inline":true,"label":"Azure","permalink":"/tags/azure"}],"readingTime":2.32,"hasTruncateMarker":false,"authors":[{"name":"Luke Murray","title":"Author","url":"https://luke.geek.nz","imageURL":"https://luke.geek.nz/img/logo.png","key":"Luke","page":null}],"frontMatter":{"title":"IMS Payroll not opening as a published application in Azure Virtual Desktop","authors":["Luke"],"tags":["Azure"],"date":"2022-08-23 00:00:00 +1300","toc":false,"header":{"teaser":"/uploads/imspayroll_avdpublishedapp.png"},"slug":"azure/ims-payroll-not-opening-as-a-published-application-in-azure-virtual-desktop"},"unlisted":false,"prevItem":{"title":"Azure Private DNS Resolver and Azure Point to Site VPN","permalink":"/azure/azure-point-to-site-vpn-and-private-dns-resolver"},"nextItem":{"title":"Microsoft Azure - Operational Cost Optimization Tasks","permalink":"/2022/08/18/microsoft-azure-cost-optimization-tasks"}}')}}]);