"use strict";(self.webpackChunklukemurraynz=self.webpackChunklukemurraynz||[]).push([[15352],{22718:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>g,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var r=n(74848),a=n(28453);const o={title:"How to create a Free Azure Log Analytics Workspace using PowerShell",authors:["Luke"],tags:["Azure"],date:"2021-07-10 00:00:00 +1300",toc:!1,header:{teaser:"/uploads/log_analytics_free.png"}},i=void 0,s={permalink:"/2021/07/10/how-to-create-a-free-log-analytics-workspace",source:"@site/blog/2021-07-10-how-to-create-a-free-log-analytics-workspace.md",title:"How to create a Free Azure Log Analytics Workspace using PowerShell",description:"When you create a Log Analytics workspace using the Azure Portal, you only get the Pricing or 'Pay-as-you-go' tiers to select.",date:"2021-07-10T00:00:00.000Z",tags:[{inline:!0,label:"Azure",permalink:"/tags/azure"}],readingTime:1.705,hasTruncateMarker:!1,authors:[{name:"Luke Murray",title:"Author",url:"https://luke.geek.nz",imageURL:"https://luke.geek.nz/img/logo.png",key:"Luke",page:null}],frontMatter:{title:"How to create a Free Azure Log Analytics Workspace using PowerShell",authors:["Luke"],tags:["Azure"],date:"2021-07-10 00:00:00 +1300",toc:!1,header:{teaser:"/uploads/log_analytics_free.png"}},unlisted:!1,prevItem:{title:"Configure Azure Virtual Desktop Monitoring Insights",permalink:"/2021/07/10/configure-azure-virtual-desktop-monitoring-insights"},nextItem:{title:"How to set a Log Analytics Daily Data Cap",permalink:"/2021/07/10/how-to-set-a-log-analytics-data-cap"}},c={authorsImageUrls:[void 0]},l=[{value:"Create a &#39;Free Tier&#39; Log Analytics using PowerShell",id:"create-a-free-tier-log-analytics-using-powershell",level:2}];function u(e){const t={a:"a",blockquote:"blockquote",code:"code",em:"em",h2:"h2",img:"img",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.p,{children:"When you create a Log Analytics workspace using the Azure Portal, you only get the Pricing or 'Pay-as-you-go' tiers to select."}),"\n",(0,r.jsx)(t.p,{children:"You used to create a 'Free' tier using the Azure Portal; however, since 2018; they removed it with a change in plans and it became a legacy offering."}),"\n",(0,r.jsx)(t.p,{children:"However, using PowerShell, you can still create a Log Analytics Free SKU!"}),"\n",(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsxs)(t.p,{children:["The Free pricing tier is a ",(0,r.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/azure/azure-monitor/logs/cost-logs?WT.mc_id=AZ-MVP-5004796#legacy-pricing-tiers",children:"legacy pricing tier"})," that is available for trying Azure Log Analytics. It has a data cap of 500 MB/day and only 7 days of data retention, so it is intended only for testing and is not to be used for production deployments."]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"You can change a Free Tier Log Analytics workspace to a Pay-as-you-go or commitment tier later."}),"\n",(0,r.jsxs)(t.p,{children:["You cannot change a Log Analytics workspace created on a higher tier back to Free, even using PowerShell, due to ",(0,r.jsx)(t.a,{href:"https://azure.microsoft.com/en-us/blog/introducing-a-new-way-to-purchase-azure-monitoring-services/?WT.mc_id=AZ-MVP-5004796",title:"Introducing a new way to purchase Azure monitoring services",children:"adjustments"})," in 2018 around the Log Analytics billing and plans."]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Azure Log Analytics - Free",src:n(39182).A+"",width:"1403",height:"246"})}),"\n",(0,r.jsx)(t.h2,{id:"create-a-free-tier-log-analytics-using-powershell",children:"Create a 'Free Tier' Log Analytics using PowerShell"}),"\n",(0,r.jsx)(t.p,{children:"Change the script's variables below to suit your environment, connect to Azure and run the script to create your Log Analytics workspace."}),"\n",(0,r.jsxs)(t.p,{children:["Note: I tested this script on an MSDN subscription, which I've had for a few years and a recent one created a few months back ",(0,r.jsx)(t.em,{children:"(2021)"}),", but there may be limitations on other subscription types that I haven't tested ",(0,r.jsx)(t.em,{children:"- see blurb below the script"}),"."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"#Connect to Azure\nConnect-AzAccount\n\n#Set Variables\n$ResourceGroup = 'aad_mgmt'\n$Location = 'australiaeast'\n$LogAnalyticsName = 'la-free'\n$SKU = 'Free'\n\n#Creates Log Analytics Workspace\nNew-AzOperationalInsightsWorkspace -Location $Location -Name $LogAnalyticsName -Sku $SKU -ResourceGroupName $ResourceGroup\n"})}),"\n",(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsxs)(t.p,{children:["If you get an error: Error Message: Pricing tier doesn't match the subscription's billing model. Read ",(0,r.jsx)(t.a,{href:"http://aka.ms/PricingTierWarning",title:"http://aka.ms/PricingTierWarning?WT.mc_id=AZ-MVP-5004796#moving-to-the-new-pricing-model",children:"http://aka.ms/PricingTierWarning"})," for more details, unfortunately it means that your Subscription is under a different Billing model, and may have been created recently are you are unable to use the 'Free' tier, instead you may have to create it using 'standard' instead."]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Azure Log Analytics - Free",src:n(4623).A+"",width:"980",height:"981"})})]})}function g(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},39182:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/log_analytics_free-e00e30f4763f8c161fd71b3089786959.png"},4623:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/log_analytics_free_tier-4d081be6f32051641bc832cade388f62.png"},28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>s});var r=n(96540);const a={},o=r.createContext(a);function i(e){const t=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),r.createElement(o.Provider,{value:t},e.children)}}}]);