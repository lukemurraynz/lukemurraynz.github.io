"use strict";(self.webpackChunklukemurraynz=self.webpackChunklukemurraynz||[]).push([[19259],{59991:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>u});var r=n(74848),s=n(28453);const a={title:"Azure Storage Account SFTP errors",authors:["Luke"],tags:["Azure"],date:"2021-12-27 00:00:00 +1300",toc:!0,header:{teaser:"images/iazure-marketplace-banner.png"},slug:"azure/azure-storage-account-sftp-errors"},o=void 0,i={permalink:"/azure/azure-storage-account-sftp-errors",source:"@site/blog/2021-12-27-azure-storage-account-sftp-errors.md",title:"Azure Storage Account SFTP errors",description:"As part of standing up and using an Azure Storage account as an SFTP service, I ran into a few issues. This blog post is merely intended to show my findings in case others run into similar issues.",date:"2021-12-27T00:00:00.000Z",tags:[{inline:!0,label:"Azure",permalink:"/tags/azure"}],readingTime:1.19,hasTruncateMarker:!1,authors:[{name:"Luke Murray",title:"Author",url:"https://luke.geek.nz",imageURL:"https://luke.geek.nz/img/logo.png",key:"Luke",page:null}],frontMatter:{title:"Azure Storage Account SFTP errors",authors:["Luke"],tags:["Azure"],date:"2021-12-27 00:00:00 +1300",toc:!0,header:{teaser:"images/iazure-marketplace-banner.png"},slug:"azure/azure-storage-account-sftp-errors"},unlisted:!1,prevItem:{title:"Day in the Life of a Technical Lead",permalink:"/2021/12/29/day-in-the-life-of-a-tech-lead"},nextItem:{title:"SFTP in Microsoft Azure using Azure Blob Storage",permalink:"/azure/sftp-in-microsoft-azure-using-azure-blob-storage"}},l={authorsImageUrls:[void 0]},u=[{value:"PTY allocation request failed on channel 0",id:"pty-allocation-request-failed-on-channel-0",level:4},{value:"Home Directory is not accessible",id:"home-directory-is-not-accessible",level:4},{value:"Wrong username, authentication failed",id:"wrong-username-authentication-failed",level:4},{value:"Unable to find Azure Storage SSH Keys",id:"unable-to-find-azure-storage-ssh-keys",level:4}];function c(e){const t={a:"a",em:"em",h4:"h4",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.p,{children:"As part of standing up and using an Azure Storage account as an SFTP service, I ran into a few issues. This blog post is merely intended to show my findings in case others run into similar issues."}),"\n",(0,r.jsx)(t.h4,{id:"pty-allocation-request-failed-on-channel-0",children:"PTY allocation request failed on channel 0"}),"\n",(0,r.jsx)(t.p,{children:"Even though you appear to have connected successfully, you may see the following errors:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"PTY allocation request failed on channel 0"}),"\n",(0,r.jsx)(t.li,{children:"shell request failed on channel 0"}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["You may laugh, but the solution for this was very simple, switch from SSH to ",(0,r.jsx)(t.strong,{children:"SFTP"}),"!"]}),"\n",(0,r.jsx)(t.p,{children:"If you were like me, I just flicked to SSH as a habit."}),"\n",(0,r.jsx)(t.h4,{id:"home-directory-is-not-accessible",children:"Home Directory is not accessible"}),"\n",(0,r.jsxs)(t.p,{children:["Make sure that the Home directory ",(0,r.jsx)(t.em,{children:"(Folder)"})," is created in your container, SFTP won't create this for you."]}),"\n",(0,r.jsx)(t.p,{children:"Also make sure that the Home directory for the user, references Container/Folder, like the below:"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Azure Portal - Enable SFTP",src:n(48487).A+"",title:"Azure Portal - Enable SFTP",width:"565",height:"331"})}),"\n",(0,r.jsx)(t.h4,{id:"wrong-username-authentication-failed",children:"Wrong username, authentication failed"}),"\n",(0,r.jsx)(t.p,{children:"When attempting to connect to SFTP using a tool such as WinSCP, I got:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:'Using username "lukeftpuser".'}),"\n",(0,r.jsx)(t.li,{children:"Authentication failed."}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"The username is actually comprised of:"}),"\n",(0,r.jsx)(t.p,{children:"STORAGEACCOUNTNAME+FTPNAME, ie: sftpstorageacc1337.lukeftpuser"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"WinSCP Connection Azure SFTP",src:n(34270).A+"",title:"WinSCP Connection Azure SFTP",width:"1076",height:"693"})}),"\n",(0,r.jsx)(t.h4,{id:"unable-to-find-azure-storage-ssh-keys",children:"Unable to find Azure Storage SSH Keys"}),"\n",(0,r.jsxs)(t.p,{children:["This is not an error, but Azure Keyvault, does not currently support SSH keypairs, so once they are created by Azure, they are stored in a Microsoft.Compute.sshPublicKeys resource found here: ",(0,r.jsx)(t.a,{href:"https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FsshPublicKeys",title:"SSH Keys",children:"SSH Keys"})]})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},48487:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/AzurePortal_SFTPLocalUsercreate-c78a42d5f6be4b35f07b68f984890d4a.png"},34270:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/sftp_winscptest-d3c15f460193e1dc9aa4548582c06d19.png"},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>i});var r=n(96540);const s={},a=r.createContext(s);function o(e){const t=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);