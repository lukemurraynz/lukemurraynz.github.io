"use strict";(self.webpackChunklukemurraynz=self.webpackChunklukemurraynz||[]).push([[14446],{62350:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>r,toc:()=>d});var r=n(62548),s=n(74848),t=n(28453);const a={title:"Deploying Azure Managed Redis with Bicep",metaDescription:"Learn how to deploy Azure Managed Redis using Bicep with code examples.",date:new Date("2025-01-02T08:45:51.802Z"),tags:["Azure"],categories:["Azure"],authors:["Luke"],slug:"azure/deploying-azure-managed-redis-with-bicep",keywords:["azure","Bicep","redis","ManagedRedis","cloud","iac","deployment","tutorial","caching"],description:"Learn how to deploy Azure Managed Redis using Bicep with code examples."},o=void 0,c={authorsImageUrls:[void 0]},d=[];function l(e){const i={a:"a",admonition:"admonition",code:"code",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.a,{href:"https://learn.microsoft.com/azure/azure-cache-for-redis/managed-redis/managed-redis-overview?WT.mc_id=AZ-MVP-5004796",children:"Azure Managed Redis"})," announced during ",(0,s.jsx)(i.a,{href:"https://techcommunity.microsoft.com/blog/AppsonAzureBlog/introducing-azure-managed-redis-cost-effective-caching-for-your-ai-apps/4299104?WT.mc_id=AZ-MVP-5004796",children:"Microsoft Ignite 2024"})," in Public Preview."]}),"\n",(0,s.jsx)(i.p,{children:"This is a new, fully-managed, first-party Redis offering in Microsoft Azure. Azure Managed Redis is available today in public preview. Microsoft Azure is the first major cloud service provider to offer customers a licensed, multi-tiered Redis service."}),"\n",(0,s.jsxs)(i.p,{children:["This article will show you how to deploy an Azure Managed Redis instance using ",(0,s.jsx)(i.a,{href:"https://learn.microsoft.com/azure/azure-resource-manager/bicep/overview?tabs=bicep&WT.mc_id=AZ-MVP-5004796",children:"Bicep"}),". Bicep is a Domain Specific Language (DSL) for deploying Azure resources declaratively. It aims to drastically simplify the authoring experience with a cleaner syntax and better support for modularity and code reuse."]}),"\n","\n",(0,s.jsxs)(i.admonition,{type:"info",children:[(0,s.jsx)(i.p,{children:"Every customer that migrates from any Azure Cache for Redis tier to Azure Managed Redis will gain access to years of Redis innovation. This builds on our existing integration with Microsoft Azure on the Enterprise and Enterprise Flash tiers for Azure Cache for Redis. With the introduction of Azure Managed Redis, users on Azure Cache for Redis can now access features that were previously found only on the Azure Cache for Redis Enterprise and Enterprise Flash tiers."}),(0,s.jsx)(i.p,{children:"Azure Managed Redis delivers on the best scale and SLA in the industry, building on the advancements first introduced by the Azure Cache for the Redis Enterprise tier. Users can now experience up to 99.999% availability when leveraging multi-region Active-Active, the highest availability offered in the market, powered by CRDT. Apps built with Azure Managed Redis can deliver down to sub-millisecond local latency to users globally and simultaneously, no matter which continent or region they\u2019re located on."})]}),"\n",(0,s.jsxs)(i.p,{children:["In this example, I have deployed Azure Managed Redis using Bicep, with bonus code snippets for connecting ",(0,s.jsx)(i.a,{href:"https://learn.microsoft.com/azure/api-management/api-management-key-concepts?WT.mc_id=AZ-MVP-5004796",children:"API Management"})," to the ",(0,s.jsx)(i.a,{href:"https://learn.microsoft.com/azure/azure-cache-for-redis/managed-redis/managed-redis-overview?WT.mc_id=AZ-MVP-5004796",children:"Azure Managed Redis"}),"."]}),"\n",(0,s.jsx)(i.p,{children:"The Bicep file creates a new Azure Managed Redis instance."}),"\n",(0,s.jsx)(i.p,{children:"Redis Enterprise Cache Setup"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Resource Type: Microsoft.Cache/redisEnterprise"}),"\n",(0,s.jsx)(i.li,{children:"API Version: 2024-09-01-preview"}),"\n",(0,s.jsx)(i.li,{children:"Name: redisEnterprise"}),"\n",(0,s.jsx)(i.li,{children:"Location: Uses a variable location"}),"\n",(0,s.jsx)(i.li,{children:"Tags: Uses a variable tags"}),"\n",(0,s.jsx)(i.li,{children:"SKU: Specifies the SKU as MemoryOptimized_M10"}),"\n",(0,s.jsx)(i.li,{children:"Properties: Sets the minimum TLS version to 1.2"}),"\n"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-bicep",children:"// Redis Enterprise Cache setup\nresource redisEnterprise 'Microsoft.Cache/redisEnterprise@2024-09-01-preview' = {\n  name: 'redisEnterprise'\n  location: location\n  tags: tags\n  sku: {\n    name: 'MemoryOptimized_M10'\n  }\n  properties: {\n    minimumTlsVersion: '1.2'\n  }\n}\n\noutput redisEnterpriseName string = redisEnterprise.name\n"})}),"\n",(0,s.jsx)(i.p,{children:"This part of the Bicep file sets up a Redis Enterprise Cache instance with specific configurations such as location, tags, SKU, and minimum TLS version."}),"\n",(0,s.jsx)(i.p,{children:"Redis Cache Database Setup"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Resource Type: Microsoft.Cache/redisEnterprise/databases"}),"\n",(0,s.jsx)(i.li,{children:"API Version: 2024-09-01-preview"}),"\n",(0,s.jsx)(i.li,{children:"Name: default"}),"\n",(0,s.jsx)(i.li,{children:"Parent: Links to the redisEnterprise resource defined earlier\nProperties:"}),"\n",(0,s.jsx)(i.li,{children:"Access Keys Authentication: Disabled"}),"\n",(0,s.jsx)(i.li,{children:"Eviction Policy: No eviction"}),"\n",(0,s.jsx)(i.li,{children:"Clustering Policy: Enterprise cluster"}),"\n",(0,s.jsx)(i.li,{children:"Modules: Includes the RediSearch module"}),"\n",(0,s.jsx)(i.li,{children:"Port: Sets the port to 10000"}),"\n"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-bicep",children:"resource redisCache 'Microsoft.Cache/redisEnterprise/databases@2024-09-01-preview' = {\n  name: 'default'\n  parent: redisEnterprise\n  properties: {\n    accessKeysAuthentication: 'Disabled'\n    evictionPolicy: 'NoEviction'\n    clusteringPolicy: 'EnterpriseCluster'\n    modules: [\n      {\n        name: 'RediSearch'\n      }\n    ]\n    port: 10000\n  }\n}\n"})}),"\n",(0,s.jsx)(i.p,{children:"This part sets up a Redis Cache Database within the Redis Enterprise Cache instance. It configures properties such as access key authentication, eviction policy, clustering policy, modules, and port."}),"\n",(0,s.jsx)(i.p,{children:"You can also link API Management to the Azure Managed Redis resource as a bonus. This is a small snippet of the Connection string for API Management:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-bicep",children:"redisCacheConnectionString: '${redisEnterprise.properties.hostName}:${10000},ssl=True,abortConnect=False'\n"})}),"\n",(0,s.jsx)(i.p,{children:"This is using Entra ID authentication to connect to the Redis Cache using the following role assignment to the API System Managed Identity:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-bicep",children:"// Redis Access Policy Assignment\nresource redisAccessPolicyAssignmentName 'Microsoft.Cache/redisEnterprise/databases/accessPolicyAssignments@2024-09-01-preview' = {\n  name: take('cachecontributor${uniqueString(resourceGroup().id)}', 24)\n  parent: redisCache\n  properties: {\n    accessPolicyName: 'default'\n    user: {\n      objectId: apim.outputs.apimPrincipalId\n    }\n  }\n}\n"})})]})}function u(e={}){const{wrapper:i}={...(0,t.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},28453:(e,i,n)=>{n.d(i,{R:()=>a,x:()=>o});var r=n(96540);const s={},t=r.createContext(s);function a(e){const i=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function o(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(t.Provider,{value:i},e.children)}},62548:e=>{e.exports=JSON.parse('{"permalink":"/azure/deploying-azure-managed-redis-with-bicep","source":"@site/blog/2025-01-02-azuremanagedrediscachebicep/index.mdx","title":"Deploying Azure Managed Redis with Bicep","description":"Learn how to deploy Azure Managed Redis using Bicep with code examples.","date":"2025-01-02T08:45:51.802Z","tags":[{"inline":true,"label":"Azure","permalink":"/tags/azure"}],"readingTime":2.92,"hasTruncateMarker":true,"authors":[{"name":"Luke Murray","title":"Author","url":"https://luke.geek.nz","imageURL":"https://luke.geek.nz/img/logo.png","key":"Luke","page":null}],"frontMatter":{"title":"Deploying Azure Managed Redis with Bicep","metaDescription":"Learn how to deploy Azure Managed Redis using Bicep with code examples.","date":"2025-01-02T08:45:51.802Z","tags":["Azure"],"categories":["Azure"],"authors":["Luke"],"slug":"azure/deploying-azure-managed-redis-with-bicep","keywords":["azure","Bicep","redis","ManagedRedis","cloud","iac","deployment","tutorial","caching"],"description":"Learn how to deploy Azure Managed Redis using Bicep with code examples."},"unlisted":false,"prevItem":{"title":"Pre-commit Hooks in GitHub Codespaces for Terraform IaC","permalink":"/misc/precommit-hooks-codespaces-terraform-iac"},"nextItem":{"title":"Using Azure Communication Services and UMI PowerShell to Send Emails","permalink":"/azure/using-communication-services-and-umi-powershell-to-send-emails"}}')}}]);