"use strict";(self.webpackChunklukemurraynz=self.webpackChunklukemurraynz||[]).push([[93210],{53220:(e,o,t)=>{t.r(o),t.d(o,{assets:()=>i,contentTitle:()=>s,default:()=>m,frontMatter:()=>r,metadata:()=>a,toc:()=>u});var n=t(74848),l=t(28453);const r={date:"2021-06-18 00:00:00 +1200",title:"Remove old PowerShell modules versions using PowerShell",authors:["Luke"],tags:["PowerShell"],toc:!1,header:{teaser:"images/powershell-blog-feature-banner.png"}},s=void 0,a={permalink:"/2021/06/18/remove-old-powershell-modules-versions-using-powershell",source:"@site/blog/2021-06-18-remove-old-powershell-modules-versions-using-powershell.md",title:"Remove old PowerShell modules versions using PowerShell",description:"Did you know, that if you update PowerShell modules, the old versions can sometimes get left behind?",date:"2021-06-18T00:00:00.000Z",tags:[{label:"PowerShell",permalink:"/tags/power-shell"}],readingTime:.495,hasTruncateMarker:!1,authors:[{name:"Luke Murray",title:"Author",url:"https://luke.geek.nz",imageURL:"https://luke.geek.nz/img/logo.png",key:"Luke"}],frontMatter:{date:"2021-06-18 00:00:00 +1200",title:"Remove old PowerShell modules versions using PowerShell",authors:["Luke"],tags:["PowerShell"],toc:!1,header:{teaser:"images/powershell-blog-feature-banner.png"}},unlisted:!1,prevItem:{title:"How to create a Azure Virtual Desktop farm",permalink:"/2021/06/27/create-a-azure-virtual-desktop-farm"},nextItem:{title:"Add Log Analytics to Monitoring Agent with PowerShell",permalink:"/2021/06/13/add-log-analytics-workspace-to-microsoft-monitoring-agent-via-powershell"}},i={authorsImageUrls:[void 0]},u=[];function d(e){const o={code:"code",em:"em",p:"p",pre:"pre",...(0,l.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.p,{children:"Did you know, that if you update PowerShell modules, the old versions can sometimes get left behind?"}),"\n",(0,n.jsxs)(o.p,{children:["This little snippet with remove any old PowerShell modules ",(0,n.jsx)(o.em,{children:"(that are not the latest version)"}),", which are installed."]}),"\n",(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{children:'#requires -Version 2.0 -Modules PowerShellGet\nfunction Remove-OldModules\n{\n  <#\n<#\n    authors: [Luke] Murray (Luke.Geek.NZ)\n    Version: 0.1\n    Purpose: Basic function to remove old PowerShell modules which are installed\n#>\n\n  #>\n  $Latest = Get-InstalledModule \n  foreach ($module in $Latest) { \n    \n    Write-Verbose -Message "Uninstalling old versions of $($module.Name) [latest is $( $module.Version)]" -Verbose\n    Get-InstalledModule -Name $module.Name -AllVersions | Where-Object {$_.Version -ne $module.Version} | Uninstall-Module -Verbose \n  }\n}\n\nRemove-OldModules\n'})})]})}function m(e={}){const{wrapper:o}={...(0,l.R)(),...e.components};return o?(0,n.jsx)(o,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},28453:(e,o,t)=>{t.d(o,{R:()=>s,x:()=>a});var n=t(96540);const l={},r=n.createContext(l);function s(e){const o=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function a(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:s(e.components),n.createElement(r.Provider,{value:o},e.children)}}}]);