<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Microsoft Entra ID Application Proxy Implementation | luke.geek.nz</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://luke.geek.nz/img/social-card.png"><meta data-rh="true" name="twitter:image" content="https://luke.geek.nz/img/social-card.png"><meta data-rh="true" property="og:url" content="https://luke.geek.nz/azure/azure-active-directory-application-proxy-implementation/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Microsoft Entra ID Application Proxy Implementation | luke.geek.nz"><meta data-rh="true" name="description" content="Are you running internal web-based applications that you want to give access to users working remotely securely without the need for a VPN or firewall? Do you want to enforce or use Azure Conditional Access policies to protect and manage access?"><meta data-rh="true" property="og:description" content="Are you running internal web-based applications that you want to give access to users working remotely securely without the need for a VPN or firewall? Do you want to enforce or use Azure Conditional Access policies to protect and manage access?"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-01-02T11:00:00.000Z"><meta data-rh="true" property="article:author" content="https://luke.geek.nz"><meta data-rh="true" property="article:tag" content="Azure"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://luke.geek.nz/azure/azure-active-directory-application-proxy-implementation/"><link data-rh="true" rel="alternate" href="https://luke.geek.nz/azure/azure-active-directory-application-proxy-implementation/" hreflang="en"><link data-rh="true" rel="alternate" href="https://luke.geek.nz/azure/azure-active-directory-application-proxy-implementation/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://ZBH2T1WJQD-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="luke.geek.nz RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="luke.geek.nz Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="luke.geek.nz JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0QDLBY7NNN"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0QDLBY7NNN",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.94a74a36.css">
<script src="/assets/js/runtime~main.317c36f0.js" defer="defer"></script>
<script src="/assets/js/main.2d33fcfa.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#D3D3D3" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">If you haven't already make sure you sign up for my Weekly Azure Newsletter, straight to your inbox! <a target="_blank" rel="noopener noreferrer" href="https://newsletter.azurefeeds.com/join">Subscribe now!</a></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="luke.geek.nz" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="luke.geek.nz" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">luke.geek.nz</b></a><a class="navbar__item navbar__link" href="/Tags/">Tags</a><a class="navbar__item navbar__link" href="/Archive/">Blog</a><a class="navbar__item navbar__link" href="/about/">About</a></div><div class="navbar__items navbar__items--right"><a href="https://www.youtube.com/channel/UCUG3TKDTAZz4UXshGrjBBoQ" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="YouTube">
              <svg width="24" height="24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M23.498,6.186c-0.273-1.186-1.143-2.144-2.332-2.417C18.389,3.153,12,3.153,12,3.153s-6.389,0-9.166,0.616
                  c-1.19,0.273-2.06,1.23-2.332,2.417C0,8.07,0,12,0,12s0,3.93,0.502,5.814c0.272,1.187,1.142,2.062,2.332,2.335
                  C5.611,20.847,12,20.847,12,20.847s6.389,0,9.166-0.698c1.189-0.273,2.059-1.148,2.332-2.335C24,15.93,24,12,24,12
                  S24,8.07,23.498,6.186z M9.545,15.568V8.432l6.545,3.568L9.545,15.568z"/>
              </svg>
            </a><a href="https://aus.social/@lukemurray" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="Mastodon">
              <svg height="20" width="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" xml:space="preserve">
                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                <g id="SVGRepo_iconCarrier">
                  <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.510 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"></path>
                </g>
              </svg>
            </a><a href="https://bsky.app/profile/lukemurraynz.bsky.social" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="Bluesky">
              <svg class="octicon" xmlns="http://www.w3.org/2000/svg" role="img" viewBox="0 0 16 16" height="20" width="20" fill="currentColor">
                <title>Bluesky</title>
                <path d="M8 7.2c-.72-1.4-2.7-4.04-4.53-5.33C1.7.63 1.04.84.6 1.04.1 1.27 0 2.05 0 2.51c0 .46.25 3.77.42 4.32.54 1.82 2.47 2.45 4.25 2.25-2.6.38-4.92 1.33-1.88 4.71 3.33 3.46 4.57-.74 5.21-2.87.64 2.13 1.37 6.18 5.16 2.87 2.84-2.87.78-4.33-1.83-4.71 1.78.2 3.71-.43 4.25-2.25.17-.55.42-3.86.42-4.32 0-.46-.09-1.24-.6-1.47-.44-.2-1.11-.42-2.87.83A17.87 17.87 0 0 0 8 7.2Z"></path>
              </svg>
            </a><a href="https://twitter.com/lukemurraynz" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="X"><svg height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 8.586l4.293-4.293a1 1 0 011.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 011.414-1.414L10 8.586z" clip-rule="evenodd"/>
          </svg></a><a href="https://www.linkedin.com/in/ljmurray/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="LinkedIn"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"></path></svg></a><a href="https://luke.geek.nz/rss" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-rss-link" aria-label="RSS"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/implementing-sandbox-vending/">Implementing a Sandbox Environment in Microsoft Azure</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/change-timezone-azure-container-app/">Change the Timezone of your Azure Container App</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/azure-container-apps-overview/">Azure Container Apps - Overview</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/book-review-cloud-solution-architects-career-master-plan/">Book Review Cloud Solution Architects Career Master Plan</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/microsoft-azure-sandbox-design-considerations/">Microsoft Azure - Sandbox Design Considerations</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="Are you running internal web-based applications that you want to give access to users working remotely securely without the need for a VPN or firewall? Do you want to enforce or use Azure Conditional Access policies to protect and manage access?"><header><h1 class="title_f1Hy" itemprop="headline">Microsoft Entra ID Application Proxy Implementation</h1><div class="container_mt6G margin-vert--md"><time datetime="2022-01-02T11:00:00.000Z" itemprop="datePublished">January 2, 2022</time> · <!-- -->11 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Luke Murray</span></a></div><small class="avatar__subtitle" itemprop="description">Author</small></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>Are you running internal web-based applications that you want to give access to users working remotely securely without the need for a VPN or firewall? Do you want to enforce or use Azure Conditional Access policies to protect and manage access?</p>
<p>Let me introduce the Microsoft Microsoft Entra ID Application Proxy...</p>
<blockquote>
<p>Application Proxy is a feature of Azure AD that enables users to access on-premises web applications from a remote client. Application Proxy includes both the Application Proxy service which runs in the cloud, and the Application Proxy connector, which runs on an on-premises server. Azure AD, the Application Proxy service, and the Application Proxy connector work together to securely pass the user sign-on token from Azure AD to the web application. Application Proxy also supports single sign-on.</p>
<p>Application Proxy is recommended for giving remote users access to internal resources. Application Proxy replaces the need for a VPN or reverse proxy.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p>The <a href="https://learn.microsoft.com/en-us/azure/active-directory/app-proxy/what-is-application-proxy?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Microsoft Entra ID Application Proxy</a>has been around for a few years, but appears to be a hidden gem; the Application Proxy allows users_(by using Microsoft Entra ID and an Application Proxy Connector(s))_ to connect to internally hosted web applications, by the connector relaying the traffic.</p>
<p><img loading="lazy" alt="Azure Application Proxy - Network Diagram" src="/assets/images/aadproxynetworkdiagram-2d5765b62500f7d92259285b4c784c9a.png" title="Azure Application Proxy - Network Diagram" width="602" height="504" class="img_ev3q"></p>
<p>Application Proxy supports the following types of applications:</p>
<ul>
<li>Web applications</li>
<li>Web APIs that you want to expose to rich applications on different devices</li>
<li>Applications hosted behind a Remote Desktop Gateway</li>
<li>Rich client apps that are integrated with the Microsoft Authentication Library (MSAL)</li>
</ul>
<p>Azure Application Proxy can often be overlooked to solve your business requirements without the need to implement costly third-party firewalls <em>(it also doesn&#x27;t have to be an on-premises workload, for example, if the web application is running on a VM in Azure, it will also work)</em>.</p>
<p>The Azure Application proxy connector is a lightweight agent installed on a Windows Server machine that is logically close to the backend service that you want to deliver through the proxy.</p>
<p>The Connector gives access to and relays the information to the Application proxy service in Microsoft Azure via HTTP/HTTPS as long as it has access to the following:</p>






























<table><thead><tr><th>URL</th><th>Port</th><th>How it&#x27;s used</th></tr></thead><tbody><tr><td>*.msappproxy.net  *.servicebus.windows.net</td><td>443/HTTPS</td><td>Communication between the connector and the Application Proxy cloud service</td></tr><tr><td>crl3.digicert.com  crl4.digicert.com  ocsp.digicert.com  crl.microsoft.com  oneocsp.microsoft.com  ocsp.msocsp.com</td><td>80/HTTP</td><td>The connector uses these URLs to verify certificates.</td></tr><tr><td>login.windows.net  secure.aadcdn.microsoftonline-p.com  *.microsoftonline.com  *.microsoftonline-p.com  *.msauth.net  *.msauthimages.net  *.msecnd.net  *.msftauth.net  *.msftauthimages.net  *.phonefactor.net  enterpriseregistration.windows.net  management.azure.com  policykeyservice.dc.ad.msft.net  ctldl.windowsupdate.com  <a href="http://www.microsoft.com/pkiops" target="_blank" rel="noopener noreferrer">www.microsoft.com/pkiops</a></td><td>443/HTTPS</td><td>The connector uses these URLs during the registration process.</td></tr><tr><td>ctldl.windowsupdate.com</td><td>80/HTTP</td><td>The connector uses this URL during the registration process.</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="setup-azure-application-proxy">Setup Azure Application Proxy<a href="#setup-azure-application-proxy" class="hash-link" aria-label="Direct link to Setup Azure Application Proxy" title="Direct link to Setup Azure Application Proxy">​</a></h2>
<p>I will set up an Azure Application Proxy to grant access to my Synology NAS <em>(Network Attached Storage)</em> device web page in this guide.</p>
<p>Although I am using my local NAS web administration page, it can be any webpage <em>(Unifi Controller, hosted on Apache, IIS etc.)</em> accessible from the connector.</p>
<ul>
<li>I have a Windows Server 2022 Domain Controller.</li>
<li>Synology NAS <em>(not domain joined, but accessible on the network via a DNS record from the domain)</em></li>
<li>Microsoft 365 Developer subscription with appropriate licenses</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pre-requisites-for-azure-application-proxy-setup">Pre-requisites for Azure Application Proxy setup<a href="#pre-requisites-for-azure-application-proxy-setup" class="hash-link" aria-label="Direct link to Pre-requisites for Azure Application Proxy setup" title="Direct link to Pre-requisites for Azure Application Proxy setup">​</a></h3>
<p>The following resources and rights will be needed to set up Azure Application Proxy:</p>
<ul>
<li>An Microsoft Entra ID tenant</li>
<li>A minimum of Application Administrator rights is required to set up the Application and user and group assignments.</li>
<li>A server running Windows Server 2012 R2 or above to install the Application Proxy connector on (and the permissions to install)</li>
<li>If you are using a third-party domain <em>(you will need a public SSL certificate)</em> and, of course, the ability to edit external DNS records, the domain will need to be added to Microsoft Entra ID as a custom domain in order to be used.</li>
<li>Microsoft Entra ID Premium P1 license or M365 Business Premium/E3 license for each user using Microsoft Entra ID Application Proxy.</li>
</ul>
<p><img loading="lazy" alt="Microsoft Entra ID Application Proxy Licensing" src="/assets/images/aadproxylicensing-bda70e279c4daf764b4e2b22e93233e9.png" title="Microsoft Entra ID Application Proxy Licensing" width="633" height="55" class="img_ev3q"></p>
<p><em>(Note: Normal <a href="https://learn.microsoft.com/en-us/azure/active-directory/enterprise-users/directory-service-limits-restrictions?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Azure AD service limits</a> and restrictions apply)</em>.</p>
<p>I will be configuring the Azure Application Proxy on a domain controller running Windows Server 2022.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="disable-ie-enhanced-security-configuration">Disable IE Enhanced Security Configuration<a href="#disable-ie-enhanced-security-configuration" class="hash-link" aria-label="Direct link to Disable IE Enhanced Security Configuration" title="Direct link to Disable IE Enhanced Security Configuration">​</a></h3>
<p>The Azure Application Proxy connector requires you to log in to Microsoft Azure, and I will be installing this on a Windows Server 2022 domain controller; if this Enhanced Security Configuration is enabled <em>(as it should be),</em> you will have problems authenticating to Microsoft Azure, so the easiest thing is to turn it off temporarily.</p>
<ol>
<li>Open <strong>Server Manager</strong></li>
<li>Click on <strong>Local Server</strong></li>
<li>Click on: <strong>IE Enhanced Security Configuration</strong></li>
<li>Select Off for: <strong>Administrators</strong></li>
<li><strong>Close</strong> Microsoft <strong>Edge</strong> <em>(if you have it opened)</em></li>
<li><img loading="lazy" alt="Disable IE Enhanced Security Configuration" src="/assets/images/disable_ie_enhancedconfiguration-ecc7f2fdbacc3ea58762a88de73ba352.png" title="Disable IE Enhanced Security Configuration" width="583" height="482" class="img_ev3q"></li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-azure-application-proxy-connector">Install Azure Application Proxy Connector<a href="#install-azure-application-proxy-connector" class="hash-link" aria-label="Direct link to Install Azure Application Proxy Connector" title="Direct link to Install Azure Application Proxy Connector">​</a></h3>
<ol>
<li>Login to <strong>Azure Portal</strong> <em>(on the server that you want to install the Connector on)</em></li>
<li>Navigate to: <a href="https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview" target="_blank" rel="noopener noreferrer"><strong>Microsoft Entra ID</strong></a></li>
<li>Select <strong>Application Proxy</strong></li>
<li><img loading="lazy" alt="Azure Portal - Application Proxy" src="/assets/images/azureportal-applicationproxy-86f9196860d71d2c19d3c4ccfa961650.png" title="Azure Portal - Application Proxy" width="602" height="313" class="img_ev3q"></li>
<li>Click on: <strong>Download connector service</strong>.</li>
<li>Accept the system requirements and click <strong>Accept Terms &amp; Download</strong></li>
<li>A file named: &#x27;AADApplicationProxyConnectorInstaller.exe&#x27; should have been downloaded. <strong>Run</strong> it.</li>
<li>Select: <strong>I agree to the license terms and conditions</strong> and select <strong>Install</strong></li>
<li><img loading="lazy" alt="Microsoft Microsoft Entra ID Application Proxy Connector Installation" src="/assets/images/microsoftazureapplicationproxyconnector-c2f1a096f171f271ab2c9a6e8b45e02a.png" title="Microsoft Microsoft Entra ID Application Proxy Connector Installation" width="493" height="348" class="img_ev3q"></li>
<li>Wait for the Microsoft Microsoft Entra ID Application to display and <strong>log in</strong> with an Microsoft Entra ID account with Application Administrator rights.</li>
<li>The Microsoft Microsoft Entra ID Application <strong>Connector will now</strong> be <strong>registered</strong> in your Microsoft Entra ID tenancy.</li>
<li><img loading="lazy" alt="Microsoft Microsoft Entra ID Application Proxy Connector Installation" src="/assets/images/microsoftazureapplicationproxyconnectorinstalled-61d6ed3714b23ac1900054990e10f310.png" title="Microsoft Microsoft Entra ID Application Proxy Connector Installation" width="491" height="343" class="img_ev3q"></li>
<li>Click <strong>Close</strong></li>
<li>Now <strong>re-enable IE enhanced security configuration</strong>.</li>
</ol>
<p>You should now see two new services appear in services as Automatic (Delayed Start):</p>
<ul>
<li>WAPCsvc - Microsoft AAD Application Proxy Connector</li>
<li>WAPCUpdaterSvc - Microsoft AAD Application Proxy Connector Updater</li>
</ul>
<p>And the following processes running:</p>
<ul>
<li>ApplicationProxyConnectorService</li>
<li>ApplicationProxyConnectorUpdateService</li>
</ul>
<p><img loading="lazy" alt="ApplicationProxyConnectorService" src="/assets/images/azureaadapplicationservices-44038a6b932081da6451e4fa70622052.png" title="ApplicationProxyConnectorService" width="602" height="173" class="img_ev3q"></p>
<p>If you are running Server Core, Microsoft Microsoft Entra ID Application Proxy can be installed via <a href="https://learn.microsoft.com/en-us/azure/active-directory/app-proxy/application-proxy-register-connector-powershell?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">PowerShell</a>.</p>
<p>The Azure Application Proxy Connector agent gets <a href="https://learn.microsoft.com/en-us/azure/active-directory/app-proxy/application-proxy-faq?WT.mc_id=AZ-MVP-5004796#why-is-my-connector-still-using-an-older-version-and-not-auto-upgraded-to-latest-version-" target="_blank" rel="noopener noreferrer">updated</a> automatically when a new major version is released by Microsoft.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-connector-group">Configure Connector Group<a href="#configure-connector-group" class="hash-link" aria-label="Direct link to Configure Connector Group" title="Direct link to Configure Connector Group">​</a></h3>
<p>Now that you have created the Connector, the Application Proxy has put our Connector in a group that has defaulted to Asia; because you can have more than one Application Proxy Connector for redundancy and different applications, we will create a new Connector Group that is set to use the Australia region if Asia works for you – feel free to skip this step.</p>
<ol>
<li>Login to <strong>Azure Portal</strong> <em>(on any PC/server)</em></li>
<li>Navigate to: <a href="https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview" target="_blank" rel="noopener noreferrer"><strong>Microsoft Entra ID</strong></a></li>
<li>Select <strong>Application Proxy</strong></li>
<li>You should now see: Default and your Region</li>
<li>If you <strong>expand</strong> the Default <strong>Group</strong>, will you see your Connector:</li>
<li><img loading="lazy" alt="Azure AD Application Proxy Connector Groups" src="/assets/images/azureportal-applicationproxyconnector-56f8578ab1b3a34309b53d160f93e878.png" title="Azure AD Application Proxy Connector Groups" width="602" height="151" class="img_ev3q"></li>
<li>Click on <strong>+ New Connector Group</strong></li>
<li>Give it a <strong>name</strong> <em>(i.e., On-premises</em>)</li>
<li><strong>Select</strong> the <strong>Connector</strong> you had earlier and <strong>select the</strong> region closest to you <em>(currently, the following regions can be chosen: Asia, Australia, Europe, North America)</em></li>
<li><img loading="lazy" alt="Azure AD Application Proxy - New Connector Group" src="/assets/images/azureportal-applicationproxynewconnectorgroup-af685c5de5ec636fd2a720195010423a.png" title="Azure AD Application Proxy - New Connector Group" width="418" height="470" class="img_ev3q"></li>
<li><strong>Click + Create</strong></li>
<li>Clicking create will create your new On-premises connector group and add the Connector to the group.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-your-azure-application-proxy-application">Configure your Azure Application Proxy Application<a href="#configure-your-azure-application-proxy-application" class="hash-link" aria-label="Direct link to Configure your Azure Application Proxy Application" title="Direct link to Configure your Azure Application Proxy Application">​</a></h3>
<p>Now that you have your Connector setup, its time to set up your application</p>
<ol>
<li>Login to <strong>Azure Portal</strong> <em>(on any PC/server)</em></li>
<li>Navigate to: <a href="https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview" target="_blank" rel="noopener noreferrer"><strong>Microsoft Entra ID</strong></a></li>
<li>Select <strong>Application Proxy</strong></li>
<li>Click on: <strong>+ Configure an app</strong></li>
<li><strong>Fill</strong> in the <strong>details</strong> that match your <strong>application</strong>:</li>
</ol>
<ul>
<li><strong>Name</strong>: This is the application that users will see <em>(i.e. I am going with Pizza, which is the name of my NAS)</em></li>
<li><strong>Internal URL</strong>: This is the internal URL used to access your application inside the network <em>(in my example, it is:</em> <a href="http://pizza.corp.contoso.com/" target="_blank" rel="noopener noreferrer"><em>http://pizza.corp.contoso.com/</em></a><em>)</em></li>
<li><strong>External Url</strong>: This is the external URL that will be created so that users can access the application form; <em>I will go with Pizza.</em> Note this URL down.</li>
<li><strong>Pre-Authentication</strong>: You don&#x27;t have to authenticate with Azure AD, you can use passthrough, but it is not something I would recommend without delving into requirements, testing <em>– I am going to select: Microsoft Entra ID.</em></li>
<li><strong>Connector Group</strong>: Select the connector group you created earlier or that your Connector is signed to.</li>
<li><strong>Leave</strong> all <strong>Additional Settings as default</strong> – they can be changed later if you need to.
<ol>
<li><img loading="lazy" alt="Azure Application Proxy" src="/assets/images/azureportal-applicationproxynewapplication-7cbf63f59473a9b7f78b087eb198d7a4.png" width="602" height="435" class="img_ev3q"></li>
<li><strong>Verify</strong> that <strong>everything</strong> is filled out <strong>correctly</strong> and, click <strong>+ Add</strong></li>
<li>Azure <strong>Application Proxy has now created a new Enterprise Application for you</strong>; based on the name mentioned earlier, if you navigate to the external URL mentioned earlier, you should get a prompt similar to below:</li>
<li><img loading="lazy" alt="Azure AD Login Error" src="/assets/images/azureportal-pizzaloginerror-42785ab1e8d5408afaa8f43d233fe870.png" title="Azure AD Login Error" width="573" height="205" class="img_ev3q"></li>
<li>It is now time to assign the permissions for users to access the Application via Microsoft Entra ID!</li>
</ol>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="assign-rights-to-your-azure-application-proxy-application">Assign rights to your Azure Application Proxy Application<a href="#assign-rights-to-your-azure-application-proxy-application" class="hash-link" aria-label="Direct link to Assign rights to your Azure Application Proxy Application" title="Direct link to Assign rights to your Azure Application Proxy Application">​</a></h3>
<ol>
<li>Login to <strong>Azure Portal</strong> <em>(on any PC/server)</em></li>
<li>Navigate to: <a href="https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview" target="_blank" rel="noopener noreferrer"><strong>Microsoft Entra ID</strong></a></li>
<li>Select <a href="https://portal.azure.com/#blade/Microsoft_AAD_IAM/StartboardApplicationsMenuBlade/AllApps/menuId/" target="_blank" rel="noopener noreferrer"><strong>Enterprise Applications</strong></a></li>
<li><strong>Find</strong> the <strong>application</strong> that was <strong>created</strong> earlier by the Azure Application Proxy service.</li>
<li><img loading="lazy" alt="Microsoft Entra ID, Enterprise Application" src="/assets/images/azureportal-enterpriseapplicationspane-2de4247bb9234dde05d2671a5ec32782.png" title="Microsoft Entra ID, Enterprise Application" width="602" height="181" class="img_ev3q"></li>
<li>Click on the <strong>Application</strong></li>
<li>Click on: <strong>Users and Groups</strong></li>
<li>Click <strong>Add Assignment</strong></li>
<li><strong>Add</strong> a <strong>user</strong> or <strong>group</strong> <em>(preferred)</em> you want to have access to this application.</li>
<li>Click <strong>Assigned</strong></li>
<li><img loading="lazy" alt="Azure AD Enterprise Applications - User &amp;amp; Group Assignment" src="/assets/images/azureportal-enterpriseapplicationsuserandgrpassignment-69d996be442fdced516b430831d8bd01.png" title="Azure AD Enterprise Applications - User &amp;amp; Group Assignment" width="602" height="164" class="img_ev3q"></li>
<li>Click on <strong>Application Proxy</strong></li>
<li>Here you can see and edit the information you created earlier when you created the application, <strong>copy</strong> the <strong>External URL</strong></li>
<li><strong>Open</strong> Microsoft <strong>Edge</strong> (<em>or another browser of your choice)</em></li>
<li><strong>Paste</strong> in the External <strong>URL</strong></li>
<li><strong>Log in</strong> with the Microsoft Entra ID <strong>account</strong> that was <strong>assigned</strong> to the Enterprise <strong>application.</strong></li>
<li>You should now have access to your on-premises web application from anywhere in the world, and because you are using Microsoft Entra ID, your conditional access policies and restrictions will be in effect:</li>
<li><img loading="lazy" alt="Synology Login" src="/assets/images/microsoftazureapplicationproxyloginscreen-fe39694a6d81ded2c515d3593bada620.png" title="Synology Login" width="602" height="366" class="img_ev3q"></li>
</ol>
<p><em>Note: Because the Synology web interface was running on port: 5000, I had to go back and add the port to the internal URL, as the Application Proxy was attempting to route to the incorrect port.</em>
<em>Note: You may also notice that Microsoft has supplied an *.msappproxy.net certificate, even if your backend service doesn&#x27;t have one..</em></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="setup-password-based-single-sign-on">Setup Password-based Single-Sign on<a href="#setup-password-based-single-sign-on" class="hash-link" aria-label="Direct link to Setup Password-based Single-Sign on" title="Direct link to Setup Password-based Single-Sign on">​</a></h3>
<p>Azure Application Proxy supports various <a href="https://learn.microsoft.com/en-us/azure/active-directory/app-proxy/application-proxy-config-sso-how-to?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">single</a> sign-on methods, including Kerberos SPN integration.</p>
<p>However, my Synology NAS uses standalone accounts, so I will set Password-based single sign-on, allowing the MyApps extension to store my credentials <em>(if you want single-sign-on using the password-based sign in, then every user will need to have this extension configured)</em>.</p>
<ol>
<li>Download and install the <a href="https://microsoftedge.microsoft.com/addons/detail/my-apps-secure-signin-ex/gaaceiggkkiffbfdpmfapegoiohkiipl#:~:text=My%20Apps%20Secure%20Sign-in%20Extension.%20This%20extension%20is,to%20cloud%20applications%20within%20your%20organization%20or%20school." target="_blank" rel="noopener noreferrer"><strong>MyApps Secure Sign-in extension</strong></a></li>
<li><strong>Log</strong> in using your Microsoft account to the MyApps <strong>extension</strong></li>
<li><img loading="lazy" alt="Azure App Proxy" src="data:image/png;base64,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" width="55" height="42" class="img_ev3q"></li>
<li><strong>Login</strong> to <strong>Azure Portal</strong> (<em>on any PC/server)</em></li>
<li>Navigate to: <a href="https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview" target="_blank" rel="noopener noreferrer"><strong>Microsoft Entra ID</strong></a></li>
<li>Select <a href="https://portal.azure.com/#blade/Microsoft_AAD_IAM/StartboardApplicationsMenuBlade/AllApps/menuId/" target="_blank" rel="noopener noreferrer"><strong>Enterprise Applications</strong></a></li>
<li><strong>Find</strong> the <strong>application</strong> that was created earlier by the Azure Application Proxy service.</li>
<li>Click on <strong>Single sign-on</strong></li>
<li>Select <strong>Password-based</strong></li>
<li><img loading="lazy" alt="Azure Portal - Single Signon" src="/assets/images/azureportal-appproxysso-787853e55af00ba7c8b93691b516313c.png" title="Azure Portal - Single Signon" width="602" height="330" class="img_ev3q"></li>
<li><strong>Type</strong> in the <strong>URL</strong> of the <strong>authentication webpage</strong> and click <strong>Save</strong></li>
<li><img loading="lazy" alt="Azure App Proxy" src="/assets/images/azureportal-appproxyssourl-5d42405a2a11ec8a734f62010a7cb9b1.png" width="602" height="177" class="img_ev3q"></li>
<li>The Azure AD Application Proxy didn&#x27;t find my sign-in login and password fields, so I have to manually configure them, select: <strong>Configure Pizza Password Single Sign-on Settings</strong>.</li>
<li>Select: <strong>Manually detect sign-in fields</strong></li>
<li>Select <strong>Capture sign-in fields</strong></li>
<li><img loading="lazy" alt="Azure Application Proxy - Configure Sign-on" src="/assets/images/azureportal-configuresignin-3690c855754ef80ac421487f34713026.png" title="Azure Application Proxy - Configure Sign-on" width="427" height="567" class="img_ev3q"></li>
<li>Your MS Edge Extension should show <strong>Capture Field</strong>:</li>
<li><img loading="lazy" alt="Azure Application Configure Extension" src="/assets/images/azureportal-configuresigninextension-a9373fc3fa8b9ce4efd87a8c26837697.png" title="Azure Application Configure Extension" width="602" height="368" class="img_ev3q"></li>
<li><strong>Enter</strong> in your <strong>username</strong></li>
<li>Press <strong>Enter</strong></li>
<li><strong>Enter</strong> in your <strong>password</strong></li>
<li><strong>Select</strong> the MS Apps <strong>extension</strong> and select <strong>Save</strong></li>
<li>Navigate back to the <strong>Azure Portal</strong></li>
<li>Select &#x27;<strong>I was able to sign in.&#x27;</strong></li>
<li>If successful, <strong>Azure AD should now have mapped the fields</strong>:</li>
<li><img loading="lazy" alt="Azure Portal - Signin Fields" src="/assets/images/azureportal-configuresigninextensionfields-3bff6979c56060c8d3cde50e5410bad1.png" title="Azure Portal - Signin Fields" width="602" height="229" class="img_ev3q"></li>
<li>Click <strong>Save</strong></li>
<li>Next time you log in to the application, the <strong>My Apps Secure Sign-in Extension will have cached the credentials.</strong> It should automatically log you into the application, meaning you should only log in once with your Azure AD credentials.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="access-your-azure-application-proxy-published-application">Access your Azure Application Proxy published application<a href="#access-your-azure-application-proxy-published-application" class="hash-link" aria-label="Direct link to Access your Azure Application Proxy published application" title="Direct link to Access your Azure Application Proxy published application">​</a></h3>
<ol>
<li>You can now go to <a href="https://myapps.microsoft.com/" target="_blank" rel="noopener noreferrer"><strong>My Apps (microsoft.com)</strong></a>, and you will <strong>see</strong> your <strong>application</strong>.</li>
<li><img loading="lazy" alt="M365 Waffle" src="/assets/images/myapps-99da4d897267d11262df7e4934a5b15f.png" width="894" height="491" class="img_ev3q"></li>
<li>Your application will also <strong>appear</strong> in the <strong>Microsoft 365 Waffle</strong> <em>(it may take up to an hour to appear)</em>:</li>
<li><img loading="lazy" alt="M365 Waffle" src="/assets/images/m365waffle_pizza-b955afd467d7362d5928c3f61e63d073.png" width="310" height="742" class="img_ev3q"></li>
</ol>
<p>I recommend you go into the Enterprise Application and upload a better image/logo so your users can quickly tell it apart.</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/azure/controlled-chaos-in-azure-using-chaos-studio/"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Controlled Chaos in Azure using Chaos Studio</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/2021/12/30/git-using-github-desktop-on-windows-for-sysadmins/"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Git using Github Desktop on Windows for SysAdmins</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#setup-azure-application-proxy" class="table-of-contents__link toc-highlight">Setup Azure Application Proxy</a><ul><li><a href="#pre-requisites-for-azure-application-proxy-setup" class="table-of-contents__link toc-highlight">Pre-requisites for Azure Application Proxy setup</a></li><li><a href="#disable-ie-enhanced-security-configuration" class="table-of-contents__link toc-highlight">Disable IE Enhanced Security Configuration</a></li><li><a href="#install-azure-application-proxy-connector" class="table-of-contents__link toc-highlight">Install Azure Application Proxy Connector</a></li><li><a href="#configure-connector-group" class="table-of-contents__link toc-highlight">Configure Connector Group</a></li><li><a href="#configure-your-azure-application-proxy-application" class="table-of-contents__link toc-highlight">Configure your Azure Application Proxy Application</a></li><li><a href="#assign-rights-to-your-azure-application-proxy-application" class="table-of-contents__link toc-highlight">Assign rights to your Azure Application Proxy Application</a></li><li><a href="#setup-password-based-single-sign-on" class="table-of-contents__link toc-highlight">Setup Password-based Single-Sign on</a></li><li><a href="#access-your-azure-application-proxy-published-application" class="table-of-contents__link toc-highlight">Access your Azure Application Proxy published application</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 luke.geek.nz. Powered by coffee, clouds and hamsters on wheels!</div></div></div></footer></div>
</body>
</html>