<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.2.1">
<title data-rh="true">Implementing a Sandbox Environment in Microsoft Azure | luke.geek.nz</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://luke.geek.nz/img/social-card.png"><meta data-rh="true" name="twitter:image" content="https://luke.geek.nz/img/social-card.png"><meta data-rh="true" property="og:url" content="https://luke.geek.nz/azure/implementing-sandbox-vending/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Implementing a Sandbox Environment in Microsoft Azure | luke.geek.nz"><meta data-rh="true" name="description" content="This article highlights reference implementation considerations for implementing a Sandbox environment in Microsoft Azure."><meta data-rh="true" property="og:description" content="This article highlights reference implementation considerations for implementing a Sandbox environment in Microsoft Azure."><meta data-rh="true" name="keywords" content="azure,sandbox,subscription vending,sandbox vending,Terraform,Infrastructure as Code,Azure DevOps,GitHub,Symphony"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-04-14T00:26:42.797Z"><meta data-rh="true" property="article:author" content="https://luke.geek.nz"><meta data-rh="true" property="article:tag" content="Azure"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://luke.geek.nz/azure/implementing-sandbox-vending/"><link data-rh="true" rel="alternate" href="https://luke.geek.nz/azure/implementing-sandbox-vending/" hreflang="en"><link data-rh="true" rel="alternate" href="https://luke.geek.nz/azure/implementing-sandbox-vending/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://ZBH2T1WJQD-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://luke.geek.nz/azure/implementing-sandbox-vending","mainEntityOfPage":"https://luke.geek.nz/azure/implementing-sandbox-vending","url":"https://luke.geek.nz/azure/implementing-sandbox-vending","headline":"Implementing a Sandbox Environment in Microsoft Azure","name":"Implementing a Sandbox Environment in Microsoft Azure","description":"This article highlights reference implementation considerations for implementing a Sandbox environment in Microsoft Azure.","datePublished":"2024-04-14T00:26:42.797Z","author":{"@type":"Person","name":"Luke Murray","description":"Author","url":"https://luke.geek.nz","image":"https://luke.geek.nz/img/logo.png"},"keywords":["azure","sandbox","subscription vending","sandbox vending","Terraform","Infrastructure as Code","Azure DevOps","GitHub","Symphony"],"isPartOf":{"@type":"Blog","@id":"https://luke.geek.nz/","name":"Lukes Tech Blog - Unleashing the power of the cloud and other technologies!"}}</script><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="luke.geek.nz RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="luke.geek.nz Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="luke.geek.nz JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0QDLBY7NNN"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0QDLBY7NNN",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.28b9be22.css">
<script src="/assets/js/runtime~main.aa2bc667.js" defer="defer"></script>
<script src="/assets/js/main.7040099f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#D3D3D3" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">If you haven't already make sure you sign up for my Weekly Azure Newsletter, straight to your inbox! <a target="_blank" rel="noopener noreferrer" href="https://newsletter.azurefeeds.com/join">Subscribe now!</a></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="luke.geek.nz" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="luke.geek.nz" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">luke.geek.nz</b></a><a class="navbar__item navbar__link" href="/Tags/">Tags</a><a class="navbar__item navbar__link" href="/Archive/">Blog</a><a class="navbar__item navbar__link" href="/about/">About</a></div><div class="navbar__items navbar__items--right"><a href="https://www.youtube.com/channel/UCUG3TKDTAZz4UXshGrjBBoQ" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="YouTube">
              <svg width="24" height="24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M23.498,6.186c-0.273-1.186-1.143-2.144-2.332-2.417C18.389,3.153,12,3.153,12,3.153s-6.389,0-9.166,0.616
                  c-1.19,0.273-2.06,1.23-2.332,2.417C0,8.07,0,12,0,12s0,3.93,0.502,5.814c0.272,1.187,1.142,2.062,2.332,2.335
                  C5.611,20.847,12,20.847,12,20.847s6.389,0,9.166-0.698c1.189-0.273,2.059-1.148,2.332-2.335C24,15.93,24,12,24,12
                  S24,8.07,23.498,6.186z M9.545,15.568V8.432l6.545,3.568L9.545,15.568z"/>
              </svg>
            </a><a href="https://aus.social/@lukemurray" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="Mastodon">
              <svg height="20" width="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" xml:space="preserve">
                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                <g id="SVGRepo_iconCarrier">
                  <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.510 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"></path>
                </g>
              </svg>
            </a><a href="https://bsky.app/profile/lukemurraynz.bsky.social" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="Bluesky">
              <svg class="octicon" xmlns="http://www.w3.org/2000/svg" role="img" viewBox="0 0 16 16" height="20" width="20" fill="currentColor">
                <title>Bluesky</title>
                <path d="M8 7.2c-.72-1.4-2.7-4.04-4.53-5.33C1.7.63 1.04.84.6 1.04.1 1.27 0 2.05 0 2.51c0 .46.25 3.77.42 4.32.54 1.82 2.47 2.45 4.25 2.25-2.6.38-4.92 1.33-1.88 4.71 3.33 3.46 4.57-.74 5.21-2.87.64 2.13 1.37 6.18 5.16 2.87 2.84-2.87.78-4.33-1.83-4.71 1.78.2 3.71-.43 4.25-2.25.17-.55.42-3.86.42-4.32 0-.46-.09-1.24-.6-1.47-.44-.2-1.11-.42-2.87.83A17.87 17.87 0 0 0 8 7.2Z"></path>
              </svg>
            </a><a href="https://twitter.com/lukemurraynz" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="X"><svg height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 8.586l4.293-4.293a1 1 0 011.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 011.414-1.414L10 8.586z" clip-rule="evenodd"/>
          </svg></a><a href="https://www.linkedin.com/in/ljmurray/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="LinkedIn"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"></path></svg></a><a href="https://luke.geek.nz/rss" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-rss-link" aria-label="RSS"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/export-azure-devops-repos-azure-storage-account/">Export Azure DevOps Repositories to Azure Storage Account</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/run-local-llm-aks/">Deploying Large Language Models on AKS with Kaito</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/authorization-permission-mismatch-error-azure-storage/">Authorization Permission Mismatch error with Azure Storage</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/federated-credentials-aks/">Federated Credentials to AKS Managed Identity</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/uncollapsing-azure-portal-blade-menu/">Uncollapsing the Azure Portal Blade Menu</a></li></ul></nav></aside><main class="col col--7"><article><header><h1 class="title_f1Hy">Implementing a Sandbox Environment in Microsoft Azure</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-04-14T00:26:42.797Z">April 14, 2024</time> · <!-- -->20 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer"><span>Luke Murray</span></a></div><small class="avatar__subtitle">Author</small></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>When working with Microsoft Azure, you may want an environment for learning, whether for an individual or a team.</p>
<p>This article aims to highlight some reference implementation considerations for implementing a Sandbox environment within the Microsoft Azure platform.</p>
<p><img decoding="async" loading="lazy" alt="Azure Environment Concepts" src="/assets/images/Azure_Environment_Concepts-8a14a53df5888d03491157996cdd2a2c.png" width="4000" height="2250" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-overview">📝 Overview<a href="#-overview" class="hash-link" aria-label="Direct link to 📝 Overview" title="Direct link to 📝 Overview">​</a></h2>
<p>When working with Microsoft Azure, you may want an environment for learning, whether for an individual or a team.</p>
<p>Cloud Sandboxes are contained, isolated environments that allow the evaluation of new Cloud services and features (without impacting production environments).</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>This follows from a previous article about <a href="https://luke.geek.nz/azure/microsoft-azure-sandbox-design-considerations/" target="_blank" rel="noopener noreferrer">Sandbox Design</a> considerations but focuses on the implementation elements. This article aims to give you some ideas on how you can achieve Sandbox vending and is opinionated based on my experience. However, it&#x27;s purely intended to show one (of many) possible ways. Just make sure you understand the business requirements and what you need to achieve.</p></div></div>
<p>A design area of the Ready phase of the <a href="https://learn.microsoft.com/azure/cloud-adoption-framework/?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Cloud Adoption Framework</a> is the design and implementation of the <a href="https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Azure Landing Zone</a>, it would be asmiss of me not to bring up <a href="https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/landing-zone/design-area/subscription-vending?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Subscription vending</a>.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>&quot;Subscription vending provides a platform mechanism for programmatically issuing subscriptions to application teams that need to deploy workloads.&quot;</p></div></div>
<p>Subscription Vending is the foundation of what we will discuss today: Sandbox vending.</p>
<p>I will base this article on Unmanaged Sandboxes <em>(Subscription-scoped Sandboxes)</em>; however, much of the same information can be used across all Sandbox types.</p>
<p><img decoding="async" loading="lazy" alt="Sandbox Types" src="/assets/images/Azure_Sandbox_Types-3ca36f3329a48acbf215c3222a060d86.png" width="4000" height="2250" class="img_ev3q"></p>
<!-- -->
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-scenario">🎬 Scenario<a href="#-scenario" class="hash-link" aria-label="Direct link to 🎬 Scenario" title="Direct link to 🎬 Scenario">​</a></h2>
<p>The scenario we are going to run through today involves creating an <a href="https://luke.geek.nz/azure/microsoft-azure-sandbox-design-considerations/" target="_blank" rel="noopener noreferrer">Unmanaged</a> <em>(i.e., subscription-scoped)</em> Sandbox <em>(Sandbox vending)</em> per user or team, which could be a method of implementing it.</p>
<p>To go through this scenario, we will use the following Disciplines of <a href="https://learn.microsoft.com/azure/cloud-adoption-framework/?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Cloud Adoption</a> to help separate elements.</p>
<p><img decoding="async" loading="lazy" alt="Disciplines of Cloud Governance" src="/assets/images/Azure_Sandbox_CloudGovernance_Disciplines-e9552882c6984c5635c744a8e1361221.png" width="4000" height="2250" class="img_ev3q"></p>
<table><thead><tr><th>Discipline</th><th>Description</th></tr></thead><tbody><tr><td>Cost Management</td><td>Cost is a primary concern for cloud users. Develop policies for cost control for all cloud platforms.</td></tr><tr><td>Security Baseline</td><td>Policies and enforcement apply those requirements across network, data, and asset configurations.</td></tr><tr><td>Resource Consistency</td><td>Resources can be configured consistently to manage risks related to onboarding, drift, discoverability, and recovery.</td></tr><tr><td>Identity Baseline</td><td>Identity Baseline discipline focuses on ensuring that identity is consistently applied across cloud adoption efforts.</td></tr><tr><td>Deployment Acceleration</td><td>Centralization, standardization, and consistency in approaches to deployment and configuration improve governance practices.</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-cost-management">💰 Cost Management<a href="#-cost-management" class="hash-link" aria-label="Direct link to 💰 Cost Management" title="Direct link to 💰 Cost Management">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-finops">💰 FinOps<a href="#-finops" class="hash-link" aria-label="Direct link to 💰 FinOps" title="Direct link to 💰 FinOps">​</a></h3>
<p>When working with a Sandbox environment, you need to be aware of the costs associated with it. <a href="https://www.finops.org/framework/principles/" target="_blank" rel="noopener noreferrer">FinOps principles</a> can be key.</p>
<p><a href="https://learn.microsoft.com/azure/azure-resource-manager/management/tag-resources?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Tags</a> can be key to help you showback/chargeback costs and help you assign resource owners.</p>
<p>Recommended Tags for a Sandbox environment could be:</p>
<ul>
<li>&quot;costCenter&quot;: &quot;sandbox&quot;</li>
<li>&quot;costModel&quot;: &quot;show-back&quot;</li>
<li>&quot;environment&quot;: &quot;sandbox&quot;</li>
<li>&quot;resourceowner&quot;: &quot;your_name&quot;</li>
<li>&quot;project&quot;: &quot;sandbox_project&quot;</li>
</ul>
<p>Although the Sandbox environment is for learning, you still need to be aware of its associated costs and keep these as lean as possible.</p>
<p>You can also implement Cost Management and Governance workbooks that allow Sandbox users access to interactive dashboards to help them understand their costs and usage.</p>
<ul>
<li><a href="https://microsoft.github.io/finops-toolkit/governance-workbook" target="_blank" rel="noopener noreferrer">Governance workbook</a> - Monitor the governance posture of your Azure environment. Leverage recommendations to address compliance issues.</li>
<li><a href="https://microsoft.github.io/finops-toolkit/optimization-workbook" target="_blank" rel="noopener noreferrer">Cost optimization workbook</a> - Give your engineers a single pane of glass for cost optimization with this handy Azure Monitor workbook.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-budgets">💰 Budgets<a href="#-budgets" class="hash-link" aria-label="Direct link to 💰 Budgets" title="Direct link to 💰 Budgets">​</a></h3>
<p>Implement <a href="https://learn.microsoft.com/azure/cost-management-billing/costs/tutorial-acm-create-budgets?tabs=psbudget&amp;WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Budgets</a> for each Sandbox, assigned to the Sandbox owner.</p>
<p>Monthly resource spending should be forecast initially and amended as the footprint changes.</p>
<p>Budget alerts are set up to highlight unplanned spending, not to prevent it <em>(i.e., they are alerting thresholds, not limits)</em>.</p>
<p>Each Sandbox environment could start with a consistent Budget and can be adjusted IF required as an exception.
Budgets are intended to drive Sandbox owners to keep their costs under control by having the information on hand.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-security-baseline">🔒 Security Baseline<a href="#-security-baseline" class="hash-link" aria-label="Direct link to 🔒 Security Baseline" title="Direct link to 🔒 Security Baseline">​</a></h2>
<p>Security is a key concern for any environment, and the Sandbox environment is no different; however, there are some tradeoffs. The key to a successful Sandbox environment is that it&#x27;s an environment for learning, so the level of security you would adopt should be less. However, there are some stop gaps that should be implemented.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="️-defender-for-cloud">🛡️ Defender for Cloud<a href="#️-defender-for-cloud" class="hash-link" aria-label="Direct link to 🛡️ Defender for Cloud" title="Direct link to 🛡️ Defender for Cloud">​</a></h3>
<p><a href="https://learn.microsoft.com/azure/defender-for-cloud/defender-for-cloud-introduction?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Defender for Cloud</a> is a cloud-native application protection platform (CNAPP) that consists of security measures and practices designed to protect cloud-based applications from various cyber threats and vulnerabilities.</p>
<p><img decoding="async" loading="lazy" alt="Defender for Cloud" src="/assets/images/defender-for-cloud-pillars-ebd2a2d6c79e8ec18c23f41f291634d9.png" width="1207" height="448" class="img_ev3q"></p>
<p>Defender for Cloud should be enabled on all Sandboxes to help protect against threats and increase visibility. It is a great learning tool.</p>
<p>As people learn how to use Azure technologies, they may not necessarily know how to secure them or how their services might be adapted for a more secure environment. Defender for Cloud helps increase the knowledge around resources in alignment with <a href="https://learn.microsoft.com/azure/defender-for-cloud/alerts-overview?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">current security best practices</a>.</p>
<blockquote>
<p>&quot;While the security team is responsible for improving the security posture, team members might not actually implement security recommendations.
Using governance rules driven by the security team helps you to drive accountability and an SLA around the remediation process.&quot;</p>
</blockquote>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p><a href="https://learn.microsoft.com/en-us/azure/defender-for-cloud/governance-rules?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Governance rules</a> are key.</p></div></div>
<p>For example, using Tags, you could assign resource owners to resources and help drive accountability, alerts, and remediation. Defender for Cloud can be a great learning tool by informing your Sandbox users of potential security issues.</p>
<p>You should also consider possible scenarios, such as the Sandbox environment being one method to exfiltrate data, so make sure you look at <a href="https://learn.microsoft.com/purview/?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Purview</a> and <a href="https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-storage-data-sensitivity?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">data sensitivity</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-azure-policy">📜 Azure Policy<a href="#-azure-policy" class="hash-link" aria-label="Direct link to 📜 Azure Policy" title="Direct link to 📜 Azure Policy">​</a></h3>
<p><a href="https://learn.microsoft.com/azure/governance/policy/overview?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Azure Policy</a> is a service in Azure that you use to create, assign, and manage policies. These policies enforce different rules and effects over your resources so those resources stay compliant with your corporate standards and service level agreements.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>I highly recommend that you deploy your policies and initiatives using <a href="https://azure.github.io/enterprise-azure-policy-as-code/" target="_blank" rel="noopener noreferrer">Azure Enterprise Policy as Code</a>.</p></div></div>
<p>There are tradeoffs with the type of Azure policies you deploy in a Sandbox environment vs what you would deploy in your Production or even Dev/Test environment; recommended policies as a base I would recommend are:</p>
<p>Reference: <a href="https://github.com/Azure/Enterprise-Scale/blob/main/docs/wiki/ALZ-Policies.md" target="_blank" rel="noopener noreferrer">ALZ policies</a></p>
<table><thead><tr><th>Assignment Name</th><th>Definition Name</th><th>Policy Type</th><th>Description</th><th>Effect(s)</th></tr></thead><tbody><tr><td><strong>Enforce ALZ Sandbox Guardrails</strong></td><td><strong>Enforce policies in the Sandbox Landing Zone</strong></td><td><code>Policy Definition Set,</code> <strong>Custom</strong></td><td>This initiative will help enforce and govern subscriptions that are placed within the Sandbox Management Group. Policies included: <ul><li>Deny vNET peering across subscriptions</li><li>Deny the deployment of vWAN/ER/VPN gateways.</li></ul></td><td>Enforce</td></tr></tbody></table>
<table><thead><tr><th>Assignment Name</th><th>Definition Name</th><th>Policy Type</th><th>Description</th><th>Effect(s)</th></tr></thead><tbody><tr><td><strong>Enforce ALZ Decommissioned Guardrails</strong></td><td><strong>Enforce policies in the Decommissioned Landing Zone</strong></td><td><code>Policy Definition Set,</code> <strong>Custom</strong></td><td>This initiative will help enforce and govern subscriptions that are placed within the decommissioned Management Group as part of your Subscription decommissioning process. Policies included: <ul><li>Deny the deployment of new resources</li><li>Deploy an auto VM shutdown policy at UTC 00:00</li></ul></td><td>Enforce</td></tr></tbody></table>
<p>The Decommissioned Management group is where you would move your Sandbox subscriptions once they are no longer required and you want to decommission them.</p>
<p><img decoding="async" loading="lazy" alt="Azure Policy - Azure Landing Zones - Initiative" src="/assets/images/AzurePolicy_ALZSandboxIniiative-8d8de7a7effabe552851d520910029d8.png" width="1166" height="498" class="img_ev3q"></p>
<p>Key policies are part of the ALZ Sandbox Guardrails, which are essentially the policies to restrict the deployment of network resources. These policies would allow you to link virtual networks to on-premises, peer-to-peer virtual networks and allow Sandbox users to connect to production virtual networks or virtual networks outside your organization&#x27;s control.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-terms-of-use">📜 Terms of use<a href="#-terms-of-use" class="hash-link" aria-label="Direct link to 📜 Terms of use" title="Direct link to 📜 Terms of use">​</a></h3>
<p>Make sure you don&#x27;t forget about the People/Processes of your sandbox. You should implement Terms of Use for the Sandbox environment so that users understand the rules and regulations of the environment, such as &#x27;Do not store Production data&#x27;.</p>
<p>You can combine this directly into the Azure Portal login experience by using <a href="https://learn.microsoft.com/en-us/entra/identity/conditional-access/terms-of-use?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Microsoft Entra terms of use</a>.</p>
<p><img decoding="async" loading="lazy" alt="Microsoft Entra - Terms of use" src="/assets/images/user-tou-0335508519c8d3feed95ed2401942df4.png" width="1372" height="838" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-resource-consistency">🔄 Resource Consistency<a href="#-resource-consistency" class="hash-link" aria-label="Direct link to 🔄 Resource Consistency" title="Direct link to 🔄 Resource Consistency">​</a></h2>
<p>Resource Consistency is key. It ensures that resources are configured consistently to manage onboarding, drift, discoverability, and recovery risks.</p>
<p>This is where a lot of automation comes into play to prevent drift and inconsistencies in creating (and decommissioning) a Sandbox environment.</p>
<p><img decoding="async" loading="lazy" alt="Azure DevOps Pipeline - Sandbox" src="/assets/images/ResourceConsistency_SBX_ADOPipelines-e66d08ed0d8ae21e1e243967604f23be.png" width="4000" height="2250" class="img_ev3q"></p>
<p>Ideally, you would have a user interface where a user could request a Sandbox environment <em>(I will talk more about this in the deployment acceleration section)</em>, which would trigger an Azure DevOps pipeline or GitHub action, as an example, to create the environment.</p>
<p>Using Infrastructure as Code <em>(IaC)</em>, you can ensure that the environment is consistent and repeatable and can be provisioned and decommissioned.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-enterprise-policy-as-code">📚 Enterprise Policy as Code<a href="#-enterprise-policy-as-code" class="hash-link" aria-label="Direct link to 📚 Enterprise Policy as Code" title="Direct link to 📚 Enterprise Policy as Code">​</a></h3>
<p><a href="https://learn.microsoft.com/azure/cloud-adoption-framework/ready/policy-management/enterprise-policy-as-code?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Enterprise Policy as Code or EPAC</a> for short comprises a number of scripts which can be used in CI/CD based system or a semi-automated use to deploy Policies, Policy Sets, Assignments, Policy Exemptions and Role Assignments.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>This is a solution created by Microsoft employees but without Microsoft&#x27;s official support as an open-source initiative.</p></div></div>
<p>EPAC is designed for organizations with a large number of Policies, Policy Sets, and Assignments. It is also designed for organizations with multiple tenants and/or environments. The solution primarily consists of PowerShell scripts intended to run operations such as policy planning, deployment, and sync of external policies, such as Enterprise Landing Zone policies, into the EPAC repo.</p>
<p>Enterprise Policy as Code can also be used to control exemptions. An example is running this nightly; any policies or exemptions not in the repository are removed.</p>
<p>Enterprise Policy as Code could be used for Sandbox environments, providing an opportunity to clean up outdated policies, assignments, and exemptions and maintain consistency.</p>
<p><img decoding="async" loading="lazy" alt="Enterprise Policy as Code - Sandbox" src="/assets/images/SandboxPolicy_EPAC-ed7330acd413862edc53f896f17f3cff.gif" width="1685" height="741" class="img_ev3q"></p>
<p>Feel free to refer a blog post, I did previously on <a href="https://luke.geek.nz/azure/enterprise-policy-code-azure-devops/" target="_blank" rel="noopener noreferrer">Enterprise Policy as Code, with Azure DevOps</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="️-azure-devopsgithub">🛠️ Azure DevOps/GitHub<a href="#️-azure-devopsgithub" class="hash-link" aria-label="Direct link to 🛠️ Azure DevOps/GitHub" title="Direct link to 🛠️ Azure DevOps/GitHub">​</a></h3>
<p><a href="https://azure.microsoft.com/products/devops?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Azure DevOps</a> or <a href="https://github.com/" target="_blank" rel="noopener noreferrer">GitHub</a>, both offer features, such as Boards/Discussions, Code Repos, Pipelines <em>(or Actions)</em> which can be used as a platform, for IaC <em>(Infrastructure as Code)</em> and CI/CD <em>(Continous Integration and Continous Deployment)</em>, and is definitely recommended to be factored in your Sandbox design, when it comes to automation and desired state of your Sandbox environment.</p>
<p>The following automation recommendations assume you have access to Azure DevOps or GitHub <em>(or similar)</em>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-symphony">🎼 Symphony<a href="#-symphony" class="hash-link" aria-label="Direct link to 🎼 Symphony" title="Direct link to 🎼 Symphony">​</a></h3>
<p>A large part of the Sandbox vending is a DevOps pipeline and connectivity to Azure that allows Terraform and the pipeline in Azure DevOps to connect to make changes in Azure. Terraform is the car, and Symphony is the road that it travels on.</p>
<p><a href="https://github.com/microsoft/symphony" target="_blank" rel="noopener noreferrer">Symphony</a> is a framework and set of patterns and best practices for developing, testing, and deploying infrastructure on Azure using Infrastructure as Code <em>(IAC)</em> It includes modern DevOps practices for IAC such as Main and Pull Request workflows, IaC Code Validation &amp; Linting, Automated Testing, Security Scanning, Multi-environment deployments, modules dependencies and more. A mature workflow for IAC not only automates the deployment of the IAC resources but also incorporates engineering fundamentals, resource validation, dependency management, test execution, security scanning, and more.</p>
<p>The Symphony pipelines for Azure DevOps and Terraform, for example, are:</p>
<table><thead><tr><th>Pipeline Name</th><th>Comments</th></tr></thead><tbody><tr><td>pipeline.ci.terraform.yml</td><td>This YAML file defines a Continuous Integration (CI) pipeline for Azure DevOps, which triggers changes to the main branch, sets up certain variables, and executes several stages, including validation of configuration and preview deployment using Terraform templates. This file is the command file, triggering the other pipelines.</td></tr><tr><td>pipeline.destroy.terraform.yml</td><td>This YAML file defines a pipeline in Azure DevOps that uses a specific agent image to run a job based on a template for destroying a Terraform environment, with the environment details and key vault information passed as parameters. The pipeline does not trigger automatically on any branch or pull request changes.</td></tr><tr><td>template.terraform.previewdeploy.yml</td><td>This YAML file defines a job in an Azure DevOps pipeline that sets up a clean workspace, installs Terraform and Go, retrieves secrets from an Azure Key Vault, updates network rules and storage account settings, and executes a Terraform plan and apply operation. It also cleans up by removing the agent IP from the Key Vault and denying public access to the Terraform DevOps Storage after the job is done.</td></tr><tr><td>template.terraform.report.yml</td><td>This YAML file defines a job in an Azure DevOps pipeline that, depending on a condition, cleans the workspace, retrieves secrets from an Azure Key Vault, and executes a bash script to backup the state files of a specified environment using Terraform.</td></tr><tr><td>template.terraform.test.yml</td><td>This YAML file defines an end-to-end test job in an Azure DevOps pipeline that sets up a clean workspace, installs Terraform and Go, retrieves secrets from an Azure Key Vault, adds the agent IP to the Key Vault and storage account, runs tests, publishes the test results, and finally removes the agent IP from the Key Vault and storage account.</td></tr><tr><td>template.terraform.validate.yml</td><td>This YAML file defines a validation job in an Azure DevOps pipeline that sets up a clean workspace, installs necessary tools, runs GitLeaks for code analysis, adds the agent IP to a Key Vault, runs Terraform lint and validate, optionally runs layer tests, publishes test results, and finally removes the agent IP from the Key Vault and denies public access to the Terraform DevOps Storage.</td></tr></tbody></table>
<p>Using a framework such as Symphony gives you a good starting point for your deployments.</p>
<p><img decoding="async" loading="lazy" alt="Symphony - Prestep" src="/assets/images/Azure_Sandbox_Symphony_Prestep-a29849b2b838befc80dbd28876732690.png" width="1002" height="190" class="img_ev3q">
<img decoding="async" loading="lazy" alt="Symphony - Preview &amp;amp; Deploy" src="/assets/images/Azure_Sandbox_Symphony_PreviewandDeploy-6946810c4b662519f60539042cf8284b.png" width="1721" height="227" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="️-terraform">🏗️ Terraform<a href="#️-terraform" class="hash-link" aria-label="Direct link to 🏗️ Terraform" title="Direct link to 🏗️ Terraform">​</a></h3>
<p><a href="https://learn.microsoft.com/azure/azure-resource-manager/bicep/overview?tabs=bicep&amp;WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Bicep</a> and <a href="https://www.terraform.io/" target="_blank" rel="noopener noreferrer">Terraform</a> are both tools used for infrastructure-as-code (IaC), which means they allow you to define and manage your cloud infrastructure using code. Both are declarative, meaning you define the desired state of your infrastructure and the tool figures out how to make it so. Bicep is more focused on Microsoft Azure, while Terraform is more focused on multi-cloud.</p>
<p>For this article, I will focus on Terraform, based purely on work done with it around Sandbox provisioning and decommissioning. The Terraform state file helps with a lot of the Sandbox decommissioning aspect.</p>
<p>Terraform modules that can be used during Sandbox provisioning are:</p>
<table><thead><tr><th>Name</th><th>Link</th></tr></thead><tbody><tr><td>azuread</td><td><a href="https://registry.terraform.io/providers/hashicorp/azuread/latest" target="_blank" rel="noopener noreferrer">https://registry.terraform.io/providers/hashicorp/azuread/latest</a></td></tr><tr><td>azurerm</td><td><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest" target="_blank" rel="noopener noreferrer">https://registry.terraform.io/providers/hashicorp/azurerm/latest</a></td></tr><tr><td>random</td><td><a href="https://registry.terraform.io/providers/hashicorp/random/latest" target="_blank" rel="noopener noreferrer">https://registry.terraform.io/providers/hashicorp/random/latest</a></td></tr><tr><td>time</td><td><a href="https://registry.terraform.io/providers/hashicorp/time/latest" target="_blank" rel="noopener noreferrer">https://registry.terraform.io/providers/hashicorp/time/latest</a></td></tr><tr><td>Azure/lz-vending/azurerm</td><td><a href="https://registry.terraform.io/modules/Azure/lz-vending/azurerm/latest" target="_blank" rel="noopener noreferrer">https://registry.terraform.io/modules/Azure/lz-vending/azurerm/latest</a></td></tr></tbody></table>
<p>The real foundation of Sandbox vending is the <a href="https://github.com/Azure/terraform-azurerm-lz-vending" target="_blank" rel="noopener noreferrer">Azure/terraform-azurerm-lz-vending</a> Terraform module.</p>
<p>It can be used to create Azure resources according to the landing zone <em>(Sandbox)</em> vending pattern. It can be used to provision resources such as subscriptions, management group associations, role assignments, and virtual networks.</p>
<p>Here is an example <em>(partial snippet of an overall solution)</em> of how you COULD use the module by having multiple YAML files per Sandbox and using a for_each loop to create each Sandbox environment:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># This module is used to create resources in Azure according to the landing zone vending pattern.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">module</span><span class="token keyword type variable" style="color:rgb(189, 147, 249);font-style:italic"> &quot;lz_vending&quot; </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># The source and version of the module.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">source</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Azure/lz-vending/azurerm&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">version</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;4.0.2&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># The for_each loop allows us to create multiple instances of this module, one for each item in the landing_zone_data_map.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">for_each</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> local.landing_zone_data_map</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># The location where the resources will be created.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">location</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> var.location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Subscription variables.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Enables the resource provider creation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">subscription_register_resource_providers_enabled</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># The map of resource providers to register.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">subscription_register_resource_providers_and_features</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> var.subscription_register_resource_providers_and_features</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Enables the creation of a subscription alias.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">subscription_alias_enabled</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># The billing scope for the subscription.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">subscription_billing_scope</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/providers/Microsoft.Billing/billingAccounts/0000000/enrollmentAccounts/</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">$</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string interpolation" style="color:rgb(255, 121, 198)">each</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string interpolation" style="color:rgb(255, 121, 198)">value</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string interpolation" style="color:rgb(255, 121, 198)">billing_enrollment_account</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># The display name for the subscription. It is converted to lowercase to maintain consistency.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">subscription_display_name</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> (</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;SUB-Contoso-</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">$</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string interpolation" style="color:rgb(255, 121, 198)">each</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string interpolation" style="color:rgb(255, 121, 198)">value</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string interpolation" style="color:rgb(255, 121, 198)">name</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string" style="color:rgb(255, 121, 198)">_</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">$</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string interpolation keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string interpolation type variable" style="color:rgb(189, 147, 249);font-style:italic">env</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string" style="color:rgb(255, 121, 198)">-001&quot;</span><span class="token plain">)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># The alias name for the subscription. It is also converted to lowercase.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">subscription_alias_name</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> (</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;SUB-Contoso</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">$</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string interpolation" style="color:rgb(255, 121, 198)">each</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string interpolation" style="color:rgb(255, 121, 198)">value</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string interpolation" style="color:rgb(255, 121, 198)">name</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string" style="color:rgb(255, 121, 198)">_</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">$</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string interpolation keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string interpolation type variable" style="color:rgb(189, 147, 249);font-style:italic">env</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string" style="color:rgb(255, 121, 198)">-001&quot;</span><span class="token plain">)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># The workload type for the subscription.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">subscription_workload</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> each.value.workload</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Management group association variables.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Enables the association of the subscription with a management group.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">subscription_management_group_association_enabled</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># The ID of the management group to associate with the subscription.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">subscription_management_group_id</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> each.value.management_group_id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Tags to apply to the subscription. The Owner tags are set to the owner of the workload.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">subscription_tags</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> merge(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    var.tags,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">&quot;resource-owner&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> each.value.owner,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">&quot;expiry_date&quot;</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> each.value.expiry_date</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Role assignment variables.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">role_assignment_enabled</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">role_assignments</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># using role definition name, created at subscription scope</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">contrib_user_sub</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">principal_id</span><span class="token plain">   </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> azuread_group.contributor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">each.key</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">.id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">definition</span><span class="token plain">     </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Contributor&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">relative_scope</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Virtual network variables.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Enables the creation of a virtual network.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">virtual_network_enabled</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Enables the creation of a network watcher resource group.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">network_watcher_resource_group_enabled</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># The details of the virtual network to create.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">virtual_networks</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">one</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># The name of the virtual network. It is converted to lowercase.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">name</span><span class="token plain">                        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> lower(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;vnet-</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">$</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string interpolation keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string interpolation type variable" style="color:rgb(189, 147, 249);font-style:italic">env</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string" style="color:rgb(255, 121, 198)">-</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">$</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string interpolation" style="color:rgb(255, 121, 198)">each</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string interpolation" style="color:rgb(255, 121, 198)">value</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string interpolation" style="color:rgb(255, 121, 198)">name</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain">)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">resource_group_lock_enabled</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># The address space for the virtual network.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">address_space</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;192.168.1.0/24&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># The name of the resource group where the virtual network will be created. It is converted to lowercase.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">resource_group_name</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> lower(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;rg-contoso-networks-</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">$</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string interpolation keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string interpolation type variable" style="color:rgb(189, 147, 249);font-style:italic">env</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string" style="color:rgb(255, 121, 198)">-aue-001&quot;</span><span class="token plain">)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># The location where the virtual network will be created.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">location</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> var.location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This will create a Subscription, Resource Group, and define Contributor access, based on data from a data map, that looks at each YAML file in a folder.</p>
<p>&quot;for_each = local.landing_zone_data_map&quot; - This is the key part, as it allows you to create multiple instances of the module, one for each item in the landing_zone_data_map.</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">locals</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># landing_zone_data_dir is the directory containing the YAML files for the landing zones.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># It is set to the root directory of the current Terraform project.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">landing_zone_data_dir</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> path.root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># landing_zone_data_map is a map that stores the decoded YAML data from each landing zone file.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># It uses a for loop to iterate over each file in the landing_zone_files list.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># For each file, it reads the contents of the file using the file function and decodes the YAML data using the yamldecode function.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># The file path is constructed by concatenating the landing_zone_data_dir and the file name.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># The decoded YAML data is then stored in the landing_zone_data_map with the file name as the key.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">landing_zone_data_map</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    for f in local.landing_zone_files :</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">f</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain">&gt; yamldecode(file(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">$</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string interpolation keyword" style="color:rgb(189, 147, 249);font-style:italic">local</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string interpolation type variable" style="color:rgb(189, 147, 249);font-style:italic">landing_zone_data_dir</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string" style="color:rgb(255, 121, 198)">/</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">$</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string interpolation" style="color:rgb(255, 121, 198)">f</span><span class="token string interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain">))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># landing_zone_files is the list of landing zone YAML files to be processed.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># It uses the fileset function to find all files in the landing_zone_data_dir that match the pattern &quot;landing_zone_*.yaml&quot;.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">landing_zone_files</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> fileset(local.landing_zone_data_dir, </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;sbx_landing_zone_*.yaml&quot;</span><span class="token plain">)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Here is an example YAML file:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> SandboxOwner1 </span><span class="token comment" style="color:rgb(98, 114, 164)"># Name of the landing zone. No spaces.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">workload</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> DevTest </span><span class="token comment" style="color:rgb(98, 114, 164)"># Type of subscription for the landing zone (DevTest vs Production (PAY AS YOU GO)). Most Sandboxes will be Production (Pay As You Go), unless all users have a Visual Studio Enterprise subscription.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">owner</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> admin@contoso.com </span><span class="token comment" style="color:rgb(98, 114, 164)"># Owner of the landing zone</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">billing_enrollment_account</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">123456</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># Billing enrollment account for the landing zone. Limit of 5000 API requests for new subscriptions. Later Subscriptions may need a new billing enrollment.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">management_group_id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Unmanaged</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">Sandbox </span><span class="token comment" style="color:rgb(98, 114, 164)"># Management group ID for the landing zone</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">budget_amount</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1000</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># Budget amount for the landing zone, numerical value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">expiry_date</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token datetime number">2024-10-16</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># The date when the landing zone will expire, the default should be 3 months from the date of provisioning. After this date, resources may be automatically cleaned up.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">cost-centre</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Contoso (Cloud) </span><span class="token comment" style="color:rgb(98, 114, 164)"># Cost center for the landing zone</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">cost-model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> show</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">back </span><span class="token comment" style="color:rgb(98, 114, 164)"># Cost model for the landing zone</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This is a very basic example, but it gives you an idea of how you could use the module to create a Subscription and Resource Group and define Contributor access based on data from a data map that looks at each YAML file in a folder. The Expiry date is used as part of the Sandbox decommissioning process and also added as a Tag to the Subscription, along with the Owner, which can also be used as an email recipient of a Budget.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>There is a <a href="https://learn.microsoft.com/azure/cost-management-billing/manage/programmatically-create-subscription-enterprise-agreement?tabs=rest&amp;WT.mc_id=AZ-MVP-5004796#limitations-of-azure-enterprise-subscription-creation-api" target="_blank" rel="noopener noreferrer">limit</a> to the number of API requests you can make to create a new subscription, so you may need to create a new billing enrollment account if you hit this limit, which is why its included in the yaml.</p></div></div>
<p>Using this method, you can create a new Sandbox environment by creating a new YAML file, running the Terraform apply command, and decommissioning the environment by removing the YAML file and running the Terraform apply command again.</p>
<p>For the decommissioning, you can run a separate pipeline to check the expiry of the YAML file, then delete it if it&#x27;s past its due date, which could then trigger the removal.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-identity-baseline">👤 Identity Baseline<a href="#-identity-baseline" class="hash-link" aria-label="Direct link to 👤 Identity Baseline" title="Direct link to 👤 Identity Baseline">​</a></h2>
<p>To connect to your Sandbox environment, you need to ensure that you have the correct Identity Baseline in place.</p>
<p>I recommend you merge your Sandbox identity access, i.e. Entra ID Groups, Access packages, etc., into your IaC pipelines so that access is granted automatically when a new Sandbox environment is created and removed when no longer required.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-entitlement-management">👥 Entitlement Management<a href="#-entitlement-management" class="hash-link" aria-label="Direct link to 👥 Entitlement Management" title="Direct link to 👥 Entitlement Management">​</a></h3>
<p><a href="https://learn.microsoft.com/en-us/entra/id-governance/entitlement-management-overview?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">Entitlement management</a> is an identity governance feature that enables organizations to manage identity and access lifecycle at scale, by automating access request workflows, access assignments, reviews, and expiration.</p>
<p><img decoding="async" loading="lazy" alt="Entitlement Management" src="/assets/images/Azure_Sandbox_IAM_EntitlementManagement-3a3fbc032980fedbf153fe5d90324647.png" width="4000" height="2250" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-access-packages">📦 Access packages<a href="#-access-packages" class="hash-link" aria-label="Direct link to 📦 Access packages" title="Direct link to 📦 Access packages">​</a></h3>
<p>With an access package, an administrator or delegated access package manager lists the resources (groups, apps, and sites), and the roles the users need for those resources.
Access packages also include one or more policies. A policy defines the rules or guardrails for assigning access to an access package. Each policy can be used to ensure that only the appropriate users can have access to assignments. Access is time-limited and will expire if not renewed.</p>
<p><img decoding="async" loading="lazy" alt="Access Packages" src="/assets/images/Azure_Sandbox_IAM_AccessPackages-58def0c07c76fe116fd7faea813d5c17.png" width="4000" height="2250" class="img_ev3q"></p>
<p>You can use Access packages to grant access to your Sandbox environment and then remove access when the environment is no longer required.</p>
<p>Access Packages can be used to delegate access to each Sandbox environment to its owner. This allows Sandbox owners, who may have financial delegation, to control who has access to their environment and remove that access when no longer required.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-conditional-access">🔒 Conditional Access<a href="#-conditional-access" class="hash-link" aria-label="Direct link to 🔒 Conditional Access" title="Direct link to 🔒 Conditional Access">​</a></h3>
<p>Make sure you factor Conditional Access into your Sandbox design by making sure that only the users who may be using compliant devices or from trusted networks can access the environment.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-deployment-acceleration">🚀 Deployment Acceleration<a href="#-deployment-acceleration" class="hash-link" aria-label="Direct link to 🚀 Deployment Acceleration" title="Direct link to 🚀 Deployment Acceleration">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="️-onboarding-self-service">🖥️ Onboarding self-service<a href="#️-onboarding-self-service" class="hash-link" aria-label="Direct link to 🖥️ Onboarding self-service" title="Direct link to 🖥️ Onboarding self-service">​</a></h3>
<p>Onboarding of a new Sandbox environment could be automated from start to end, using a self-service portal. An example is:</p>
<p>A <a href="https://learn.microsoft.com/power-apps/powerapps-overview?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">PowerApp</a> that allows a user to request a new Sandbox environment, by filling in a form, that then triggers a <a href="https://learn.microsoft.com/power-automate/?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer">PowerAutomate</a> flow, to gain approval, and then creates a new YAML file, in a folder, that then triggers a Terraform apply command, to create the new Sandbox environment.</p>
<p><img decoding="async" loading="lazy" alt="Cloud Landing Zone Request - PowerApp" src="/assets/images/Azure_SandboxPowerApps-03eff2da8da6f063c4081fc6b8660235.png" width="1765" height="992" class="img_ev3q"></p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/azure/404-attempting-query-openai-azure-function-binding/"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Resolving 404 Error with OpenAI Azure Function Binding</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/azure/change-timezone-azure-container-app/"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Change the Timezone of your Azure Container App</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#-overview" class="table-of-contents__link toc-highlight">📝 Overview</a></li><li><a href="#-scenario" class="table-of-contents__link toc-highlight">🎬 Scenario</a></li><li><a href="#-cost-management" class="table-of-contents__link toc-highlight">💰 Cost Management</a><ul><li><a href="#-finops" class="table-of-contents__link toc-highlight">💰 FinOps</a></li><li><a href="#-budgets" class="table-of-contents__link toc-highlight">💰 Budgets</a></li></ul></li><li><a href="#-security-baseline" class="table-of-contents__link toc-highlight">🔒 Security Baseline</a><ul><li><a href="#️-defender-for-cloud" class="table-of-contents__link toc-highlight">🛡️ Defender for Cloud</a></li><li><a href="#-azure-policy" class="table-of-contents__link toc-highlight">📜 Azure Policy</a></li><li><a href="#-terms-of-use" class="table-of-contents__link toc-highlight">📜 Terms of use</a></li></ul></li><li><a href="#-resource-consistency" class="table-of-contents__link toc-highlight">🔄 Resource Consistency</a><ul><li><a href="#-enterprise-policy-as-code" class="table-of-contents__link toc-highlight">📚 Enterprise Policy as Code</a></li><li><a href="#️-azure-devopsgithub" class="table-of-contents__link toc-highlight">🛠️ Azure DevOps/GitHub</a></li><li><a href="#-symphony" class="table-of-contents__link toc-highlight">🎼 Symphony</a></li><li><a href="#️-terraform" class="table-of-contents__link toc-highlight">🏗️ Terraform</a></li></ul></li><li><a href="#-identity-baseline" class="table-of-contents__link toc-highlight">👤 Identity Baseline</a><ul><li><a href="#-entitlement-management" class="table-of-contents__link toc-highlight">👥 Entitlement Management</a></li><li><a href="#-access-packages" class="table-of-contents__link toc-highlight">📦 Access packages</a></li><li><a href="#-conditional-access" class="table-of-contents__link toc-highlight">🔒 Conditional Access</a></li></ul></li><li><a href="#-deployment-acceleration" class="table-of-contents__link toc-highlight">🚀 Deployment Acceleration</a><ul><li><a href="#️-onboarding-self-service" class="table-of-contents__link toc-highlight">🖥️ Onboarding self-service</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 luke.geek.nz. Powered by coffee, clouds and hamsters on wheels!</div></div></div></footer></div>
</body>
</html>