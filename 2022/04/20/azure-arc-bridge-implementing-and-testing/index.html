<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.2.1">
<title data-rh="true">Azure Arc Bridge - Implementation and Testing | luke.geek.nz</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://luke.geek.nz/img/social-card.png"><meta data-rh="true" name="twitter:image" content="https://luke.geek.nz/img/social-card.png"><meta data-rh="true" property="og:url" content="https://luke.geek.nz/2022/04/20/azure-arc-bridge-implementing-and-testing/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Azure Arc Bridge - Implementation and Testing | luke.geek.nz"><meta data-rh="true" name="description" content="Azure Arc Bridge(currently in preview)_ is part of the core Azure Arc Hybrid Cloud platform."><meta data-rh="true" property="og:description" content="Azure Arc Bridge(currently in preview)_ is part of the core Azure Arc Hybrid Cloud platform."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-04-20T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://luke.geek.nz"><meta data-rh="true" property="article:tag" content="Azure"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://luke.geek.nz/2022/04/20/azure-arc-bridge-implementing-and-testing/"><link data-rh="true" rel="alternate" href="https://luke.geek.nz/2022/04/20/azure-arc-bridge-implementing-and-testing/" hreflang="en"><link data-rh="true" rel="alternate" href="https://luke.geek.nz/2022/04/20/azure-arc-bridge-implementing-and-testing/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://ZBH2T1WJQD-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://luke.geek.nz/2022/04/20/azure-arc-bridge-implementing-and-testing","mainEntityOfPage":"https://luke.geek.nz/2022/04/20/azure-arc-bridge-implementing-and-testing","url":"https://luke.geek.nz/2022/04/20/azure-arc-bridge-implementing-and-testing","headline":"Azure Arc Bridge - Implementation and Testing","name":"Azure Arc Bridge - Implementation and Testing","description":"Azure Arc Bridge(currently in preview)_ is part of the core Azure Arc Hybrid Cloud platform.","datePublished":"2022-04-20T00:00:00.000Z","author":{"@type":"Person","name":"Luke Murray","description":"Author","url":"https://luke.geek.nz","image":"https://luke.geek.nz/img/logo.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://luke.geek.nz/","name":"Lukes Tech Blog - Unleashing the power of the cloud and other technologies!"}}</script><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="luke.geek.nz RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="luke.geek.nz Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="luke.geek.nz JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0QDLBY7NNN"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0QDLBY7NNN",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.d349528d.css">
<script src="/assets/js/runtime~main.f637daff.js" defer="defer"></script>
<script src="/assets/js/main.a91976bc.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#D3D3D3" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">If you haven't already make sure you sign up for my Weekly Azure Newsletter, straight to your inbox! <a target="_blank" rel="noopener noreferrer" href="https://newsletter.azurefeeds.com/join">Subscribe now!</a></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="luke.geek.nz" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="luke.geek.nz" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">luke.geek.nz</b></a><a class="navbar__item navbar__link" href="/Tags/">Tags</a><a class="navbar__item navbar__link" href="/Archive/">Blog</a><a class="navbar__item navbar__link" href="/about/">About</a></div><div class="navbar__items navbar__items--right"><a href="https://www.youtube.com/channel/UCUG3TKDTAZz4UXshGrjBBoQ" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="YouTube">
              <svg width="24" height="24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M23.498,6.186c-0.273-1.186-1.143-2.144-2.332-2.417C18.389,3.153,12,3.153,12,3.153s-6.389,0-9.166,0.616
                  c-1.19,0.273-2.06,1.23-2.332,2.417C0,8.07,0,12,0,12s0,3.93,0.502,5.814c0.272,1.187,1.142,2.062,2.332,2.335
                  C5.611,20.847,12,20.847,12,20.847s6.389,0,9.166-0.698c1.189-0.273,2.059-1.148,2.332-2.335C24,15.93,24,12,24,12
                  S24,8.07,23.498,6.186z M9.545,15.568V8.432l6.545,3.568L9.545,15.568z"/>
              </svg>
            </a><a href="https://aus.social/@lukemurray" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="Mastodon">
              <svg height="20" width="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" xml:space="preserve">
                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                <g id="SVGRepo_iconCarrier">
                  <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.510 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"></path>
                </g>
              </svg>
            </a><a href="https://bsky.app/profile/lukemurraynz.bsky.social" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="Bluesky">
              <svg class="octicon" xmlns="http://www.w3.org/2000/svg" role="img" viewBox="0 0 16 16" height="20" width="20" fill="currentColor">
                <title>Bluesky</title>
                <path d="M8 7.2c-.72-1.4-2.7-4.04-4.53-5.33C1.7.63 1.04.84.6 1.04.1 1.27 0 2.05 0 2.51c0 .46.25 3.77.42 4.32.54 1.82 2.47 2.45 4.25 2.25-2.6.38-4.92 1.33-1.88 4.71 3.33 3.46 4.57-.74 5.21-2.87.64 2.13 1.37 6.18 5.16 2.87 2.84-2.87.78-4.33-1.83-4.71 1.78.2 3.71-.43 4.25-2.25.17-.55.42-3.86.42-4.32 0-.46-.09-1.24-.6-1.47-.44-.2-1.11-.42-2.87.83A17.87 17.87 0 0 0 8 7.2Z"></path>
              </svg>
            </a><a href="https://twitter.com/lukemurraynz" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="X"><svg height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 8.586l4.293-4.293a1 1 0 011.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 011.414-1.414L10 8.586z" clip-rule="evenodd"/>
          </svg></a><a href="https://www.linkedin.com/in/ljmurray/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon" aria-label="LinkedIn"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"></path></svg></a><a href="https://luke.geek.nz/rss" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-rss-link" aria-label="RSS"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/troubleshooting-scenarios-azure-open-ai/">Troubleshooting scenarios for Azure Open AI</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/404-attempting-query-openai-azure-function-binding/">Resolving 404 Error with OpenAI Azure Function Binding</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/implementing-sandbox-vending/">Implementing a Sandbox Environment in Microsoft Azure</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/change-timezone-azure-container-app/">Change the Timezone of your Azure Container App</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure/azure-container-apps-overview/">Azure Container Apps - Overview</a></li></ul></nav></aside><main class="col col--7"><article><header><h1 class="title_f1Hy">Azure Arc Bridge - Implementation and Testing</h1><div class="container_mt6G margin-vert--md"><time datetime="2022-04-20T00:00:00.000Z">April 20, 2022</time> · <!-- -->8 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://luke.geek.nz/img/logo.png" alt="Luke Murray"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://luke.geek.nz" target="_blank" rel="noopener noreferrer"><span>Luke Murray</span></a></div><small class="avatar__subtitle">Author</small></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p><a href="https://learn.microsoft.com/en-us/azure/azure-arc/resource-bridge/overview?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer" title="What is Azure Arc resource bridge ">Azure Arc Bridge</a><em>(currently in preview)</em> is part of the core Azure Arc Hybrid Cloud platform.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h3>
<p>The Azure Arc resource bridge allows for VM <em>(Virtual Machine)</em> self-servicing and managing on-premises Azure Stack HCI and VMWare virtualised workloads, supporting Linux and Windows.</p>
<p>Along with standard integration of Azure Arc workloads, such as support for Azure Policy and Azure extensions, Azure Update Management and Defender for Cloud support. The Azure Arc resource bridge offers the following self-service functionality direct from the Microsoft Azure portal, offering a single pane of a glass of your workloads, whether they exist on-premises or in Azure:</p>
<ul>
<li>Start, stop and restart a virtual machine</li>
<li>Control access and add Azure tags</li>
<li>Add, remove, and update network interfaces</li>
<li>Add, remove, and update disks and update VM size <em>(CPU cores and memory)</em></li>
<li>Enable guest management</li>
<li>Install extensions</li>
<li>Azure Stack HCI - You can provision and manage on-premises Windows and Linux virtual machines <em>(VMs)</em> running on Azure Stack HCI clusters.</li>
</ul>
<blockquote>
<p>The resource bridge is a packaged virtual machine, which hosts a <em>management</em> Kubernetes cluster that requires no user management. This virtual appliance delivers the following benefits:</p>
<ul>
<li>Enables VM self-servicing from Azure without having to create and manage a Kubernetes cluster</li>
<li>It is fully supported by Microsoft, including update of core components.</li>
<li>Designed to recover from software failures.</li>
<li>Supports deployment to any private cloud hosted on Hyper-V or VMware from the Azure portal or using the Azure Command-Line Interface (CLI).</li>
</ul>
<p>All management operations are performed from Azure, no local configuration is required on the appliance.</p>
</blockquote>
<p><img decoding="async" loading="lazy" alt="Azure Arc - Overview" src="/assets/images/arc-bridge-architecture-overview-b3830ef9b2fc8d9528dd85dbb0f49e4d.png" width="2150" height="1119" class="img_ev3q"></p>
<blockquote>
<p>Azure Arc resource bridge currently supports the following Azure regions:</p>
<ul>
<li>East US</li>
<li>West Europe</li>
</ul>
</blockquote>
<p>These regions hold the Resource Bridge metadata for the resources.</p>
<p>Today, we will stand up an Azure Arc Bridge that supports VMWare vSphere.</p>
<p>I will be running vSphere 6.7 on a single host in my home lab, connected to my Visual Studio subscription.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="private-cloud-environments">Private cloud environments<a href="#private-cloud-environments" class="hash-link" aria-label="Direct link to Private cloud environments" title="Direct link to Private cloud environments">​</a></h4>
<p>The following private cloud environments and their versions are officially supported for the Azure Arc resource bridge:</p>
<ul>
<li>VMware vSphere version 6.7</li>
<li>Azure Stack HCI</li>
</ul>
<p><em>Note: You are unable to set this up on vSphere 7.0.3, as it is not currently supported - I tried!</em></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="permissions">Permissions<a href="#permissions" class="hash-link" aria-label="Direct link to Permissions" title="Direct link to Permissions">​</a></h4>
<ul>
<li>Contributor rights to the Resource Group that the Azure Arc bridge resource will be created.</li>
<li>vSphere account <em>(with at least Read and modify VM rights)</em></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="required-azure-resources">Required Azure resources<a href="#required-azure-resources" class="hash-link" aria-label="Direct link to Required Azure resources" title="Direct link to Required Azure resources">​</a></h4>
<ul>
<li>Resource Group for your Azure Arc Resource Bridge</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="required-on-premises-resources">Required On-premises resources<a href="#required-on-premises-resources" class="hash-link" aria-label="Direct link to Required On-premises resources" title="Direct link to Required On-premises resources">​</a></h4>
<ul>
<li>Resource pool with a reservation of at least 16 GB of RAM and four vCPUs. It should also have access to a datastore with at least 100 GB of free disk space.</li>
<li>A workstation with rights to run PowerShell and install Python and the Azure CLI, with a line of sight to vCenter.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="networking">Networking<a href="#networking" class="hash-link" aria-label="Direct link to Networking" title="Direct link to Networking">​</a></h4>
<ul>
<li>The Arc resource bridge communicates outbound securely to Azure Arc over TCP port 443</li>
<li>At least one free IP <em>(Internet Protocol)</em> address on the on-premises network <em>(or three if there isn&#x27;t a DHCP server).</em> Make sure this isn&#x27;t a used IP; you will need to enter this during the bridge provisioning script.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-azure-arc-resource-bridge">Create Azure Arc Resource Bridge<a href="#create-azure-arc-resource-bridge" class="hash-link" aria-label="Direct link to Create Azure Arc Resource Bridge" title="Direct link to Create Azure Arc Resource Bridge">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-resource-bridge">Create Resource Bridge<a href="#create-resource-bridge" class="hash-link" aria-label="Direct link to Create Resource Bridge" title="Direct link to Create Resource Bridge">​</a></h4>
<ol>
<li>Log in to the <strong>Azure Portal</strong></li>
<li>In the search box up the top, type in: <strong>Azure Arc</strong></li>
<li>Click <strong>Azure Arc</strong></li>
<li>Click on: <strong>VMware vCenters (preview)</strong></li>
<li>Click <strong>Add</strong></li>
<li><img decoding="async" loading="lazy" alt="Azure Arc - Resource Bridge" src="/assets/images/azure_arc_vmware_portal-7b59ed598cf193e6480f282ecd316d26.png" title="Azure Arc - Resource Bridge" width="1233" height="617" class="img_ev3q"></li>
<li>Click: <strong>Create a new resource bridge</strong></li>
<li><img decoding="async" loading="lazy" alt="Azure Arc - Resource Bridge" src="/assets/images/azure_arc_vmware_portal_createresourcebridge-dab7c47b4e4e1b54e38dd5db5be60005.png" title="Azure Arc - Resource Bridge" width="830" height="422" class="img_ev3q"></li>
<li>Click <strong>Next: Basics</strong></li>
<li><strong>Enter</strong> the <strong>following</strong> information to suit your environment:</li>
</ol>
<ul>
<li><strong>Name</strong> <em>(of the Resource Bridge resource)</em></li>
<li>Select the <strong>region</strong> for your Metadata</li>
<li>Create a <a href="https://learn.microsoft.com/en-us/azure/azure-arc/kubernetes/custom-locations?WT.mc_id=AZ-MVP-5004796" target="_blank" rel="noopener noreferrer" title="Create and manage custom locations on Azure Arc-enabled Kubernetes"><strong>Custom Location</strong></a><em>(that matches your on-premises location, where your resources are stored, i.e. could be a data centre prefix that matches your naming convention)</em></li>
<li>Enter in the <strong>name</strong> of your <strong>vCenter</strong> resource <em>(this will represent your vCenter in Azure, so make sure it is easily identifiable)</em></li>
</ul>
<ol>
<li>
<p><img decoding="async" loading="lazy" alt="Azure Arc - vCenter" src="/assets/images/azure_arc_vmware_portal_createresourcesbridge-e81ff5b8b6d31e9f0b733545ecb99a83.png" title="Azure Arc - vCenter" width="826" height="812" class="img_ev3q"></p>
</li>
<li>
<p>Click <strong>Next: Tags</strong></p>
</li>
<li>
<p>A list of default tags has been supplied; feel free to enter or change these to suit your environment.</p>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="Azure Arc - vCenter" src="/assets/images/azure_arc_vmware_portal_createresourcesbridgetags-e000ec87637765de71baa9428d57589a.png" title="Azure Arc - vCenter" width="839" height="688" class="img_ev3q"></p>
</li>
<li>
<p>Click <strong>Next: Download and run the script.</strong></p>
</li>
<li>
<p>Click on <strong>Register</strong> to register the Azure Arc Provider to your subscription. Please wait for this process to complete <em>(it may take a minute or two, you will see: Successfully register your subscription(s) when completed)</em>.</p>
</li>
<li>
<p>Once completed, <strong>download</strong> the <strong>onboarding</strong> PowerShell <strong>script</strong></p>
</li>
<li>
<p><strong>Run</strong> the PowerShell <strong>script</strong> from a computer that has access to Azure and vCenter. This script will download the necessary dependencies <em>(Azure CLI, Python)</em> and, if necessary, authenticate to Azure.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./resource-bridge-onboarding-script.ps1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>When the script runs, you will be prompted for the following information.</p>
<ul>
<li><strong>Proxy</strong> information <em>(if the Workstation is behind a proxy)</em></li>
<li><strong>UAC</strong> <em>(User Access Control)</em> <strong>approval</strong> for the script to install Azure CLI/Python on the workstation</li>
<li><strong>Azure authentication</strong></li>
<li><strong>vCenter</strong> FQDN/<strong>Address</strong></li>
<li><strong>vCenter Username</strong> &amp; <strong>Password</strong></li>
<li><strong>vCenter datastore</strong></li>
<li><strong>vCenter folder</strong> <em>(to place the template in)</em></li>
<li><strong>IP address</strong></li>
</ul>
</li>
<li>
<p><img decoding="async" loading="lazy" alt="Azure Arc - vCenter Onboarding" src="/assets/images/deploy-azurearcbridge-ed3a9634b0646dde9c2901deeb84dd01.gif" title="Azure Arc - vCenter Onboarding" width="1118" height="654" class="img_ev3q"></p>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="link-vcenter-to-azure-arc">Link vCenter to Azure Arc<a href="#link-vcenter-to-azure-arc" class="hash-link" aria-label="Direct link to Link vCenter to Azure Arc" title="Direct link to Link vCenter to Azure Arc">​</a></h4>
<p>You may not need to do the below, but my Bridge was in a &#x27;running&#x27; state but hadn&#x27;t added in the connection to vCenter.</p>
<ol>
<li>Log in to the <strong>Azure Portal</strong></li>
<li>In the search box up the top, type in: <strong>Azure Arc</strong></li>
<li>Click <strong>Azure Arc</strong></li>
<li>Click on: <strong>Resource bridges (preview)</strong></li>
<li>Click on your Azure Arc Bridge and <strong>verify</strong> the <strong>status</strong> is &#x27;<strong>Running</strong>&#x27; <em>(if it is not, make sure it has been started on-premises)</em></li>
<li>In the Azure Portal, click on <strong>VMWare vCenters (preview)</strong></li>
<li>Click <strong>Add</strong></li>
<li>Click <strong>Use an existing resource bridge</strong></li>
<li>Click <strong>Next: Basics</strong></li>
<li>Create your <strong>Custom Location</strong>, then <strong>enter</strong> in the on-premises <strong>vCenter</strong> details</li>
<li><img decoding="async" loading="lazy" alt="Azure Arc - vCenter Onboarding" src="/assets/images/azure_arc_vmware_portal_bridge_vcenter-8ba9b982516feea46403f067989aba72.png" title="Azure Arc - vCenter Onboarding" width="856" height="740" class="img_ev3q"></li>
<li>On the next blade, enter in your appropriate <strong>Tags,</strong> then click <strong>Create</strong></li>
<li>Wait for the deployment to complete; this could take 2-5 minutes.</li>
<li>In the search box up the top, type in: <strong>Azure Arc</strong></li>
<li>Click <strong>Azure Arc</strong></li>
<li>Click on: <strong>VMware vCenters (preview)</strong></li>
<li>You should now see your vSphere instance in a Connected state.</li>
<li><img decoding="async" loading="lazy" alt="Azure Arc - vCenter" src="/assets/images/azure_arc_vmware_portal_bridge_vcenterdeployed-7261215b6c776103c5e0d97f2bda2d6f.png" title="Azure Arc - vCenter" width="1522" height="615" class="img_ev3q"></li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="enable-vcenter-resources-to-be-managed-in-microsoft-azure">Enable vCenter resources to be managed in Microsoft Azure<a href="#enable-vcenter-resources-to-be-managed-in-microsoft-azure" class="hash-link" aria-label="Direct link to Enable vCenter resources to be managed in Microsoft Azure" title="Direct link to Enable vCenter resources to be managed in Microsoft Azure">​</a></h4>
<p>Now that the Bridge has been created, we need to allow resources <em>(such as Virtual Machines, Datastores,  Networks)</em>.</p>
<ol>
<li>Log in to the <strong>Azure Portal</strong></li>
<li>In the search box up the top, type in: <strong>Azure Arc</strong></li>
<li>Click <strong>Azure Arc</strong></li>
<li>Click on: <strong>VMware vCenters (preview)</strong></li>
<li>Click on your <strong>vCenter instance</strong></li>
<li>Under vCenter Inventory, select <strong>Virtual Machines</strong></li>
<li><img decoding="async" loading="lazy" alt="Azure Arc - vCenter" src="/assets/images/azure_arc_vsphere_vm-1d224a3ec54342ba86a8d4c375bd14ca.png" title="Azure Arc - vCenter" width="1122" height="826" class="img_ev3q"></li>
<li>Select the Virtual Machines you want to enable for management in Azure and click &#x27;<strong>Enable in Azure</strong>&#x27;</li>
<li>Select your applicable Subscription and Resource Group (this is where the Azure Arc VM resources will be placed)</li>
<li>Make sure &#x27;<strong>Enable Guest management</strong>&#x27; is selected.</li>
<li>Enter in your Administrator <em>(this is the Admin Username and password of the workloads you want to install the Azure guest management too)</em></li>
<li><img decoding="async" loading="lazy" alt="Azure Arc - On-premises VM" src="/assets/images/azure_arc_vsphere_vmguestagent-0dc9d76a22dd2a5ef9c2af97e223c9ab.png" title="Azure Arc - On-premises VM" width="1102" height="755" class="img_ev3q"></li>
<li>Click <strong>Enable</strong></li>
<li>It can take a few minutes to onboard these clients. If it fails, pick a single Virtual Machine and attempt to onboard that.</li>
<li>You can now repeat the process to onboard Networks, Resource Pools etc.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="manage-virtual-machines-in-microsoft-azure">Manage Virtual Machines in Microsoft Azure<a href="#manage-virtual-machines-in-microsoft-azure" class="hash-link" aria-label="Direct link to Manage Virtual Machines in Microsoft Azure" title="Direct link to Manage Virtual Machines in Microsoft Azure">​</a></h3>
<p>Now that you have set up an Azure Arc Bridge and onboarded vCenter resources. You can now see and manage your vCenter Virtual Machines in Azure, examples below.</p>
<ul>
<li>Ensure that you have VMWare Tools installed and up-to-date to help full functionality, such as Restart, or there may be issues managing these.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="stopstop-virtual-machines">Stop/Stop Virtual Machines<a href="#stopstop-virtual-machines" class="hash-link" aria-label="Direct link to Stop/Stop Virtual Machines" title="Direct link to Stop/Stop Virtual Machines">​</a></h4>
<p><img decoding="async" loading="lazy" alt="Azure Arc - Start/Stop VM" src="/assets/images/startstopvm-azurearcbridge-b93358fa9aa6af44456593db385a6b70.gif" title="Azure Arc - Start/Stop VM" width="1846" height="635" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="resize-virtual-machines---cpumemory">Resize Virtual Machines - CPU/Memory<a href="#resize-virtual-machines---cpumemory" class="hash-link" aria-label="Direct link to Resize Virtual Machines - CPU/Memory" title="Direct link to Resize Virtual Machines - CPU/Memory">​</a></h4>
<p><img decoding="async" loading="lazy" alt="Azure Arc - Resize VM" src="/assets/images/resizevm-azurearcbridge-a87f8ffb8b70cf1d8c387ef88c6a5a55.gif" title="Azure Arc - Resize VM" width="2023" height="635" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="resize-virtual-machines---disk">Resize Virtual Machines - Disk<a href="#resize-virtual-machines---disk" class="hash-link" aria-label="Direct link to Resize Virtual Machines - Disk" title="Direct link to Resize Virtual Machines - Disk">​</a></h4>
<p><img decoding="async" loading="lazy" alt="Azure Arc - Resize Disk" src="/assets/images/resizevmdisk-azurearcbridge-62493fc1cb21cde8ebcabdcaf16d576c.gif" title="Azure Arc - Resize Disk" width="2549" height="655" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h3>
<ul>
<li>The &#x27;resource-bridge-onboarding-script.ps1&#x27; script contains an output file, named: arcvmware-output.log. This log file exists in the same directory as the script and is useful for investigating any errors.</li>
<li>If you get no Folders, listed when the script prompts you to select a folder <em>(i.e. Please select folder)</em>:</li>
</ul>
<ol>
<li>Right-click the Datacenter in vSphere</li>
<li>Select New Folder</li>
<li>Select New VM and Templates folder</li>
<li>Create a folder</li>
</ol>
<ul>
<li>If your Center becomes unavailable, it is most likely because you specified the same IP for the Azure Arc Appliance; if this is the case, log in to the host containing your Azure Arc Bridge and stop/delete the resources from the disk and remove from inventory. Then rerun deployment, this time selecting an appropriate IP.</li>
</ul></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/azure/">Azure</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/azure/hidden-tags-in-azure/"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Hidden Tags in Azure</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/2022/03/27/create-a-site-to-site-vpn-to-azure-with-a-ubiquiti-dream-machine-pro/"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Create a Site to Site VPN to Azure with a Ubiquiti Dream Machine Pro</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a><ul><li><a href="#private-cloud-environments" class="table-of-contents__link toc-highlight">Private cloud environments</a></li><li><a href="#permissions" class="table-of-contents__link toc-highlight">Permissions</a></li><li><a href="#required-azure-resources" class="table-of-contents__link toc-highlight">Required Azure resources</a></li><li><a href="#required-on-premises-resources" class="table-of-contents__link toc-highlight">Required On-premises resources</a></li><li><a href="#networking" class="table-of-contents__link toc-highlight">Networking</a></li></ul></li><li><a href="#create-azure-arc-resource-bridge" class="table-of-contents__link toc-highlight">Create Azure Arc Resource Bridge</a><ul><li><a href="#create-resource-bridge" class="table-of-contents__link toc-highlight">Create Resource Bridge</a></li><li><a href="#link-vcenter-to-azure-arc" class="table-of-contents__link toc-highlight">Link vCenter to Azure Arc</a></li><li><a href="#enable-vcenter-resources-to-be-managed-in-microsoft-azure" class="table-of-contents__link toc-highlight">Enable vCenter resources to be managed in Microsoft Azure</a></li></ul></li><li><a href="#manage-virtual-machines-in-microsoft-azure" class="table-of-contents__link toc-highlight">Manage Virtual Machines in Microsoft Azure</a><ul><li><a href="#stopstop-virtual-machines" class="table-of-contents__link toc-highlight">Stop/Stop Virtual Machines</a></li><li><a href="#resize-virtual-machines---cpumemory" class="table-of-contents__link toc-highlight">Resize Virtual Machines - CPU/Memory</a></li><li><a href="#resize-virtual-machines---disk" class="table-of-contents__link toc-highlight">Resize Virtual Machines - Disk</a></li></ul></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 luke.geek.nz. Powered by coffee, clouds and hamsters on wheels!</div></div></div></footer></div>
</body>
</html>